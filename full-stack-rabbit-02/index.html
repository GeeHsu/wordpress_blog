<!DOCTYPE html>
<html lang="zh-TW">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="profile" href="https://gmpg.org/xfn/11">

	<title>Build &amp; Deploy Full Stack E-commerce Website | Redux | MERN Stack – 02 &#8211; wordpress_blog</title>
<meta name="robots" content="noindex, nofollow">
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<link rel="alternate" type="application/rss+xml" title="訂閱《wordpress_blog》&raquo; 資訊提供" href="/wordpress_blog/feed/">
<link rel="alternate" type="application/rss+xml" title="訂閱《wordpress_blog》&raquo; 留言的資訊提供" href="/wordpress_blog/comments/feed/">
<script>
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.7.2"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"🏳️‍⚧️","🏳️​⚧️")?!1:!n(e,"🇺🇳","🇺​🇳")&&!n(e,"🏴󠁧󠁢󠁥󠁮󠁧󠁿","🏴​󠁧​󠁢​󠁥​󠁮​󠁧​󠁿");case"emoji":return!n(e,"🐦‍⬛","🐦​⬛")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
</script>
<style id="wp-emoji-styles-inline-css">img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}</style>
<link rel="stylesheet" id="wp-block-library-css" href="/wordpress_blog/wp-includes/css/dist/block-library/style.min.css?ver=6.7.2" media="all">
<style id="classic-theme-styles-inline-css">/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}</style>
<style id="global-styles-inline-css">:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--palette-1-color-0: #212121;--wp--preset--color--palette-1-color-1: #757575;--wp--preset--color--palette-1-color-2: #212121;--wp--preset--color--palette-1-color-3: #212121;--wp--preset--color--palette-1-color-4: #212121;--wp--preset--color--palette-1-color-5: #f5f5f5;--wp--preset--color--palette-1-color-6: #ffffff;--wp--preset--color--palette-1-color-7: #ffffff;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 14px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 18px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-size--normal: 16px;--wp--preset--font-size--larger: 24px;--wp--preset--font-size--extra-large: 32px;--wp--preset--font-size--huge: 48px;--wp--preset--font-size--gigantic: 64px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}</style>
<link rel="stylesheet" id="botiga-style-css" href="/wordpress_blog/wp-content/themes/botiga/style.css?ver=1.1.2" media="all">
<link rel="stylesheet" id="botiga-style-min-css" href="/wordpress_blog/wp-content/themes/botiga/assets/css/styles.min.css?ver=1.1.2" media="all">
<link rel="stylesheet" id="botiga-custom-styles-css" href="/wordpress_blog/wp-content/uploads/botiga/custom-styles.css?ver=1648804469" media="all">
<link rel="https://api.w.org/" href="/wordpress_blog/wp-json/">
<link rel="alternate" title="JSON" type="application/json" href="/wordpress_blog/wp-json/wp/v2/posts/882">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/wordpress_blog/xmlrpc.php?rsd">
<meta name="generator" content="WordPress 6.7.2">
<link rel="canonical" href="/wordpress_blog/full-stack-rabbit-02/">
<link rel="shortlink" href="/wordpress_blog/?p=882">
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="/wordpress_blog/wp-json/oembed/1.0/embed?url=%2Ffull-stack-rabbit-02%2F">
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="/wordpress_blog/wp-json/oembed/1.0/embed?url=%2Ffull-stack-rabbit-02%2F&#038;format=xml">
<link rel="icon" href="/wordpress_blog/wp-content/uploads/2022/03/logo.png" sizes="32x32">
<link rel="icon" href="/wordpress_blog/wp-content/uploads/2022/03/logo.png" sizes="192x192">
<link rel="apple-touch-icon" href="/wordpress_blog/wp-content/uploads/2022/03/logo.png">
<meta name="msapplication-TileImage" content="/wp-content/uploads/2022/03/logo.png">
	
</head>

<body class="post-template-default single single-post postid-882 single-format-standard wp-custom-logo wp-embed-responsive header-header_layout_1 blog-single-layout1">


<div id="page" class="site">

	<a class="skip-link screen-reader-text" href="#primary">Skip to content</a>

	
			<div class="top-bar visibility-desktop-only">
				<div class="container-fluid">
					<div class="top-bar-inner">
						<div class="row valign">

															<div class="col header-elements delimiter-none">
									<div class="header-item top-bar-social"><div class="social-profile">
<a target="_blank" href="https://www.facebook.com/watergrass0402/"><i class="ws-svg-icon"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"></path></svg></i></a><a target="_blank" href="https://github.com/GeeHsu"><i class="ws-svg-icon"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></i></a>
</div></div>								</div>
																						<div class="col header-elements delimiter-none">
													
			<nav class="header-item top-bar-secondary-navigation secondary-navigation">
				<div class="menu-topbar-container"><ul id="secondary" class="menu">
<li id="menu-item-143" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-143"><a href="/wordpress_blog/setup/">網站架設</a></li>
<li id="menu-item-144" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-144"><a href="/wordpress_blog/source/">資料來源</a></li>
<li id="menu-item-262" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-262"><a href="/wordpress_blog/resource/">學習資源</a></li>
</ul></div>			</nav>
											</div>
							
						</div>
					</div>
				</div>
			</div>
			
							
				<header id="masthead" class="site-header header_layout_1">
					<div class="container-fluid">
						<div class="site-header-inner">
							<div class="row valign">
								<div class="col-md-5">
										
			<nav id="site-navigation" class="main-navigation">
				<div class="menu-navbar-container"><ul id="primary-menu" class="menu">
<li id="menu-item-109" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-109"><a href="/wordpress_blog/about/">關於</a></li>
<li id="menu-item-110" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-110">
<a href="/wordpress_blog/learn/">學習</a><span tabindex="0" class="dropdown-symbol"><i class="ws-svg-icon"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512.011 512.011"><path d="M505.755 123.592c-8.341-8.341-21.824-8.341-30.165 0L256.005 343.176 36.421 123.592c-8.341-8.341-21.824-8.341-30.165 0s-8.341 21.824 0 30.165l234.667 234.667a21.275 21.275 0 0015.083 6.251 21.275 21.275 0 0015.083-6.251l234.667-234.667c8.34-8.341 8.34-21.824-.001-30.165z"></path></svg></i></span>
<ul class="sub-menu">
	<li id="menu-item-140" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-140"><a href="/wordpress_blog/category/hexschool/">六角學院</a></li>
	<li id="menu-item-141" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-141"><a href="/wordpress_blog/category/ninja/">Net Ninja</a></li>
	<li id="menu-item-483" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-483"><a href="/wordpress_blog/category/youtube/">Youtube</a></li>
</ul>
</li>
<li id="menu-item-111" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-111"><a href="/wordpress_blog/linestore/">LINE STORE</a></li>
</ul></div>			</nav><!-- #site-navigation -->
											</div>
								<div class="col-md-2">
												<div class="site-branding">
				<a href="/wordpress_blog/" class="custom-logo-link" rel="home"><img width="512" height="512" src="/wordpress_blog/wp-content/uploads/2022/03/logo.png" class="custom-logo" alt="wordpress_blog" decoding="async" fetchpriority="high"></a>					<p class="site-title"><a href="/wordpress_blog/" rel="home">wordpress_blog</a></p>
										<p class="site-description">This is a dynamic to static website.</p>
							</div>
<!-- .site-branding -->
											</div>
								<div class="col-md-5 header-elements">
																	</div>							
							</div>
						</div>
					</div>
								<div class="header-search-form">
			<form role="search" method="get" class="search-form" action="/">
	<label class="screen-reader-text" for="search-form-1">Search&hellip;</label>
	<input type="search" id="search-form-1" class="search-field" value="" name="s" placeholder="Search &hellip;">
	<button type="submit" class="search-submit" value="Search"><i class="ws-svg-icon"><svg width="24" height="24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10.875 3.75a7.125 7.125 0 100 14.25 7.125 7.125 0 000-14.25zM2.25 10.875a8.625 8.625 0 1117.25 0 8.625 8.625 0 01-17.25 0z"></path><path fill-rule="evenodd" d="M15.913 15.914a.75.75 0 011.06 0l4.557 4.556a.75.75 0 01-1.06 1.06l-4.557-4.556a.75.75 0 010-1.06z"></path></svg></i></button>
</form>
			</div>
			
									</header>

										<div class="search-overlay"></div>
			
			<div class="botiga-offcanvas-menu">
				<div class="mobile-header-item">
					<div class="row">
						<div class="col">
										<div class="site-branding">
				<a href="/wordpress_blog/" class="custom-logo-link" rel="home"><img width="512" height="512" src="/wordpress_blog/wp-content/uploads/2022/03/logo.png" class="custom-logo" alt="wordpress_blog" decoding="async"></a>					<p class="site-title"><a href="/wordpress_blog/" rel="home">wordpress_blog</a></p>
										<p class="site-description">This is a dynamic to static website.</p>
							</div>
<!-- .site-branding -->
									</div>
						<div class="col align-right">
							<a class="mobile-menu-close" href="#"><i class="ws-svg-icon icon-cancel"><svg width="16" height="16" fill="none" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M2.219.781L.78 2.22 9.562 11l-8.78 8.781 1.437 1.438L11 12.437l8.781 8.782 1.438-1.438L12.437 11l8.782-8.781L19.78.78 11 9.562 2.219.783z"></path></svg></i></a>
						</div>
					</div>
				</div>
				<div class="mobile-header-item">
						
			<nav id="site-navigation" class="main-navigation">
				<div class="menu-navbar-container"><ul id="primary-menu" class="menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-109"><a href="/wordpress_blog/about/">關於</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-110">
<a href="/wordpress_blog/learn/">學習</a><span tabindex="0" class="dropdown-symbol"><i class="ws-svg-icon"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512.011 512.011"><path d="M505.755 123.592c-8.341-8.341-21.824-8.341-30.165 0L256.005 343.176 36.421 123.592c-8.341-8.341-21.824-8.341-30.165 0s-8.341 21.824 0 30.165l234.667 234.667a21.275 21.275 0 0015.083 6.251 21.275 21.275 0 0015.083-6.251l234.667-234.667c8.34-8.341 8.34-21.824-.001-30.165z"></path></svg></i></span>
<ul class="sub-menu">
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-140"><a href="/wordpress_blog/category/hexschool/">六角學院</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-141"><a href="/wordpress_blog/category/ninja/">Net Ninja</a></li>
	<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-483"><a href="/wordpress_blog/category/youtube/">Youtube</a></li>
</ul>
</li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-111"><a href="/wordpress_blog/linestore/">LINE STORE</a></li>
</ul></div>			</nav><!-- #site-navigation -->
							</div>
				<div class="mobile-header-item">
									<a target="&quot;_blank&quot;" class="button header-item" href="https://www.facebook.com/watergrass0402/">聯絡我</a>
							</div>			
			</div>
			
							<header id="masthead-mobile" class="site-header mobile-header">
					<div class="container-fluid">
						<div class="row valign flex-nowrap">
							<div class="col-sm-6 col-md-4 col-grow-mobile">
											<div class="site-branding">
				<a href="/wordpress_blog/" class="custom-logo-link" rel="home"><img width="512" height="512" src="/wordpress_blog/wp-content/uploads/2022/03/logo.png" class="custom-logo" alt="wordpress_blog" decoding="async"></a>					<p class="site-title"><a href="/wordpress_blog/" rel="home">wordpress_blog</a></p>
										<p class="site-description">This is a dynamic to static website.</p>
							</div>
<!-- .site-branding -->
										</div>
							<div class="col-auto col-sm-6 col-md-8 col-grow-mobile header-elements valign align-right">
																	
															<a href="#" class="menu-toggle">
				<i class="ws-svg-icon"><svg width="16" height="11" viewbox="0 0 16 11" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="16" height="1"></rect><rect y="5" width="16" height="1"></rect><rect y="10" width="16" height="1"></rect></svg></i>
			</a>
																		</div>						
						</div>
					</div>
								<div class="header-search-form">
			<form role="search" method="get" class="search-form" action="/">
	<label class="screen-reader-text" for="search-form-2">Search&hellip;</label>
	<input type="search" id="search-form-2" class="search-field" value="" name="s" placeholder="Search &hellip;">
	<button type="submit" class="search-submit" value="Search"><i class="ws-svg-icon"><svg width="24" height="24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10.875 3.75a7.125 7.125 0 100 14.25 7.125 7.125 0 000-14.25zM2.25 10.875a8.625 8.625 0 1117.25 0 8.625 8.625 0 01-17.25 0z"></path><path fill-rule="evenodd" d="M15.913 15.914a.75.75 0 011.06 0l4.557 4.556a.75.75 0 01-1.06 1.06l-4.557-4.556a.75.75 0 010-1.06z"></path></svg></i></button>
</form>
			</div>
			
									</header>
						<div class="search-overlay"></div>
			<div class="header-image"><img src="/wordpress_blog/wp-content/uploads/2022/03/seashore.jpg" width="1920" height="500" alt=""></div>
<div class="container content-wrapper"><div class="row main-row">			
	<main id="primary" class="site-main no-sidebar">

		

<article id="post-882" class="post-882 post type-post status-publish format-standard hentry category-youtube">
	
		
	<header class="entry-header">
		
		
		<h1 class="entry-title">Build &amp; Deploy Full Stack E-commerce Website | Redux | MERN Stack – 02</h1>			<div class="entry-meta entry-meta-below delimiter-none">
<span class="posted-on"><a href="/wordpress_blog/full-stack-rabbit-02/" rel="bookmark"><time class="entry-date published" datetime="2025-03-18T17:12:43+08:00">2025 年 3 月 18 日</time><time class="updated" datetime="2025-03-26T09:11:45+08:00">2025 年 3 月 26 日</time></a></span><span class="byline"> <span class="author vcard"><a class="url fn n" href="/wordpress_blog/author/gee-hsu/">gee.hsu</a></span></span>
</div>			</header><!-- .entry-header -->

	
	<div class="entry-content">
		
<p>學習來自 YT:&nbsp;<a rel="noreferrer noopener" href="https://www.youtube.com/@compiletab" target="_blank">compiletab</a><br>影片:&nbsp;<a rel="noreferrer noopener" href="https://www.youtube.com/watch?v=hpgh2BTtac8" target="_blank">Build &amp; Deploy Full Stack E-commerce Website | Redux | MERN Stack Project</a><br>Github assets:&nbsp;<a rel="noreferrer noopener" href="https://github.com/kushald/rabbit-assets" target="_blank">連結</a><br>Thank you, teacher</p>



<h1 class="wp-block-heading">建立 &amp; 部署全端商業網站</h1>



<h2 class="wp-block-heading">影片時間戳</h2>



<p>00:00:00 – Introduction<br>00:01:56 – Demo<br>00:05:26 – Installation &amp; set up<br>05:50:25 – Admin UI<br>07:20:25 – Backend setup<br>07:32:40 – user routes<br>08:05:40 – Products routes<br>09:18:56 – cart routes<br>10:13:26 – checkout routes<br>10:57:55 – Admin routes<br>11:58:30 – Redux</p>



<h2 class="wp-block-heading">Backend (後端)</h2>



<h2 class="wp-block-heading">npm init -y 初始化建立 package.json 檔案</h2>



<h2 class="wp-block-heading">安裝套件</h2>



<ul class="wp-block-list">
<li>express</li>



<li>mongoose</li>



<li>dotenv</li>



<li>jsonwebtoken</li>



<li>bcryptjs</li>



<li>cors</li>



<li>nodemon</li>
</ul>



<pre class="wp-block-code"><code>// backend - 後端
// TERMINAL - 終端機
npm install express mongoose dotenv jsonwebtoken bcryptjs cors nodemon</code></pre>



<h2 class="wp-block-heading">後端環境建立</h2>



<pre class="wp-block-code"><code>// backend/server.js
// 建立伺服器的進入點
const express = require("express");
const cors = require("cors");
const dotenv = require("dotenv");

const app = express();
app.use(express.json());
app.use(cors());

dotenv.config();

// console.log(process.env.PORT);
const PORT = process.env.PORT || 3000;

app.get("/", (req, res) =&gt; {
  res.send("WELCOME TO RABBIT API!");
});

app.listen(PORT, () =&gt; {
  console.log(`Server is running on http://localhost:${PORT}`);
});
</code></pre>



<pre class="wp-block-code"><code>// backend/package.json
{
  "name": "backend",
  "version": "1.0.0",
  "description": "",
  "main": "server.js",
  "scripts": {
    "start": "node backend/server.js",
    "dev": "nodemon backend/server.js"
  },
  "keywords": &#91;],
  "author": "",
  "license": "ISC",
  "dependencies": {
    "bcryptjs": "^3.0.2",
    "cors": "^2.8.5",
    "dotenv": "^16.4.7",
    "express": "^4.21.2",
    "jsonwebtoken": "^9.0.2",
    "mongoose": "^8.12.1",
    "nodemon": "^3.1.9"
  }
}
</code></pre>



<pre class="wp-block-code"><code>// backend/.env
PORT=9000</code></pre>



<h2 class="wp-block-heading">使用 MongoDB Altas 建立資料庫</h2>



<ol class="wp-block-list">
<li>New Project – 新建專案</li>



<li>Name Your Project: rabbit – 命名你的專案: rabbit</li>



<li>Create Project – 建立專案</li>



<li>Create a cluster – 建立集群</li>



<li>Deploy your cluster – 部署你的集群<br>Free、AWS – 免費、亞馬遜雲端服務<br>Create Deployment – 建立部署</li>



<li>Connect to Cluster0 – 連接到集群<br>Copy – 複製<br>Create Database User – 建立資料庫使用者</li>



<li>Add a connection IP Address – 增加連接的IP地址<br>Add IP ADDRESS – 增加IP地址<br>ALLOW ACCESS FROM ANYWHERE – 允許來自任何地方的訪問<br>(我這裡先設定一星期)<br>CONFIRM – 確認</li>



<li>Choose a connection method – 選擇連接方法<br>Connect to your application – 連接你的應用程式<br>Using this connection string in your application – 使用連接字串在你的應用程式</li>
</ol>



<pre class="wp-block-code"><code>// backend/.env
PORT=9000
MONGO_URI=mongodb+srv://&lt;username&gt;:&lt;password&gt;@&lt;cluster-address&gt;/&lt;database-name&gt;?retryWrites=true&amp;w=majority&amp;appName=&lt;app-name&gt;
</code></pre>



<pre class="wp-block-code"><code>// backend/config/db.js
const mongoose = require("mongoose");

const connectDB = async () =&gt; {
  try {
    await mongoose.connect(process.env.MONGO_URI);
    console.log("MongoDB connected successfully");
  } catch (err) {
    console.error("MongoDB connection failed.", err);
    process.exit(1);
  }
};

module.exports = connectDB;
</code></pre>



<pre class="wp-block-code"><code>// backend/server.js
const express = require("express");
const cors = require("cors");
const dotenv = require("dotenv");
const connectDB = require("./config/db");

const app = express();
app.use(express.json());
app.use(cors());

dotenv.config();

// console.log(process.env.PORT);
const PORT = process.env.PORT || 3000;

// Connect to MongoDB - 連接到 MongoDB
connectDB();

app.get("/", (req, res) =&gt; {
  res.send("WELCOME TO RABBIT API!");
});

app.listen(PORT, () =&gt; {
  console.log(`Server is running on http://localhost:${PORT}`);
});
</code></pre>



<h2 class="wp-block-heading">製作處理用戶功能</h2>



<h3 class="wp-block-heading">USERS (用戶)</h3>



<ul class="wp-block-list">
<li>Register</li>



<li>Login</li>



<li>Profile</li>
</ul>



<h3 class="wp-block-heading">User Schema (用戶模式)</h3>



<figure class="wp-block-table"><table class="has-fixed-layout"><tbody>
<tr>
<td>Field Name (欄位名稱)</td>
<td>Type (類型)</td>
<td>Constraints (約束)</td>
</tr>
<tr>
<td>_id</td>
<td>ObjectId</td>
<td>Primary key, auto-generated by MongoDB</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>Required, trimmed of whitespace</td>
</tr>
<tr>
<td>email</td>
<td>String</td>
<td>Required, unique, trimmed, email validated</td>
</tr>
<tr>
<td>password</td>
<td>String</td>
<td>Required, minimum length: 6</td>
</tr>
<tr>
<td>role</td>
<td>String</td>
<td>Enum: [“customer”, “admin”], Default: “customer”</td>
</tr>
<tr>
<td>createdAt</td>
<td>Date</td>
<td>Auto-generated timestamp</td>
</tr>
<tr>
<td>updateAt</td>
<td>Date</td>
<td>Auto-updated timestamp</td>
</tr>
</tbody></table></figure>



<pre class="wp-block-code"><code>// backend/models/User.js
const mongoose = require("mongoose");
const bcrypt = require("bcryptjs");

const userSchema = new mongoose.Schema(
  {
    name: {
      type: String,
      required: true,
      trim: true,
    },
    email: {
      type: String,
      required: true,
      unique: true,
      trim: true,
      match: &#91;/.+\@.+\..+/, "Please enter a valid email address"],
    },
    password: {
      type: String,
      required: true,
      minLength: 6,
    },
    role: {
      type: String,
      enum: &#91;"customer", "admin"],
      default: "customer",
    },
  },
  {
    timestamps: true,
  }
);

// Password Hash middleware - 密碼哈希中介軟體
userSchema.pre("save", async function (next) {
  if (!this.isModified("password")) return next();
  const salt = await bcrypt.genSalt(10);
  this.password = await bcrypt.hash(this.password, salt);
  next();
});

// Match User entered password to Hashed password - 將用戶輸入的密碼與哈希密碼匹配
userSchema.methods.matchPassword = async function (enteredPassword) {
  return await bcrypt.compare(enteredPassword, this.password);
};

module.exports = mongoose.model("User", userSchema);
</code></pre>



<pre class="wp-block-code"><code>// backend/routes/userRoutes.js
const express = require("express");
const User = require("../models/User");
const jwt = require("jsonwebtoken");
const { protect } = require("../middleware/authMiddleware");
const router = express.Router();

// @route POST /api/users/register - @路由、使用 POST 方法、API 的路徑
// @desc Register a new user - @描述 註冊一個新用戶
// @access Public - @訪問權限 公開
router.post("/register", async (req, res) =&gt; {
  const { name, email, password } = req.body;

  try {
    // Registration logic - 註冊邏輯
    // 測試1
    // res.send({ name, email, password });

    let user = await User.findOne({ email });
    if (user) return res.status(400).json({ message: "User already exists" });
    user = new User({ name, email, password });
    await user.save();

    // 測試2
    // res.status(201).json({
    //   user: {
    //     _id: user._id,
    //     name: user.name,
    //     email: user.email,
    //     role: user.role,
    //   },
    // });

    // Create JWT Payload - 建立 JWT 負載
    const payload = { user: { id: user._id, role: user.role } };
    // Sign and return the token along with user data - 簽署並返回令牌以及用戶資料
    jwt.sign(
      payload,
      process.env.JWT_SECRET,
      {
        expiresIn: "40h",
      },
      (err, token) =&gt; {
        if (err) throw err;
        // Send the user and token in response
        res.status(201).json({
          user: {
            _id: user._id,
            name: user.name,
            email: user.email,
            role: user.role,
          },
          token,
        });
      }
    );
  } catch (error) {
    console.log(error);
    res.status(500).send("Server Error");
  }
});

// @route POST /api/user/login - @路由、使用 POST 方法、API 的路徑
// @desc Authenticate user - @描述 - 驗證用戶
// @access Public - @訪問權限 公開
router.post("/login", async (req, res) =&gt; {
  const { email, password } = req.body;

  try {
    // Find ther user by email
    let user = await User.findOne({
      email,
    });

    if (!user)
      return res.status(400).json({
        message: "Invalid Credentials",
      });
    const isMatch = await user.matchPassword(password);

    if (!isMatch)
      return res.status(400).json({ message: "Invalid Credentials" });

    // Create JWT Payload - 建立 JWT 負載
    const payload = { user: { id: user._id, role: user.role } };

    // Sign and return the token along with user data - 簽署並返回令牌以及用戶資料
    jwt.sign(
      payload,
      process.env.JWT_SECRET,
      {
        expiresIn: "40h",
      },
      (err, token) =&gt; {
        if (err) throw err;

        // Send the user and token in response
        res.json({
          user: {
            _id: user._id,
            name: user.name,
            email: user.email,
            role: user.role,
          },
          token,
        });
      }
    );
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route GET /api/users/profile - @路由、使用 POST 方法、API 的路徑
// @desc Get logged-in user's profile (Protected Route) - @描述 - 獲取已登入用戶的個人資料 (受保護的路由)
// @access Private - @訪問權限 私人
router.get("/profile", protect, async (req, res) =&gt; {
  res.json(req.user);
});

module.exports = router;
</code></pre>



<pre class="wp-block-code"><code>// backend/server.js
const express = require("express");
const cors = require("cors");
const dotenv = require("dotenv");
const connectDB = require("./config/db");
const userRoutes = require("./routes/userRoutes");

const app = express();
app.use(express.json());
app.use(cors());

dotenv.config();

// console.log(process.env.PORT);
const PORT = process.env.PORT || 3000;

// Connect to MongoDB - 連接到 MongoDB
connectDB();

app.get("/", (req, res) =&gt; {
  res.send("WELCOME TO RABBIT API!");
});

// API Routes - API 路由
app.use("/api/users", userRoutes);

app.listen(PORT, () =&gt; {
  console.log(`Server is running on http://localhost:${PORT}`);
});
</code></pre>



<h2 class="wp-block-heading">使用 Postman API 測試工具</h2>



<ul class="wp-block-list">
<li>
<a href="https://www.postman.com/" target="_blank" rel="noreferrer noopener">Postman</a>&nbsp;– Postman Agent</li>



<li>Create Workspace – 建立工作區</li>



<li>Name: Rabbit – 名稱: Rabbit<br>Create – 建立</li>



<li>Create Collection – 建立集合<br>Users</li>



<li>Add a request – 新增請求<br>Register、POST、http://localhost:9000/api/users/register<br>Login、POST、http://localhost:9000/api/users/login<br>Profile、GET、http://localhost:9000/api/users/profile<br>Save – 儲存</li>



<li>Body &gt; raw</li>



<li>Send</li>
</ul>



<pre class="wp-block-code"><code>// Postman - Users/Register
// Body &gt; raw
{
    "name": "John",
    "email": "john@example.com",
    "password": 123456
}</code></pre>



<pre class="wp-block-code"><code>// Postman - Users/Login
// Body &gt; raw
{
    "email": "john1@example.com",
    "password": 123456
}</code></pre>



<pre class="wp-block-code"><code>// Postman - Users/Profile
// Headers
Key: Authorization
Value: Bearer 你的Token</code></pre>



<h2 class="wp-block-heading">查看 MongoDB Atlas</h2>



<ul class="wp-block-list">
<li>Browse Collection (瀏覽集合) &gt; users</li>
</ul>



<pre class="wp-block-code"><code>// backend/middleware/authMiddleware.js
const jwt = require("jsonwebtoken");
const User = require("../models/User");

// Middleware to protect routes
const protect = async (req, res, next) =&gt; {
  let token;

  if (
    req.headers.authorization &amp;&amp;
    req.headers.authorization.startsWith("Bearer")
  ) {
    try {
      token = req.headers.authorization.split(" ")&#91;1];
      const decoded = jwt.verify(token, process.env.JWT_SECRET);

      req.user = await User.findById(decoded.user.id).select("-password"); // Exclude password - 排除密碼
      next();
    } catch (error) {
      console.error("Token verification failed:", error);
      res.status(401).json({ message: "Not authorized, token failed" });
    }
  } else {
    res.status(401).json({ message: "Not authorized, no token provided" });
  }
};

module.exports = { protect };
</code></pre>



<ul class="wp-block-list">
<li><a href="https://jwt.io/" target="_blank" rel="noreferrer noopener">JSON Web Tokens</a></li>
</ul>



<pre class="wp-block-code"><code>// backend/.env
PORT=9000
MONGO_URI=mongodb+srv://&lt;username&gt;:&lt;password&gt;@&lt;cluster-address&gt;/&lt;database-name&gt;?retryWrites=true&amp;w=majority&amp;appName=&lt;app-name&gt;
JWT_SECRET=你的JWT密鑰</code></pre>



<h2 class="wp-block-heading">後端製作流程 (個人整理)</h2>



<ol class="wp-block-list">
<li>初始化專案</li>



<li>創建 .env 文件</li>



<li>製作 server.js (伺服器入口)</li>



<li>製作資料庫配置 config/db.js</li>



<li>製作資料模型 models/User.js</li>



<li>製作路由 routes/userRoutes.js</li>



<li>製作中介軟體 middleware/authMiddleware.js</li>
</ol>



<h2 class="wp-block-heading">製作產品功能</h2>



<h3 class="wp-block-heading">PRODUCTS (產品)</h3>



<ul class="wp-block-list">
<li>Create Product</li>



<li>Update Product</li>



<li>Delete Product</li>



<li>All Products</li>



<li>Single Product</li>



<li>Best Seller</li>



<li>Similar Products</li>



<li>New Arrivals</li>
</ul>



<h2 class="wp-block-heading">Product Schema (產品模式)</h2>



<figure class="wp-block-table"><table class="has-fixed-layout"><tbody>
<tr>
<td>Field Name (欄位名稱)</td>
<td>Type (類型)</td>
<td>Constraints/Description (約束/描述)</td>
</tr>
<tr>
<td>_id</td>
<td>ObjectId</td>
<td>Auto-generated by MondoDB</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>Required, trimmed</td>
</tr>
<tr>
<td>description</td>
<td>String</td>
<td>Required</td>
</tr>
<tr>
<td>price</td>
<td>Number</td>
<td>Required</td>
</tr>
<tr>
<td>discountPrice</td>
<td>Number</td>
<td>Optional</td>
</tr>
<tr>
<td>countInStock</td>
<td>Number</td>
<td>Required, default: 0</td>
</tr>
<tr>
<td>sku</td>
<td>String</td>
<td>Required, unique</td>
</tr>
<tr>
<td>category</td>
<td>String</td>
<td>Required</td>
</tr>
<tr>
<td>brand</td>
<td>String</td>
<td>Optional</td>
</tr>
<tr>
<td>sizes</td>
<td>[String]</td>
<td>Required, example: [‘S’, ‘M’, ‘L’]</td>
</tr>
<tr>
<td>colors</td>
<td>[String]</td>
<td>Required, example: [‘Red’, ‘Blue’]</td>
</tr>
<tr>
<td>collections</td>
<td>String</td>
<td>Required, example: ‘Summercollection’</td>
</tr>
<tr>
<td>material</td>
<td>String</td>
<td>Optional</td>
</tr>
<tr>
<td>gender</td>
<td>String</td>
<td>Enum: [‘Men’, ‘Women’, ‘Unisex’]</td>
</tr>
<tr>
<td>images</td>
<td>Array of Objects</td>
<td>Required, each object contains:<br>– url: String, required<br>– altText: String, optional</td>
</tr>
<tr>
<td>isFeatured</td>
<td>Boolean</td>
<td>Default: false</td>
</tr>
<tr>
<td>isPublished</td>
<td>Boolean</td>
<td>Default: false</td>
</tr>
<tr>
<td>rating</td>
<td>Number</td>
<td>Default: 0</td>
</tr>
<tr>
<td>numReviews</td>
<td>Number</td>
<td>Default: 0</td>
</tr>
<tr>
<td>tags</td>
<td>[String]</td>
<td>Optional</td>
</tr>
<tr>
<td>user</td>
<td>ObjectId</td>
<td>Reference to User, required</td>
</tr>
<tr>
<td>metaTitle</td>
<td>String</td>
<td>Optional</td>
</tr>
<tr>
<td>metaDescription</td>
<td>String</td>
<td>Optional</td>
</tr>
<tr>
<td>metaKeywords</td>
<td>String</td>
<td>Optional</td>
</tr>
<tr>
<td>dimensions</td>
<td>Object</td>
<td>Optional, contains:<br>– length: Number<br>– width: Number<br>– height: Number</td>
</tr>
<tr>
<td>weight</td>
<td>Number</td>
<td>Optional</td>
</tr>
<tr>
<td>createdAt</td>
<td>Date</td>
<td>Auto-generated by timestamps</td>
</tr>
<tr>
<td>updatedAt</td>
<td>Date</td>
<td>Auto-updated by timestamps</td>
</tr>
</tbody></table></figure>



<h2 class="wp-block-heading">Create Product (建立產品)</h2>



<pre class="wp-block-code"><code>// backend/models/Product.js
const mongoose = require("mongoose");

const productSchema = new mongoose.Schema(
  {
    name: {
      type: String,
      required: true,
      trim: true,
    },
    description: {
      type: String,
      required: true,
    },
    price: {
      type: Number,
      required: true,
    },
    discountPrice: {
      type: Number,
    },
    countInStock: {
      type: Number,
      required: true,
      default: 0,
    },
    sku: {
      type: String,
      unique: true,
      required: true,
    },
    category: {
      type: String,
      required: true,
    },
    brand: {
      type: String,
    },
    sizes: {
      type: &#91;String],
      required: true,
    },
    colors: {
      type: &#91;String],
      required: true,
    },
    collections: {
      type: String,
      required: true,
    },
    material: {
      type: String,
    },
    gender: {
      type: String,
      enum: &#91;"Men", "Women", "Unisex"],
    },
    images: &#91;
      {
        url: {
          type: String,
          required: true,
        },
        altText: {
          type: String,
        },
      },
    ],
    isFeatured: {
      type: Boolean,
      default: false,
    },
    isPublished: {
      type: Boolean,
      default: false,
    },
    rating: {
      type: Number,
      default: 0,
    },
    numReviews: {
      type: Number,
      default: 0,
    },
    tags: &#91;String],
    user: {
      type: mongoose.Schema.Types.ObjectId,
      ref: "User",
      required: true,
    },
    metaTitle: {
      type: String,
    },
    metaDescription: {
      type: String,
    },
    metaKeywords: {
      type: String,
    },
    dimensions: {
      length: Number,
      width: Number,
      height: Number,
    },
    weight: Number,
  },
  { timestamps: true }
);

module.exports = mongoose.model("Product", productSchema);
</code></pre>



<pre class="wp-block-code"><code>// backend/routes/productRoutes.js
const express = require("express");
const Product = require("../models/Product");
const { protect, admin } = require("../middleware/authMiddleware");

const router = express.Router();

// @route POST /api/products - @路由、使用 POST 方法、API 的路徑
// @desc Create a new Product - @描述 - 建立新的產品
// @access Private/Admin - @訪問權限 - 私人/管理員
router.post("/", protect, admin, async (req, res) =&gt; {
  try {
    const {
      name,
      description,
      price,
      discountPrice,
      countInStock,
      category,
      brand,
      sizes,
      colors,
      collections,
      material,
      gender,
      images,
      isFeatured,
      isPublished,
      tags,
      dimensions,
      weight,
      sku,
    } = req.body;

    const product = new Product({
      name,
      description,
      price,
      discountPrice,
      countInStock,
      category,
      brand,
      sizes,
      colors,
      collections,
      material,
      gender,
      images,
      isFeatured,
      isPublished,
      tags,
      dimensions,
      weight,
      sku,
      user: req.user._id, // Reference to the admin user who created it
    });

    const createdProduct = await product.save();
    res.status(201).json(createdProduct);
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

module.exports = router;
</code></pre>



<h2 class="wp-block-heading">使用 Postman API 測試工具</h2>



<ul class="wp-block-list">
<li>Create new collection – 建立新的集合<br>Products</li>



<li>Add a request – 新增請求<br>Create、POST、http://localhost:9000/api/products</li>



<li>Body &gt; raw</li>



<li>Headers &gt; Key、Value</li>
</ul>



<pre class="wp-block-code"><code>// Postman - Products/Create
// Body &gt; raw
{
  "name": "Classic Denim Jacket",
  "description": "A timeless denim jacket perfect for any season. Comfortable fit and durable material",
  "price": 59.99,
  "discountPrice": 49.99,
  "countInStock": 200,
  "category": "Apparel",
  "brand": "UrbanWear",
  "sizes": &#91;"XS", "S", "M", "L", "XL"],
  "colors": &#91;"Blue", "Black"],
  "collections": "Spring Collection",
  "material": "Denim",
  "gender": "Unisex",
  "images": &#91;
    {
      "url": "https://picsum.photos/seed/denim1/500/500",
      "altText": "Front view of the denim jacket"
    },
    {
      "url": "https://picsum.photos/seed/denim2/500/500",
      "altText": "Back view of the denim jacket"
    }
  ],
  "isFeatured": true,
  "isPublished": true,
  "tags": &#91;"denim", "jacket", "casual", "spring"],
  "dimensions": {
    "length": 12,
    "width": 8,
    "height": 1
  },
  "weight": 1.5,
  "sku": "CLTH12345"
}
</code></pre>



<pre class="wp-block-code"><code>// Postman - Products/Create
// Headers
Key: Authorization
Value: Bearer 你的Token</code></pre>



<pre class="wp-block-code"><code>// backend/server.js
const express = require("express");
const cors = require("cors");
const dotenv = require("dotenv");
const connectDB = require("./config/db");
const userRoutes = require("./routes/userRoutes");
const productRoutes = require("./routes/productRoutes");

const app = express();
app.use(express.json());
app.use(cors());

dotenv.config();

// console.log(process.env.PORT);
const PORT = process.env.PORT || 3000;

// Connect to MongoDB - 連接到 MongoDB
connectDB();

app.get("/", (req, res) =&gt; {
  res.send("WELCOME TO RABBIT API!");
});

// API Routes - API 路由
app.use("/api/users", userRoutes);
app.use("/api/products", productRoutes);

app.listen(PORT, () =&gt; {
  console.log(`Server is running on http://localhost:${PORT}`);
});
</code></pre>



<h2 class="wp-block-heading">查看 MongoDB Atlas</h2>



<ul class="wp-block-list">
<li>Browse collections (瀏覽集合) &gt; products</li>
</ul>



<pre class="wp-block-code"><code>// backend/middleware/authMiddleware.js
const jwt = require("jsonwebtoken");
const User = require("../models/User");

// Middleware to protect routes
const protect = async (req, res, next) =&gt; {
  let token;

  if (
    req.headers.authorization &amp;&amp;
    req.headers.authorization.startsWith("Bearer")
  ) {
    try {
      token = req.headers.authorization.split(" ")&#91;1];
      const decoded = jwt.verify(token, process.env.JWT_SECRET);

      req.user = await User.findById(decoded.user.id).select("-password"); // Exclude password - 排除密碼
      next();
    } catch (error) {
      console.error("Token verification failed:", error);
      res.status(401).json({ message: "Not authorized, token failed" });
    }
  } else {
    res.status(401).json({ message: "Not authorized, no token provided" });
  }
};

// Middleware to check if the user is an admin - 中介軟體檢查用戶是否為管理員
const admin = (req, res, next) =&gt; {
  if (req.user &amp;&amp; req.user.role === "admin") {
    next();
  } else {
    res.status(403).json({ message: "Not authorized as an admin" });
  }
};

module.exports = { protect, admin };
</code></pre>



<h2 class="wp-block-heading">手動調整 MongoDB 資料庫</h2>



<ul class="wp-block-list">
<li>customer 手動調整為 admin</li>
</ul>



<h2 class="wp-block-heading">使用 Postman API 測試工具</h2>



<ul class="wp-block-list">
<li>Postman – Products/Create 測試管理員功能<br>name、sku 都需要做調整</li>
</ul>



<pre class="wp-block-code"><code>// Postman - Products/Create
// Body &gt; raw
{
    "name": "Classic Denim Jeans",
    "description": "A timeless denim jacket perfect for any season. Comfortable fit and durable material",
    "price": 59.99,
    "discountPrice": 49.99,
    "countInStock": 200,
    "sku": "CLTH123456",
    "category": "Apparel",
    "brand": "UrbanWear",
    "sizes": &#91;
        "XS",
        "S",
        "M",
        "L",
        "XL"
    ],
    "colors": &#91;
        "Blue",
        "Black"
    ],
    "collections": "Spring Collection",
    "material": "Denim",
    "gender": "Unisex",
    "images": &#91;
        {
            "url": "https://picsum.photos/seed/denim1/500/500",
            "altText": "Front view of the denim jacket",
            "_id": "67d0f15ef9aec7935e64f4be"
        },
        {
            "url": "https://picsum.photos/seed/denim2/500/500",
            "altText": "Back view of the denim jacket",
            "_id": "67d0f15ef9aec7935e64f4bf"
        }
    ],
    "isFeatured": true,
    "isPublished": true,
    "rating": 0,
    "numReviews": 0,
    "tags": &#91;
        "denim",
        "jacket",
        "casual",
        "spring"
    ],
    "user": "67ced561a2b8dd3a07c40918",
    "dimensions": {
        "length": 12,
        "width": 8,
        "height": 1
    },
    "weight": 1.5,
    "_id": "67d0f15ef9aec7935e64f4bd",
    "createdAt": "2025-03-12T02:28:46.647Z",
    "updatedAt": "2025-03-12T02:28:46.647Z",
    "__v": 0
}
</code></pre>



<h2 class="wp-block-heading">Update Product (更新產品)</h2>



<pre class="wp-block-code"><code>// backend/routes/productRoutes.js
const express = require("express");
const Product = require("../models/Product");
const { protect, admin } = require("../middleware/authMiddleware");

const router = express.Router();

// @route POST /api/products - @路由、使用 POST 方法、API 的路徑
// @desc Create a new Product - @描述 建立新的產品
// @access Private/Admin - @訪問權限 私人/管理員
router.post("/", protect, admin, async (req, res) =&gt; {
  try {
    const {
      name,
      description,
      price,
      discountPrice,
      countInStock,
      category,
      brand,
      sizes,
      colors,
      collections,
      material,
      gender,
      images,
      isFeatured,
      isPublished,
      tags,
      dimensions,
      weight,
      sku,
    } = req.body;

    const product = new Product({
      name,
      description,
      price,
      discountPrice,
      countInStock,
      category,
      brand,
      sizes,
      colors,
      collections,
      material,
      gender,
      images,
      isFeatured,
      isPublished,
      tags,
      dimensions,
      weight,
      sku,
      user: req.user._id, // Reference to the admin user who created it
    });

    const createdProduct = await product.save();
    res.status(201).json(createdProduct);
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route PUT /api/products/:id - @路由、使用 PUT 方法、API 的路徑
// @desc Update an existing product ID - @描述 更新現有產品ID
// @access Private/Admin - @訪問權限 私人/管理員
router.put("/:id", protect, admin, async (req, res) =&gt; {
  try {
    const {
      name,
      description,
      price,
      discountPrice,
      countInStock,
      category,
      brand,
      sizes,
      colors,
      collections,
      material,
      gender,
      images,
      isFeatured,
      isPublished,
      tags,
      dimensions,
      weight,
      sku,
    } = req.body;

    // Find product by ID - 根據 ID 查找產品
    const product = await Product.findById(req.params.id);

    if (product) {
      // Update product fields - 更新產品欄位
      product.name = name || product.name;
      product.description = description || product.description;
      product.price = price || product.price;
      product.discountPrice = discountPrice || product.discountPrice;
      product.countInStock = countInStock || product.countInStock;
      product.category = category || product.category;
      product.brand = brand || product.brand;
      product.sizes = sizes || product.sizes;
      product.colors = colors || product.colors;
      product.collections = collections || product.collections;
      product.material = material || product.material;
      product.gender = gender || product.gender;
      product.images = images || product.images;
      product.isFeatured =
        isFeatured !== undefined ? isFeatured : product.isFeatured;
      product.isPublished =
        isPublished !== undefined ? isPublished : product.isPublished;
      product.tags = tags || product.tags;
      product.dimensions = dimensions || product.dimensions;
      product.weight = weight || product.weight;
      product.sku = sku || product.sku;

      // Save the updated product - 儲存更新的產品
      const updatedProduct = await product.save();
      res.json(updatedProduct);
    } else {
      res.status(404).json({
        message: "Product not found",
      });
    }
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

module.exports = router;
</code></pre>



<h2 class="wp-block-heading">使用 Postman API 測試工具</h2>



<ul class="wp-block-list">
<li>Collections: Products – 集合: 產品</li>



<li>Add request – 新增請求<br>Update、PUT、http://localhost:9000/api/products/67d0f15ef9aec7935e64f4bd</li>



<li>Headers &gt; Key、Value</li>



<li>Body &gt; raw</li>
</ul>



<pre class="wp-block-code"><code>// Postman - Products/Update
// Headers
Key: Authorization
Value: Bearer 你的Token
</code></pre>



<pre class="wp-block-code"><code>// Postman - Products/Update
// Body &gt; raw
{
    "name": "Winter Jacket"
}
</code></pre>



<h2 class="wp-block-heading">查看 MongoDB Atlas 資料庫</h2>



<ul class="wp-block-list">
<li>查看是否有更新產品名稱</li>



<li>測試更新 name、description、sizes 欄位的值</li>
</ul>



<pre class="wp-block-code"><code>// Postman - Products/Update
// Body &gt; raw
{
    "name": "Winter Jacket long Sleeves",
    "description": "Long Sleeves Jackets",
    "sizes": &#91;"S", "M"]
}
</code></pre>



<h2 class="wp-block-heading">Delete Product (刪除產品)</h2>



<pre class="wp-block-code"><code>// backend/routes/productRoutes.js
const express = require("express");
const Product = require("../models/Product");
const { protect, admin } = require("../middleware/authMiddleware");

const router = express.Router();

// @route POST /api/products - @路由、使用 POST 方法、API 的路徑
// @desc Create a new Product - @描述 建立新的產品
// @access Private/Admin - @訪問權限 私人/管理員
router.post("/", protect, admin, async (req, res) =&gt; {
  try {
    const {
      name,
      description,
      price,
      discountPrice,
      countInStock,
      category,
      brand,
      sizes,
      colors,
      collections,
      material,
      gender,
      images,
      isFeatured,
      isPublished,
      tags,
      dimensions,
      weight,
      sku,
    } = req.body;

    const product = new Product({
      name,
      description,
      price,
      discountPrice,
      countInStock,
      category,
      brand,
      sizes,
      colors,
      collections,
      material,
      gender,
      images,
      isFeatured,
      isPublished,
      tags,
      dimensions,
      weight,
      sku,
      user: req.user._id, // Reference to the admin user who created it
    });

    const createdProduct = await product.save();
    res.status(201).json(createdProduct);
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route PUT /api/products/:id - @路由、使用 PUT 方法、API 的路徑
// @desc Update an existing product ID - @描述 更新現有產品ID
// @access Private/Admin - @訪問權限 私人/管理員
router.put("/:id", protect, admin, async (req, res) =&gt; {
  try {
    const {
      name,
      description,
      price,
      discountPrice,
      countInStock,
      category,
      brand,
      sizes,
      colors,
      collections,
      material,
      gender,
      images,
      isFeatured,
      isPublished,
      tags,
      dimensions,
      weight,
      sku,
    } = req.body;

    // Find product by ID - 根據 ID 查找產品
    const product = await Product.findById(req.params.id);

    if (product) {
      // Update product fields - 更新產品欄位
      product.name = name || product.name;
      product.description = description || product.description;
      product.price = price || product.price;
      product.discountPrice = discountPrice || product.discountPrice;
      product.countInStock = countInStock || product.countInStock;
      product.category = category || product.category;
      product.brand = brand || product.brand;
      product.sizes = sizes || product.sizes;
      product.colors = colors || product.colors;
      product.collections = collections || product.collections;
      product.material = material || product.material;
      product.gender = gender || product.gender;
      product.images = images || product.images;
      product.isFeatured =
        isFeatured !== undefined ? isFeatured : product.isFeatured;
      product.isPublished =
        isPublished !== undefined ? isPublished : product.isPublished;
      product.tags = tags || product.tags;
      product.dimensions = dimensions || product.dimensions;
      product.weight = weight || product.weight;
      product.sku = sku || product.sku;

      // Save the updated product - 儲存更新的產品
      const updatedProduct = await product.save();
      res.json(updatedProduct);
    } else {
      res.status(404).json({
        message: "Product not found",
      });
    }
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route DELETE /api/products/:id - @路由、使用 DELETE 方法、API 的路徑
// @desc Delete a product by ID - @描述、根據 ID 刪除產品
// @access Private/Admin - @訪問權限、私人/管理員
router.delete("/:id", protect, admin, async (req, res) =&gt; {
  try {
    // Find the product by ID - 根據 ID 查找產品
    const product = await Product.findById(req.params.id);

    if (product) {
      // Remove the product from DB - 從資料庫移除產品
      await product.deleteOne();
      res.json({ message: "Product remove" });
    } else {
      res.status(404).json({ message: "Product not found" });
    }
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

module.exports = router;
</code></pre>



<h2 class="wp-block-heading">使用 Postman API 測試工具</h2>



<ul class="wp-block-list">
<li>Collections: Products – 集合: 產品</li>



<li>Add request – 新增請求<br>Delete、DELETE、http://localhost:9000/api/products/67d0f15ef9aec7935e64f4bd</li>



<li>Headers &gt; Key、Value</li>
</ul>



<pre class="wp-block-code"><code>// Postman - Products/Delete
// Headers
Key: Authorization
Value: Bearer 你的Token
</code></pre>



<h2 class="wp-block-heading">查看 MongoDB Atlas 資料庫</h2>



<ul class="wp-block-list">
<li>查看是否有刪除產品</li>
</ul>



<h2 class="wp-block-heading">下載使用產品資料</h2>



<ul class="wp-block-list">
<li><a href="https://github.com/kushald/rabbit-assets/blob/main/data/products.js" target="_blank" rel="noreferrer noopener">data/product.js</a></li>
</ul>



<pre class="wp-block-code"><code>// backend/data/products.js
// product.js:

const products = &#91;
  {
    name: "Classic Oxford Button-Down Shirt",
    description:
      "This classic Oxford shirt is tailored for a polished yet casual look. Crafted from high-quality cotton, it features a button-down collar and a comfortable, slightly relaxed fit. Perfect for both formal and casual occasions, it comes with long sleeves, a button placket, and a yoke at the back. The shirt is finished with a gently rounded hem and adjustable button cuffs.",
    price: 39.99,
    discountPrice: 34.99,
    countInStock: 20,
    sku: "OX-SH-001",
    category: "Top Wear",
    brand: "Urban Threads",
    sizes: &#91;"S", "M", "L", "XL", "XXL"],
    colors: &#91;"Red", "Blue", "Yellow"],
    collections: "Business Casual",
    material: "Cotton",
    gender: "Men",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=39",
        altText: "Classic Oxford Button-Down Shirt Front View",
      },
      {
        url: "https://picsum.photos/500/500?random=40",
        altText: "Classic Oxford Button-Down Shirt Back View",
      },
    ],
    rating: 4.5,
    numReviews: 12,
  },
  {
    name: "Slim-Fit Stretch Shirt",
    description:
      "A versatile slim-fit shirt perfect for business or evening events. Designed with a fitted silhouette, the added stretch provides maximum comfort throughout the day. Features a crisp turn-down collar, button placket, and adjustable cuffs.",
    price: 29.99,
    discountPrice: 24.99,
    countInStock: 35,
    sku: "SLIM-SH-002",
    category: "Top Wear",
    brand: "Modern Fit",
    sizes: &#91;"S", "M", "L", "XL"],
    colors: &#91;"Black", "Navy Blue", "Burgundy"],
    collections: "Formal Wear",
    material: "Cotton Blend",
    gender: "Men",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=41",
        altText: "Slim-Fit Stretch Shirt Front View",
      },
      {
        url: "https://picsum.photos/500/500?random=42",
        altText: "Slim-Fit Stretch Shirt Back View",
      },
    ],
    rating: 4.8,
    numReviews: 15,
  },
  {
    name: "Casual Denim Shirt",
    description:
      "This casual denim shirt is made from lightweight cotton denim. It features a regular fit, snap buttons, and a straight hem. With Western-inspired details, this shirt is perfect for layering or wearing solo.",
    price: 49.99,
    discountPrice: 44.99,
    countInStock: 15,
    sku: "CAS-DEN-003",
    category: "Top Wear",
    brand: "Street Style",
    sizes: &#91;"S", "M", "L", "XL", "XXL"],
    colors: &#91;"Light Blue", "Dark Wash"],
    collections: "Casual Wear",
    material: "Denim",
    gender: "Men",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=43",
        altText: "Casual Denim Shirt Front View",
      },
      {
        url: "https://picsum.photos/500/500?random=44",
        altText: "Casual Denim Shirt Back View",
      },
    ],
    rating: 4.6,
    numReviews: 8,
  },
  {
    name: "Printed Resort Shirt",
    description:
      "Designed for summer, this printed resort shirt is perfect for vacation or weekend getaways. It features a relaxed fit, short sleeves, and a camp collar. The all-over tropical print adds a playful vibe.",
    price: 29.99,
    discountPrice: 22.99,
    countInStock: 25,
    sku: "PRNT-RES-004",
    category: "Top Wear",
    brand: "Beach Breeze",
    sizes: &#91;"S", "M", "L", "XL"],
    colors: &#91;"Tropical Print", "Navy Palms"],
    collections: "Vacation Wear",
    material: "Viscose",
    gender: "Men",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=45",
        altText: "Printed Resort Shirt Front View",
      },
      {
        url: "https://picsum.photos/500/500?random=1",
        altText: "Printed Resort Shirt Back View",
      },
    ],
    rating: 4.4,
    numReviews: 10,
  },
  {
    name: "Slim-Fit Easy-Iron Shirt",
    description:
      "A slim-fit, easy-iron shirt in woven cotton fabric with a fitted silhouette. Features a turn-down collar, classic button placket, and a yoke at the back. Long sleeves and adjustable button cuffs with a rounded hem.",
    price: 34.99,
    discountPrice: 29.99,
    countInStock: 30,
    sku: "SLIM-EIR-005",
    category: "Top Wear",
    brand: "Urban Chic",
    sizes: &#91;"S", "M", "L", "XL"],
    colors: &#91;"White", "Gray"],
    collections: "Business Wear",
    material: "Cotton",
    gender: "Men",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=47",
        altText: "Slim-Fit Easy-Iron Shirt Front View",
      },
      {
        url: "https://picsum.photos/500/500?random=2",
        altText: "Slim-Fit Easy-Iron Shirt Front View",
      },
    ],
    rating: 5,
    numReviews: 14,
  },
  {
    name: "Polo T-Shirt with Ribbed Collar",
    description:
      "A wardrobe classic, this polo t-shirt features a ribbed collar and cuffs. Made from 100% cotton, it offers breathability and comfort throughout the day. Tailored in a slim fit with a button placket at the neckline.",
    price: 24.99,
    discountPrice: 19.99,
    countInStock: 50,
    sku: "POLO-TSH-006",
    category: "Top Wear",
    brand: "Polo Classics",
    sizes: &#91;"S", "M", "L", "XL"],
    colors: &#91;"White", "Navy", "Red"],
    collections: "Casual Wear",
    material: "Cotton",
    gender: "Men",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=3",
        altText: "Polo T-Shirt Front View",
      },
      {
        url: "https://picsum.photos/500/500?random=4",
        altText: "Polo T-Shirt Back View",
      },
    ],
    rating: 4.3,
    numReviews: 22,
  },
  {
    name: "Oversized Graphic T-Shirt",
    description:
      "An oversized graphic t-shirt that combines comfort with street style. Featuring bold prints across the chest, this relaxed fit tee offers a modern vibe, perfect for pairing with jeans or joggers.",
    price: 19.99,
    discountPrice: 15.99,
    countInStock: 40,
    sku: "OVS-GRF-007",
    category: "Top Wear",
    brand: "Street Vibes",
    sizes: &#91;"S", "M", "L", "XL"],
    colors: &#91;"Black", "Gray"],
    collections: "Streetwear",
    material: "Cotton",
    gender: "Men",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=5",
        altText: "Oversized Graphic T-Shirt Front View",
      },
    ],
    rating: 4.6,
    numReviews: 30,
  },
  {
    name: "Regular-Fit Henley Shirt",
    description:
      "A modern take on the classic Henley shirt, this regular-fit style features a buttoned placket and ribbed cuffs. Made from a soft cotton blend with a touch of elastane for stretch.",
    price: 22.99,
    discountPrice: 18.99,
    countInStock: 35,
    sku: "REG-HEN-008",
    category: "Top Wear",
    brand: "Heritage Wear",
    sizes: &#91;"S", "M", "L", "XL"],
    colors: &#91;"Heather Gray", "Olive", "Black"],
    collections: "Casual Wear",
    material: "Cotton Blend",
    gender: "Men",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=6",
        altText: "Regular-Fit Henley Shirt Front View",
      },
    ],
    rating: 4.5,
    numReviews: 25,
  },
  {
    name: "Long-Sleeve Thermal Tee",
    description:
      "Stay warm with this long-sleeve thermal tee, made from soft cotton with a waffle-knit texture. Ideal for layering in cooler months, the slim-fit design ensures a snug yet comfortable fit.",
    price: 27.99,
    discountPrice: 22.99,
    countInStock: 20,
    sku: "LST-THR-009",
    category: "Top Wear",
    brand: "Winter Basics",
    sizes: &#91;"S", "M", "L", "XL", "XXL"],
    colors: &#91;"Charcoal", "Dark Green", "Navy"],
    collections: "Winter Essentials",
    material: "Cotton",
    gender: "Men",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=7",
        altText: "Long-Sleeve Thermal Tee Front View",
      },
    ],
    rating: 4.4,
    numReviews: 18,
  },
  {
    name: "V-Neck Classic T-Shirt",
    description:
      "A classic V-neck t-shirt for everyday wear. This regular-fit tee is made from breathable cotton and features a clean, simple design with a flattering V-neckline. Lightweight fabric and soft texture make it perfect for casual looks.",
    price: 14.99,
    discountPrice: 11.99,
    countInStock: 60,
    sku: "VNECK-CLS-010",
    category: "Top Wear",
    brand: "Everyday Comfort",
    sizes: &#91;"S", "M", "L", "XL"],
    colors: &#91;"White", "Black", "Navy"],
    collections: "Basics",
    material: "Cotton",
    gender: "Men",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=8",
        altText: "V-Neck Classic T-Shirt Front View",
      },
    ],
    rating: 4.7,
    numReviews: 28,
  },
  {
    name: "Slim Fit Joggers",
    description:
      "Slim-fit joggers with an elasticated drawstring waist. Features ribbed hems and side pockets. Ideal for casual outings or workouts.",
    price: 40,
    discountPrice: 35,
    countInStock: 20,
    sku: "BW-001",
    category: "Bottom Wear",
    brand: "ActiveWear",
    sizes: &#91;"S", "M", "L", "XL"],
    colors: &#91;"Black", "Gray", "Navy"],
    collections: "Casual Collection",
    material: "Cotton Blend",
    gender: "Men",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=9",
        altText: "Slim Fit Joggers Front View",
      },
    ],
    rating: 4.5,
    numReviews: 12,
  },
  {
    name: "Cargo Joggers",
    description:
      "Relaxed-fit cargo joggers featuring multiple pockets for functionality. Drawstring waist and cuffed hems for a modern look.",
    price: 45,
    discountPrice: 40,
    countInStock: 15,
    sku: "BW-002",
    category: "Bottom Wear",
    brand: "UrbanStyle",
    sizes: &#91;"S", "M", "L", "XL"],
    colors: &#91;"Olive", "Black"],
    collections: "Urban Collection",
    material: "Cotton",
    gender: "Men",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=10",
        altText: "Cargo Joggers Front View",
      },
    ],
    rating: 4.7,
    numReviews: 20,
  },
  {
    name: "Tapered Sweatpants",
    description:
      "Tapered sweatpants designed for comfort. Elastic waistband with adjustable drawstring, perfect for lounging or athletic activities.",
    price: 35,
    discountPrice: 30,
    countInStock: 25,
    sku: "BW-003",
    category: "Bottom Wear",
    brand: "ChillZone",
    sizes: &#91;"S", "M", "L", "XL"],
    colors: &#91;"Gray", "Charcoal", "Blue"],
    collections: "Lounge Collection",
    material: "Fleece",
    gender: "Men",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=11",
        altText: "Tapered Sweatpants Front View",
      },
    ],
    rating: 4.3,
    numReviews: 18,
  },
  {
    name: "Denim Jeans",
    description:
      "Classic slim-fit denim jeans with a slight stretch for comfort. Features a zip fly and five-pocket styling for a timeless look.",
    price: 60,
    discountPrice: 50,
    countInStock: 30,
    sku: "BW-004",
    category: "Bottom Wear",
    brand: "DenimCo",
    sizes: &#91;"S", "M", "L", "XL"],
    colors: &#91;"Dark Blue", "Light Blue"],
    collections: "Denim Collection",
    material: "Denim",
    gender: "Men",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=12",
        altText: "Denim Jeans Front View",
      },
    ],
    rating: 4.6,
    numReviews: 22,
  },
  {
    name: "Chino Pants",
    description:
      "Slim-fit chino pants made from stretch cotton twill. Features a button closure and front and back pockets. Ideal for both casual and semi-formal wear.",
    price: 55,
    discountPrice: 48,
    countInStock: 40,
    sku: "BW-005",
    category: "Bottom Wear",
    brand: "CasualLook",
    sizes: &#91;"S", "M", "L", "XL"],
    colors: &#91;"Beige", "Navy", "Black"],
    collections: "Smart Casual Collection",
    material: "Cotton",
    gender: "Men",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=13",
        altText: "Chino Pants Front View",
      },
    ],
    rating: 4.8,
    numReviews: 15,
  },
  {
    name: "Track Pants",
    description:
      "Comfortable track pants with an elasticated waistband and tapered leg. Features side stripes for a sporty look. Ideal for athletic and casual wear.",
    price: 40,
    discountPrice: 35,
    countInStock: 20,
    sku: "BW-006",
    category: "Bottom Wear",
    brand: "SportX",
    sizes: &#91;"S", "M", "L", "XL"],
    colors: &#91;"Black", "Red", "Blue"],
    collections: "Activewear Collection",
    material: "Polyester",
    gender: "Men",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=14",
        altText: "Track Pants Front View",
      },
    ],
    rating: 4.2,
    numReviews: 17,
  },
  {
    name: "Slim Fit Trousers",
    description:
      "Tailored slim-fit trousers with belt loops and a hook-and-eye closure. Suitable for formal occasions or smart-casual wear.",
    price: 65,
    discountPrice: 55,
    countInStock: 15,
    sku: "BW-007",
    category: "Bottom Wear",
    brand: "ExecutiveStyle",
    sizes: &#91;"M", "L", "XL"],
    colors: &#91;"Gray", "Black"],
    collections: "Office Wear",
    material: "Polyester",
    gender: "Men",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=15",
        altText: "Slim Fit Trousers Front View",
      },
    ],
    rating: 4.7,
    numReviews: 10,
  },
  {
    name: "Cargo Pants",
    description:
      "Loose-fit cargo pants with multiple utility pockets. Features adjustable ankle cuffs and a drawstring waist for versatility and comfort.",
    price: 50,
    discountPrice: 45,
    countInStock: 25,
    sku: "BW-008",
    category: "Bottom Wear",
    brand: "StreetWear",
    sizes: &#91;"S", "M", "L", "XL"],
    colors: &#91;"Olive", "Brown", "Black"],
    collections: "Street Style Collection",
    material: "Cotton",
    gender: "Men",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=16",
        altText: "Cargo Pants Front View",
      },
    ],
    rating: 4.5,
    numReviews: 13,
  },
  {
    name: "Relaxed Fit Sweatpants",
    description:
      "Relaxed-fit sweatpants made from soft fleece fabric. Features an elastic waist and adjustable drawstring for a custom fit.",
    price: 35,
    discountPrice: 30,
    countInStock: 35,
    sku: "BW-009",
    category: "Bottom Wear",
    brand: "LoungeWear",
    sizes: &#91;"S", "M", "L", "XL"],
    colors: &#91;"Gray", "Black", "Navy"],
    collections: "Lounge Collection",
    material: "Fleece",
    gender: "Men",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=17",
        altText: "Relaxed Fit Sweatpants Front View",
      },
    ],
    rating: 4.3,
    numReviews: 14,
  },
  {
    name: "Formal Dress Pants",
    description:
      "Classic formal dress pants with a slim fit. Made from lightweight, wrinkle-resistant fabric for a polished look at the office or formal events.",
    price: 70,
    discountPrice: 60,
    countInStock: 20,
    sku: "BW-010",
    category: "Bottom Wear",
    brand: "ElegantStyle",
    sizes: &#91;"M", "L", "XL"],
    colors: &#91;"Black", "Navy"],
    collections: "Formal Collection",
    material: "Polyester",
    gender: "Men",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=18",
        altText: "Formal Dress Pants Front View",
      },
    ],
    rating: 4.9,
    numReviews: 8,
  },
  {
    name: "High-Waist Skinny Jeans",
    description:
      "High-waist skinny jeans in stretch denim with a button and zip fly. Features a flattering fit that hugs your curves and enhances your silhouette.",
    price: 50,
    discountPrice: 45,
    countInStock: 30,
    sku: "BW-W-001",
    category: "Bottom Wear",
    brand: "DenimStyle",
    sizes: &#91;"XS", "S", "M", "L", "XL"],
    colors: &#91;"Dark Blue", "Black", "Light Blue"],
    collections: "Denim Collection",
    material: "Denim",
    gender: "Women",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=19",
        altText: "High-Waist Skinny Jeans",
      },
    ],
    rating: 4.8,
    numReviews: 20,
  },
  {
    name: "Wide-Leg Trousers",
    description:
      "Flowy, wide-leg trousers with a high waist and side pockets. Perfect for an elegant look that combines comfort and style.",
    price: 60,
    discountPrice: 55,
    countInStock: 25,
    sku: "BW-W-002",
    category: "Bottom Wear",
    brand: "ElegantWear",
    sizes: &#91;"S", "M", "L", "XL"],
    colors: &#91;"Beige", "Black", "White"],
    collections: "Formal Collection",
    material: "Polyester",
    gender: "Women",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=20",
        altText: "Wide-Leg Trousers Front View",
      },
    ],
    rating: 4.7,
    numReviews: 15,
  },
  {
    name: "Stretch Leggings",
    description:
      "Soft, stretch leggings in a high-rise style. Perfect for lounging, working out, or casual wear, with a smooth fit that flatters your body.",
    price: 25,
    discountPrice: 20,
    countInStock: 40,
    sku: "BW-W-003",
    category: "Bottom Wear",
    brand: "ComfyFit",
    sizes: &#91;"S", "M", "L", "XL"],
    colors: &#91;"Black", "Gray", "Navy"],
    collections: "Activewear Collection",
    material: "Cotton Blend",
    gender: "Women",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=21",
        altText: "Stretch Leggings Front View",
      },
    ],
    rating: 4.5,
    numReviews: 30,
  },
  {
    name: "Pleated Midi Skirt",
    description:
      "Elegant pleated midi skirt with a high waistband and soft fabric that drapes beautifully. Ideal for both formal and casual occasions.",
    price: 55,
    discountPrice: 50,
    countInStock: 20,
    sku: "BW-W-004",
    category: "Bottom Wear",
    brand: "ChicStyle",
    sizes: &#91;"S", "M", "L"],
    colors: &#91;"Pink", "Navy", "Black"],
    collections: "Spring Collection",
    material: "Polyester",
    gender: "Women",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=22",
        altText: "Pleated Midi Skirt Front View",
      },
    ],
    rating: 4.6,
    numReviews: 18,
  },
  {
    name: "Flared Palazzo Pants",
    description:
      "High-waist palazzo pants with a loose, flowing fit. Comfortable and stylish, making them perfect for casual outings or beach days.",
    price: 45,
    discountPrice: 40,
    countInStock: 35,
    sku: "BW-W-005",
    category: "Bottom Wear",
    brand: "BreezyVibes",
    sizes: &#91;"S", "M", "L", "XL"],
    colors: &#91;"White", "Beige", "Light Blue"],
    collections: "Summer Collection",
    material: "Linen Blend",
    gender: "Women",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=23",
        altText: "Flared Palazzo Pants Front View",
      },
    ],
    rating: 4.4,
    numReviews: 22,
  },
  {
    name: "High-Rise Joggers",
    description:
      "Comfortable high-rise joggers with an elastic waistband and drawstring for a perfect fit. Great for lounging or working out.",
    price: 40,
    discountPrice: 35,
    countInStock: 30,
    sku: "BW-W-006",
    category: "Bottom Wear",
    brand: "ActiveWear",
    sizes: &#91;"XS", "S", "M", "L"],
    colors: &#91;"Black", "Gray", "Pink"],
    collections: "Loungewear Collection",
    material: "Cotton Blend",
    gender: "Women",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=24",
        altText: "High-Rise Joggers Front View",
      },
    ],
    rating: 4.3,
    numReviews: 25,
  },
  {
    name: "Paperbag Waist Shorts",
    description:
      "Stylish paperbag waist shorts with a belted waist and wide legs. Perfect for summer outings and keeping cool in style.",
    price: 35,
    discountPrice: 30,
    countInStock: 20,
    sku: "BW-W-007",
    category: "Bottom Wear",
    brand: "SunnyStyle",
    sizes: &#91;"S", "M", "L"],
    colors: &#91;"White", "Khaki", "Blue"],
    collections: "Summer Collection",
    material: "Cotton",
    gender: "Women",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=25",
        altText: "Paperbag Waist Shorts Front View",
      },
    ],
    rating: 4.5,
    numReviews: 19,
  },
  {
    name: "Stretch Denim Shorts",
    description:
      "Comfortable stretch denim shorts with a high-waisted fit and raw hem. Perfect for pairing with your favorite tops during warmer months.",
    price: 40,
    discountPrice: 35,
    countInStock: 25,
    sku: "BW-W-008",
    category: "Bottom Wear",
    brand: "DenimStyle",
    sizes: &#91;"S", "M", "L", "XL"],
    colors: &#91;"Blue", "Black", "White"],
    collections: "Denim Collection",
    material: "Denim",
    gender: "Women",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=26",
        altText: "Stretch Denim Shorts Front View",
      },
    ],
    rating: 4.7,
    numReviews: 15,
  },
  {
    name: "Culottes",
    description:
      "Wide-leg culottes with a flattering high waist and cropped length. The perfect blend of comfort and style for any casual occasion.",
    price: 50,
    discountPrice: 45,
    countInStock: 30,
    sku: "BW-W-009",
    category: "Bottom Wear",
    brand: "ChicStyle",
    sizes: &#91;"S", "M", "L", "XL"],
    colors: &#91;"Black", "White", "Olive"],
    collections: "Casual Collection",
    material: "Polyester",
    gender: "Women",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=27",
        altText: "Culottes Front View",
      },
    ],
    rating: 4.6,
    numReviews: 23,
  },
  {
    name: "Classic Pleated Trousers",
    description:
      "Timeless pleated trousers with a tailored fit. A wardrobe essential for workwear or formal occasions.",
    price: 70,
    discountPrice: 65,
    countInStock: 25,
    sku: "BW-W-010",
    category: "Bottom Wear",
    brand: "ElegantWear",
    sizes: &#91;"S", "M", "L", "XL"],
    colors: &#91;"Navy", "Black", "Gray"],
    collections: "Formal Collection",
    material: "Wool Blend",
    gender: "Women",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=28",
        altText: "Classic Pleated Trousers Front View",
      },
    ],
    rating: 4.8,
    numReviews: 20,
  },
  {
    name: "Knitted Cropped Top",
    description:
      "A stylish knitted cropped top with a flattering fitted silhouette. Perfect for pairing with high-waisted jeans or skirts for a casual look.",
    price: 40,
    discountPrice: 35,
    countInStock: 25,
    sku: "TW-W-001",
    category: "Top Wear",
    brand: "ChicKnit",
    sizes: &#91;"S", "M", "L"],
    colors: &#91;"Beige", "White"],
    collections: "Knits Collection",
    material: "Cotton Blend",
    gender: "Women",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=29",
        altText: "Knitted Cropped Top",
      },
    ],
    rating: 4.6,
    numReviews: 15,
  },
  {
    name: "Boho Floral Blouse",
    description:
      "Flowy boho blouse with floral patterns, featuring a relaxed fit and balloon sleeves. Ideal for casual summer days.",
    price: 50,
    discountPrice: 45,
    countInStock: 30,
    sku: "TW-W-002",
    category: "Top Wear",
    brand: "BohoVibes",
    sizes: &#91;"S", "M", "L", "XL"],
    colors: &#91;"White", "Pink"],
    collections: "Summer Collection",
    material: "Viscose",
    gender: "Women",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=30",
        altText: "Boho Floral Blouse",
      },
    ],
    rating: 4.7,
    numReviews: 20,
  },
  {
    name: "Casual T-Shirt",
    description:
      "A soft, breathable casual t-shirt with a classic fit. Features a round neckline and short sleeves, perfect for everyday wear.",
    price: 25,
    discountPrice: 20,
    countInStock: 50,
    sku: "TW-W-003",
    category: "Top Wear",
    brand: "ComfyTees",
    sizes: &#91;"S", "M", "L", "XL"],
    colors: &#91;"Black", "White", "Gray"],
    collections: "Essentials",
    material: "Cotton",
    gender: "Women",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=31",
        altText: "Casual T-Shirt",
      },
    ],
    rating: 4.5,
    numReviews: 25,
  },
  {
    name: "Off-Shoulder Top",
    description:
      "An elegant off-shoulder top with ruffled sleeves and a flattering fit. Ideal for adding a touch of femininity to your outfit.",
    price: 45,
    discountPrice: 40,
    countInStock: 35,
    sku: "TW-W-004",
    category: "Top Wear",
    brand: "Elegance",
    sizes: &#91;"S", "M", "L"],
    colors: &#91;"Red", "White", "Blue"],
    collections: "Evening Collection",
    material: "Polyester",
    gender: "Women",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=32",
        altText: "Off-Shoulder Top",
      },
    ],
    rating: 4.7,
    numReviews: 18,
  },
  {
    name: "Lace-Trimmed Cami Top",
    description:
      "A delicate cami top with lace trim and adjustable straps. The lightweight fabric makes it perfect for layering or wearing alone during warmer weather.",
    price: 35,
    discountPrice: 30,
    countInStock: 40,
    sku: "TW-W-005",
    category: "Top Wear",
    brand: "DelicateWear",
    sizes: &#91;"S", "M", "L"],
    colors: &#91;"Black", "White"],
    collections: "Lingerie-Inspired",
    material: "Silk Blend",
    gender: "Women",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=33",
        altText: "Lace-Trimmed Cami Top",
      },
    ],
    rating: 4.8,
    numReviews: 22,
  },
  {
    name: "Graphic Print Tee",
    description:
      "A trendy graphic print tee with a relaxed fit. Pair it with jeans or skirts for a cool and casual look.",
    price: 30,
    discountPrice: 25,
    countInStock: 45,
    sku: "TW-W-006",
    category: "Top Wear",
    brand: "StreetStyle",
    sizes: &#91;"S", "M", "L", "XL"],
    colors: &#91;"White", "Black"],
    collections: "Urban Collection",
    material: "Cotton",
    gender: "Women",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=34",
        altText: "Graphic Print Tee",
      },
    ],
    rating: 4.6,
    numReviews: 30,
  },
  {
    name: "Ribbed Long-Sleeve Top",
    description:
      "A cozy ribbed long-sleeve top that offers comfort and style. Perfect for layering during cooler months.",
    price: 55,
    discountPrice: 50,
    countInStock: 30,
    sku: "TW-W-007",
    category: "Top Wear",
    brand: "ComfortFit",
    sizes: &#91;"S", "M", "L", "XL"],
    colors: &#91;"Gray", "Pink", "Brown"],
    collections: "Fall Collection",
    material: "Cotton Blend",
    gender: "Women",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=35",
        altText: "Ribbed Long-Sleeve Top",
      },
    ],
    rating: 4.7,
    numReviews: 26,
  },
  {
    name: "Ruffle-Sleeve Blouse",
    description:
      "A lightweight ruffle-sleeve blouse with a flattering fit. Perfect for a feminine touch to any outfit.",
    price: 45,
    discountPrice: 40,
    countInStock: 20,
    sku: "TW-W-008",
    category: "Top Wear",
    brand: "FeminineWear",
    sizes: &#91;"S", "M", "L"],
    colors: &#91;"White", "Navy", "Lavender"],
    collections: "Summer Collection",
    material: "Viscose",
    gender: "Women",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=36",
        altText: "Ruffle-Sleeve Blouse",
      },
    ],
    rating: 4.5,
    numReviews: 19,
  },
  {
    name: "Classic Button-Up Shirt",
    description:
      "A versatile button-up shirt that can be dressed up or down. Made from soft fabric with a tailored fit, it's perfect for both casual and formal occasions.",
    price: 60,
    discountPrice: 55,
    countInStock: 25,
    sku: "TW-W-009",
    category: "Top Wear",
    brand: "ClassicStyle",
    sizes: &#91;"S", "M", "L", "XL"],
    colors: &#91;"White", "Light Blue", "Black"],
    collections: "Office Collection",
    material: "Cotton",
    gender: "Women",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=37",
        altText: "Classic Button-Up Shirt",
      },
    ],
    rating: 4.8,
    numReviews: 25,
  },
  {
    name: "V-Neck Wrap Top",
    description:
      "A chic v-neck wrap top with a tie waist. Its elegant style makes it perfect for both casual and semi-formal occasions.",
    price: 50,
    discountPrice: 45,
    countInStock: 30,
    sku: "TW-W-010",
    category: "Top Wear",
    brand: "ChicWrap",
    sizes: &#91;"S", "M", "L"],
    colors: &#91;"Red", "Black", "White"],
    collections: "Evening Collection",
    material: "Polyester",
    gender: "Women",
    images: &#91;
      {
        url: "https://picsum.photos/500/500?random=38",
        altText: "V-Neck Wrap Top",
      },
    ],
    rating: 4.7,
    numReviews: 22,
  },
];

module.exports = products;
</code></pre>



<pre class="wp-block-code"><code>// backend/seeder.js
const mongoose = require("mongoose");
const dotenv = require("dotenv");
const Product = require("./models/Product");
const User = require("./models/User");
const products = require("./data/products");

dotenv.config();

// Conntect to mongoDB - 連接到 MongoDB
mongoose.connect(process.env.MONGO_URI);

// Function to seed data - 數據初始化函數

const seedData = async () =&gt; {
  try {
    // Clear existing data - 清除現有數據
    await Product.deleteMany();
    await User.deleteMany();

    // Create a default admin User 建立默認管理員用戶
    const createdUser = await User.create({
      name: "Admin User",
      email: "admin@example.com",
      password: "123456",
      role: "admin",
    });

    // Assign the default user ID to each product - 將默認用戶 ID 分配給每個產品
    const userID = createdUser._id;

    const sampleProducts = products.map((product) =&gt; {
      return { ...product, user: userID };
    });

    // Insert the products into the database - 將產品插入資料庫
    await Product.insertMany(sampleProducts);

    console.log("Product data seeded successfully!");
    process.exit();
  } catch (error) {
    console.error("Error seeding the data:", error);
    process.exit(1);
  }
};

seedData();
</code></pre>



<pre class="wp-block-code"><code>// backend/package.json
{
  "name": "backend",
  "version": "1.0.0",
  "description": "",
  "main": "server.js",
  "scripts": {
    "start": "node backend/server.js",
    "dev": "nodemon backend/server.js",
    "seed": "node seeder.js"
  },
  "keywords": &#91;],
  "author": "",
  "license": "ISC",
  "dependencies": {
    "bcryptjs": "^3.0.2",
    "cors": "^2.8.5",
    "dotenv": "^16.4.7",
    "express": "^4.21.2",
    "jsonwebtoken": "^9.0.2",
    "mongoose": "^8.12.1",
    "nodemon": "^3.1.9"
  }
}
</code></pre>



<h2 class="wp-block-heading">初始化資料庫資料</h2>



<ul class="wp-block-list">
<li>npm run seed</li>
</ul>



<h2 class="wp-block-heading">查看 MongoDB Atlas 資料庫</h2>



<ul class="wp-block-list">
<li>查看資料是否有初始化資料庫</li>
</ul>



<h2 class="wp-block-heading">All Products (全部產品)</h2>



<pre class="wp-block-code"><code>// backend/routes/productRoutes.js
const express = require("express");
const Product = require("../models/Product");
const { protect, admin } = require("../middleware/authMiddleware");

const router = express.Router();

// @route POST /api/products - @路由、使用 POST 方法、API 的路徑
// @desc Create a new Product - @描述 建立新的產品
// @access Private/Admin - @訪問權限 私人/管理員
router.post("/", protect, admin, async (req, res) =&gt; {
  try {
    const {
      name,
      description,
      price,
      discountPrice,
      countInStock,
      category,
      brand,
      sizes,
      colors,
      collections,
      material,
      gender,
      images,
      isFeatured,
      isPublished,
      tags,
      dimensions,
      weight,
      sku,
    } = req.body;

    const product = new Product({
      name,
      description,
      price,
      discountPrice,
      countInStock,
      category,
      brand,
      sizes,
      colors,
      collections,
      material,
      gender,
      images,
      isFeatured,
      isPublished,
      tags,
      dimensions,
      weight,
      sku,
      user: req.user._id, // Reference to the admin user who created it
    });

    const createdProduct = await product.save();
    res.status(201).json(createdProduct);
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route PUT /api/products/:id - @路由、使用 PUT 方法、API 的路徑
// @desc Update an existing product ID - @描述 更新現有產品ID
// @access Private/Admin - @訪問權限 私人/管理員
router.put("/:id", protect, admin, async (req, res) =&gt; {
  try {
    const {
      name,
      description,
      price,
      discountPrice,
      countInStock,
      category,
      brand,
      sizes,
      colors,
      collections,
      material,
      gender,
      images,
      isFeatured,
      isPublished,
      tags,
      dimensions,
      weight,
      sku,
    } = req.body;

    // Find product by ID - 根據 ID 查找產品
    const product = await Product.findById(req.params.id);

    if (product) {
      // Update product fields - 更新產品欄位
      product.name = name || product.name;
      product.description = description || product.description;
      product.price = price || product.price;
      product.discountPrice = discountPrice || product.discountPrice;
      product.countInStock = countInStock || product.countInStock;
      product.category = category || product.category;
      product.brand = brand || product.brand;
      product.sizes = sizes || product.sizes;
      product.colors = colors || product.colors;
      product.collections = collections || product.collections;
      product.material = material || product.material;
      product.gender = gender || product.gender;
      product.images = images || product.images;
      product.isFeatured =
        isFeatured !== undefined ? isFeatured : product.isFeatured;
      product.isPublished =
        isPublished !== undefined ? isPublished : product.isPublished;
      product.tags = tags || product.tags;
      product.dimensions = dimensions || product.dimensions;
      product.weight = weight || product.weight;
      product.sku = sku || product.sku;

      // Save the updated product - 儲存更新的產品
      const updatedProduct = await product.save();
      res.json(updatedProduct);
    } else {
      res.status(404).json({
        message: "Product not found",
      });
    }
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route DELETE /api/products/:id - @路由、使用 DELETE 方法、API 的路徑
// @desc Delete a product by ID - @描述、根據 ID 刪除產品
// @access Private/Admin - @訪問權限、私人/管理員
router.delete("/:id", protect, admin, async (req, res) =&gt; {
  try {
    // Find the product by ID - 根據 ID 查找產品
    const product = await Product.findById(req.params.id);

    if (product) {
      // Remove the product from DB - 從資料庫移除產品
      await product.deleteOne();
      res.json({ message: "Product remove" });
    } else {
      res.status(404).json({ message: "Product not found" });
    }
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route GET /api/products - @路由、使用 GET 方法、API 的路徑
// @desc Get all products with optional query filters - @描述 獲取所有產品，並可選擇性地使用查詢過濾器
// @access Public - @訪問權限 公開
router.get("/", async (req, res) =&gt; {
  try {
    const {
      collection,
      size,
      color,
      gender,
      minPrice,
      maxPrice,
      sortBy,
      search,
      category,
      material,
      brand,
      limit,
    } = req.query;

    let query = {};

    // Filter logic - 過濾邏輯
    if (collection &amp;&amp; collection.toLocaleLowerCase() !== "all") {
      query.collections = collection;
    }

    if (category &amp;&amp; category.toLocaleLowerCase() !== "all") {
      query.category = category;
    }

    if (material) {
      query.material = { $in: material.split(",") };
    }

    if (brand) {
      query.brand = { $in: brand.split(",") };
    }

    if (size) {
      query.sizes = { $in: size.split(",") };
    }

    if (color) {
      query.colors = { $in: &#91;color] };
    }

    if (gender) {
      query.gender = gender;
    }

    if (minPrice || maxPrice) {
      query.price = {};
      if (minPrice) query.price.$gte = Number(minPrice);
      if (maxPrice) query.price.$lte = Number(maxPrice);
    }

    if (search) {
      query.$or = &#91;
        { name: { $regex: search, $options: "i" } },
        { description: { $regex: search, $options: "i" } },
      ];
    }

    // Sort Logic - 排序邏輯
    let sort = {};
    if (sortBy) {
      switch (sortBy) {
        case "priceAsc":
          sort = { price: 1 };
          break;
        case "priceDesc":
          sort = { price: -1 };
          break;
        case "popularity":
          sort = { rating: -1 };
          break;
        default:
          break;
      }
    }

    // Fetch products and apply sorting and limit - 獲取產品並應用排序和限制
    let products = await Product.find(query)
      .sort(sort)
      .limit(Number(limit) || 0);
    res.json(products);
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

module.exports = router;
</code></pre>



<h2 class="wp-block-heading">使用 Postman API 測試工具</h2>



<ul class="wp-block-list">
<li>Collections: Products – 集合: 產品</li>



<li>Add request – 新增請求<br>All Products、GET、http://localhost:9000/api/products/</li>



<li>測試分類篩選<br>http://localhost:9000/api/products/?category=Top Wear</li>



<li>測試分類、材質篩選<br>http://localhost:9000/api/products/?category=Top Wear&amp;material=Cotton</li>



<li>測試分類、材質、性別篩選<br>http://localhost:9000/api/products/?category=Top Wear&amp;material=Cotton&amp;gender=Women</li>



<li>測試分類、材質、性別、搜尋篩選<br>http://localhost:9000/api/products/?category=Top Wear&amp;material=Cotton&amp;gender=Women&amp;search=Casual</li>



<li>測試上升排序<br>http://localhost:9000/api/products/?sortBy=priceAsc</li>



<li>測試下降排序<br>http://localhost:9000/api/products/?sortBy=priceDesc</li>



<li>測試最大價格<br>http://localhost:9000/api/products/?maxPrice=30</li>



<li>測試最大價格、最小價格<br>http://localhost:9000/api/products/?maxPrice=50&amp;minPrice=30</li>
</ul>



<h2 class="wp-block-heading">Single Product (單一產品)</h2>



<pre class="wp-block-code"><code>// backend/routes/productRoutes.js
const express = require("express");
const Product = require("../models/Product");
const { protect, admin } = require("../middleware/authMiddleware");

const router = express.Router();

// @route POST /api/products - @路由、使用 POST 方法、API 的路徑
// @desc Create a new Product - @描述 建立新的產品
// @access Private/Admin - @訪問權限 私人/管理員
router.post("/", protect, admin, async (req, res) =&gt; {
  try {
    const {
      name,
      description,
      price,
      discountPrice,
      countInStock,
      category,
      brand,
      sizes,
      colors,
      collections,
      material,
      gender,
      images,
      isFeatured,
      isPublished,
      tags,
      dimensions,
      weight,
      sku,
    } = req.body;

    const product = new Product({
      name,
      description,
      price,
      discountPrice,
      countInStock,
      category,
      brand,
      sizes,
      colors,
      collections,
      material,
      gender,
      images,
      isFeatured,
      isPublished,
      tags,
      dimensions,
      weight,
      sku,
      user: req.user._id, // Reference to the admin user who created it
    });

    const createdProduct = await product.save();
    res.status(201).json(createdProduct);
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route PUT /api/products/:id - @路由、使用 PUT 方法、API 的路徑
// @desc Update an existing product ID - @描述 更新現有產品ID
// @access Private/Admin - @訪問權限 私人/管理員
router.put("/:id", protect, admin, async (req, res) =&gt; {
  try {
    const {
      name,
      description,
      price,
      discountPrice,
      countInStock,
      category,
      brand,
      sizes,
      colors,
      collections,
      material,
      gender,
      images,
      isFeatured,
      isPublished,
      tags,
      dimensions,
      weight,
      sku,
    } = req.body;

    // Find product by ID - 根據 ID 查找產品
    const product = await Product.findById(req.params.id);

    if (product) {
      // Update product fields - 更新產品欄位
      product.name = name || product.name;
      product.description = description || product.description;
      product.price = price || product.price;
      product.discountPrice = discountPrice || product.discountPrice;
      product.countInStock = countInStock || product.countInStock;
      product.category = category || product.category;
      product.brand = brand || product.brand;
      product.sizes = sizes || product.sizes;
      product.colors = colors || product.colors;
      product.collections = collections || product.collections;
      product.material = material || product.material;
      product.gender = gender || product.gender;
      product.images = images || product.images;
      product.isFeatured =
        isFeatured !== undefined ? isFeatured : product.isFeatured;
      product.isPublished =
        isPublished !== undefined ? isPublished : product.isPublished;
      product.tags = tags || product.tags;
      product.dimensions = dimensions || product.dimensions;
      product.weight = weight || product.weight;
      product.sku = sku || product.sku;

      // Save the updated product - 儲存更新的產品
      const updatedProduct = await product.save();
      res.json(updatedProduct);
    } else {
      res.status(404).json({
        message: "Product not found",
      });
    }
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route DELETE /api/products/:id - @路由、使用 DELETE 方法、API 的路徑
// @desc Delete a product by ID - @描述、根據 ID 刪除產品
// @access Private/Admin - @訪問權限、私人/管理員
router.delete("/:id", protect, admin, async (req, res) =&gt; {
  try {
    // Find the product by ID - 根據 ID 查找產品
    const product = await Product.findById(req.params.id);

    if (product) {
      // Remove the product from DB - 從資料庫移除產品
      await product.deleteOne();
      res.json({ message: "Product remove" });
    } else {
      res.status(404).json({ message: "Product not found" });
    }
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route GET /api/products - @路由、使用 GET 方法、API 的路徑
// @desc Get all products with optional query filters - @描述 獲取所有產品，並可選擇性地使用查詢過濾器
// @access Public - @訪問權限 公開
router.get("/", async (req, res) =&gt; {
  try {
    const {
      collection,
      size,
      color,
      gender,
      minPrice,
      maxPrice,
      sortBy,
      search,
      category,
      material,
      brand,
      limit,
    } = req.query;

    let query = {};

    // Filter logic - 過濾邏輯
    if (collection &amp;&amp; collection.toLocaleLowerCase() !== "all") {
      query.collections = collection;
    }

    if (category &amp;&amp; category.toLocaleLowerCase() !== "all") {
      query.category = category;
    }

    if (material) {
      query.material = { $in: material.split(",") };
    }

    if (brand) {
      query.brand = { $in: brand.split(",") };
    }

    if (size) {
      query.sizes = { $in: size.split(",") };
    }

    if (color) {
      query.colors = { $in: &#91;color] };
    }

    if (gender) {
      query.gender = gender;
    }

    if (minPrice || maxPrice) {
      query.price = {};
      if (minPrice) query.price.$gte = Number(minPrice);
      if (maxPrice) query.price.$lte = Number(maxPrice);
    }

    if (search) {
      query.$or = &#91;
        { name: { $regex: search, $options: "i" } },
        { description: { $regex: search, $options: "i" } },
      ];
    }

    // Sort Logic - 排序邏輯
    let sort = {};
    if (sortBy) {
      switch (sortBy) {
        case "priceAsc":
          sort = { price: 1 };
          break;
        case "priceDesc":
          sort = { price: -1 };
          break;
        case "popularity":
          sort = { rating: -1 };
          break;
        default:
          break;
      }
    }

    // Fetch products and apply sorting and limit - 獲取產品並應用排序和限制
    let products = await Product.find(query)
      .sort(sort)
      .limit(Number(limit) || 0);
    res.json(products);
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route GET /api/products/:id - @路由、使用 GET 方法、API 的路徑
// @desc Get a single product by ID - @描述 通過 ID 獲取單一產品
// @access Public - @訪問權限 公開
router.get("/:id", async (req, res) =&gt; {
  try {
    const product = await Product.findById(req.params.id);
    if (product) {
      res.json(product);
    } else {
      res.status(404).json({ message: "Product Not Found" });
    }
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

module.exports = router;
</code></pre>



<h2 class="wp-block-heading">使用 Postman API 測試工具</h2>



<ul class="wp-block-list">
<li>Collections: Products – 集合: 產品</li>



<li>Add request – 新增請求<br>Product Details、GET、http://localhost:9000/api/products/67d13557ef893a6a945de533</li>
</ul>



<h2 class="wp-block-heading">Similar Products (相似產品)</h2>



<pre class="wp-block-code"><code>// backend/routes/productRoutes.js
const express = require("express");
const Product = require("../models/Product");
const { protect, admin } = require("../middleware/authMiddleware");

const router = express.Router();

// @route POST /api/products - @路由、使用 POST 方法、API 的路徑
// @desc Create a new Product - @描述 建立新的產品
// @access Private/Admin - @訪問權限 私人/管理員
router.post("/", protect, admin, async (req, res) =&gt; {
  try {
    const {
      name,
      description,
      price,
      discountPrice,
      countInStock,
      category,
      brand,
      sizes,
      colors,
      collections,
      material,
      gender,
      images,
      isFeatured,
      isPublished,
      tags,
      dimensions,
      weight,
      sku,
    } = req.body;

    const product = new Product({
      name,
      description,
      price,
      discountPrice,
      countInStock,
      category,
      brand,
      sizes,
      colors,
      collections,
      material,
      gender,
      images,
      isFeatured,
      isPublished,
      tags,
      dimensions,
      weight,
      sku,
      user: req.user._id, // Reference to the admin user who created it
    });

    const createdProduct = await product.save();
    res.status(201).json(createdProduct);
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route PUT /api/products/:id - @路由、使用 PUT 方法、API 的路徑
// @desc Update an existing product ID - @描述 更新現有產品ID
// @access Private/Admin - @訪問權限 私人/管理員
router.put("/:id", protect, admin, async (req, res) =&gt; {
  try {
    const {
      name,
      description,
      price,
      discountPrice,
      countInStock,
      category,
      brand,
      sizes,
      colors,
      collections,
      material,
      gender,
      images,
      isFeatured,
      isPublished,
      tags,
      dimensions,
      weight,
      sku,
    } = req.body;

    // Find product by ID - 根據 ID 查找產品
    const product = await Product.findById(req.params.id);

    if (product) {
      // Update product fields - 更新產品欄位
      product.name = name || product.name;
      product.description = description || product.description;
      product.price = price || product.price;
      product.discountPrice = discountPrice || product.discountPrice;
      product.countInStock = countInStock || product.countInStock;
      product.category = category || product.category;
      product.brand = brand || product.brand;
      product.sizes = sizes || product.sizes;
      product.colors = colors || product.colors;
      product.collections = collections || product.collections;
      product.material = material || product.material;
      product.gender = gender || product.gender;
      product.images = images || product.images;
      product.isFeatured =
        isFeatured !== undefined ? isFeatured : product.isFeatured;
      product.isPublished =
        isPublished !== undefined ? isPublished : product.isPublished;
      product.tags = tags || product.tags;
      product.dimensions = dimensions || product.dimensions;
      product.weight = weight || product.weight;
      product.sku = sku || product.sku;

      // Save the updated product - 儲存更新的產品
      const updatedProduct = await product.save();
      res.json(updatedProduct);
    } else {
      res.status(404).json({
        message: "Product not found",
      });
    }
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route DELETE /api/products/:id - @路由、使用 DELETE 方法、API 的路徑
// @desc Delete a product by ID - @描述、根據 ID 刪除產品
// @access Private/Admin - @訪問權限、私人/管理員
router.delete("/:id", protect, admin, async (req, res) =&gt; {
  try {
    // Find the product by ID - 根據 ID 查找產品
    const product = await Product.findById(req.params.id);

    if (product) {
      // Remove the product from DB - 從資料庫移除產品
      await product.deleteOne();
      res.json({ message: "Product remove" });
    } else {
      res.status(404).json({ message: "Product not found" });
    }
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route GET /api/products - @路由、使用 GET 方法、API 的路徑
// @desc Get all products with optional query filters - @描述 獲取所有產品，並可選擇性地使用查詢過濾器
// @access Public - @訪問權限 公開
router.get("/", async (req, res) =&gt; {
  try {
    const {
      collection,
      size,
      color,
      gender,
      minPrice,
      maxPrice,
      sortBy,
      search,
      category,
      material,
      brand,
      limit,
    } = req.query;

    let query = {};

    // Filter logic - 過濾邏輯
    if (collection &amp;&amp; collection.toLocaleLowerCase() !== "all") {
      query.collections = collection;
    }

    if (category &amp;&amp; category.toLocaleLowerCase() !== "all") {
      query.category = category;
    }

    if (material) {
      query.material = { $in: material.split(",") };
    }

    if (brand) {
      query.brand = { $in: brand.split(",") };
    }

    if (size) {
      query.sizes = { $in: size.split(",") };
    }

    if (color) {
      query.colors = { $in: &#91;color] };
    }

    if (gender) {
      query.gender = gender;
    }

    if (minPrice || maxPrice) {
      query.price = {};
      if (minPrice) query.price.$gte = Number(minPrice);
      if (maxPrice) query.price.$lte = Number(maxPrice);
    }

    if (search) {
      query.$or = &#91;
        { name: { $regex: search, $options: "i" } },
        { description: { $regex: search, $options: "i" } },
      ];
    }

    // Sort Logic - 排序邏輯
    let sort = {};
    if (sortBy) {
      switch (sortBy) {
        case "priceAsc":
          sort = { price: 1 };
          break;
        case "priceDesc":
          sort = { price: -1 };
          break;
        case "popularity":
          sort = { rating: -1 };
          break;
        default:
          break;
      }
    }

    // Fetch products and apply sorting and limit - 獲取產品並應用排序和限制
    let products = await Product.find(query)
      .sort(sort)
      .limit(Number(limit) || 0);
    res.json(products);
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route GET /api/products/:id - @路由、使用 GET 方法、API 的路徑
// @desc Get a single product by ID - @描述 通過 ID 獲取單一產品
// @access Public - @訪問權限 公開
router.get("/:id", async (req, res) =&gt; {
  try {
    const product = await Product.findById(req.params.id);
    if (product) {
      res.json(product);
    } else {
      res.status(404).json({ message: "Product Not Found" });
    }
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route GET /api/products/similar/:id - @路由、使用 GET 方法、API 的路徑
// @desc Retrieve similar products based on the current product's gender and category - @描述 根據當前的產品的性別和類別檢索相似產品
// @access Public - @訪問權限 公開
router.get("/similar/:id", async (req, res) =&gt; {
  const { id } = req.params;
  // console.log(id); // 測試

  try {
    const product = await Product.findById(id);

    if (!product) {
      return res.status(404).json({ message: "Product Not Found" });
    }

    const similarProducts = await Product.find({
      _id: { $ne: id }, // Exclude the current product ID - 排除當前產品 ID
      gender: product.gender,
      category: product.category,
    }).limit(4);

    res.json(similarProducts);
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

module.exports = router;
</code></pre>



<h2 class="wp-block-heading">使用 Postman API 測試工具</h2>



<ul class="wp-block-list">
<li>Collections: Products – 集合: 產品</li>



<li>Add request – 新增請求<br>Similar Products、GET、http://localhost:9000/api/products/similar/:id</li>



<li>Params &gt; Path Variables &gt; Key、Value</li>
</ul>



<pre class="wp-block-code"><code>// Postman - Products/Similar Products
// Params &gt; Path Variables &gt; Key、Value
Key: id
Value: 67d13557ef893a6a945de533</code></pre>



<h2 class="wp-block-heading">Best Seller (暢銷產品)</h2>



<pre class="wp-block-code"><code>// backend/routes/productRoutes.js
const express = require("express");
const Product = require("../models/Product");
const { protect, admin } = require("../middleware/authMiddleware");

const router = express.Router();

// @route POST /api/products - @路由、使用 POST 方法、API 的路徑
// @desc Create a new Product - @描述 建立新的產品
// @access Private/Admin - @訪問權限 私人/管理員
router.post("/", protect, admin, async (req, res) =&gt; {
  try {
    const {
      name,
      description,
      price,
      discountPrice,
      countInStock,
      category,
      brand,
      sizes,
      colors,
      collections,
      material,
      gender,
      images,
      isFeatured,
      isPublished,
      tags,
      dimensions,
      weight,
      sku,
    } = req.body;

    const product = new Product({
      name,
      description,
      price,
      discountPrice,
      countInStock,
      category,
      brand,
      sizes,
      colors,
      collections,
      material,
      gender,
      images,
      isFeatured,
      isPublished,
      tags,
      dimensions,
      weight,
      sku,
      user: req.user._id, // Reference to the admin user who created it
    });

    const createdProduct = await product.save();
    res.status(201).json(createdProduct);
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route PUT /api/products/:id - @路由、使用 PUT 方法、API 的路徑
// @desc Update an existing product ID - @描述 更新現有產品ID
// @access Private/Admin - @訪問權限 私人/管理員
router.put("/:id", protect, admin, async (req, res) =&gt; {
  try {
    const {
      name,
      description,
      price,
      discountPrice,
      countInStock,
      category,
      brand,
      sizes,
      colors,
      collections,
      material,
      gender,
      images,
      isFeatured,
      isPublished,
      tags,
      dimensions,
      weight,
      sku,
    } = req.body;

    // Find product by ID - 根據 ID 查找產品
    const product = await Product.findById(req.params.id);

    if (product) {
      // Update product fields - 更新產品欄位
      product.name = name || product.name;
      product.description = description || product.description;
      product.price = price || product.price;
      product.discountPrice = discountPrice || product.discountPrice;
      product.countInStock = countInStock || product.countInStock;
      product.category = category || product.category;
      product.brand = brand || product.brand;
      product.sizes = sizes || product.sizes;
      product.colors = colors || product.colors;
      product.collections = collections || product.collections;
      product.material = material || product.material;
      product.gender = gender || product.gender;
      product.images = images || product.images;
      product.isFeatured =
        isFeatured !== undefined ? isFeatured : product.isFeatured;
      product.isPublished =
        isPublished !== undefined ? isPublished : product.isPublished;
      product.tags = tags || product.tags;
      product.dimensions = dimensions || product.dimensions;
      product.weight = weight || product.weight;
      product.sku = sku || product.sku;

      // Save the updated product - 儲存更新的產品
      const updatedProduct = await product.save();
      res.json(updatedProduct);
    } else {
      res.status(404).json({
        message: "Product not found",
      });
    }
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route DELETE /api/products/:id - @路由、使用 DELETE 方法、API 的路徑
// @desc Delete a product by ID - @描述、根據 ID 刪除產品
// @access Private/Admin - @訪問權限、私人/管理員
router.delete("/:id", protect, admin, async (req, res) =&gt; {
  try {
    // Find the product by ID - 根據 ID 查找產品
    const product = await Product.findById(req.params.id);

    if (product) {
      // Remove the product from DB - 從資料庫移除產品
      await product.deleteOne();
      res.json({ message: "Product remove" });
    } else {
      res.status(404).json({ message: "Product not found" });
    }
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route GET /api/products - @路由、使用 GET 方法、API 的路徑
// @desc Get all products with optional query filters - @描述 獲取所有產品，並可選擇性地使用查詢過濾器
// @access Public - @訪問權限 公開
router.get("/", async (req, res) =&gt; {
  try {
    const {
      collection,
      size,
      color,
      gender,
      minPrice,
      maxPrice,
      sortBy,
      search,
      category,
      material,
      brand,
      limit,
    } = req.query;

    let query = {};

    // Filter logic - 過濾邏輯
    if (collection &amp;&amp; collection.toLocaleLowerCase() !== "all") {
      query.collections = collection;
    }

    if (category &amp;&amp; category.toLocaleLowerCase() !== "all") {
      query.category = category;
    }

    if (material) {
      query.material = { $in: material.split(",") };
    }

    if (brand) {
      query.brand = { $in: brand.split(",") };
    }

    if (size) {
      query.sizes = { $in: size.split(",") };
    }

    if (color) {
      query.colors = { $in: &#91;color] };
    }

    if (gender) {
      query.gender = gender;
    }

    if (minPrice || maxPrice) {
      query.price = {};
      if (minPrice) query.price.$gte = Number(minPrice);
      if (maxPrice) query.price.$lte = Number(maxPrice);
    }

    if (search) {
      query.$or = &#91;
        { name: { $regex: search, $options: "i" } },
        { description: { $regex: search, $options: "i" } },
      ];
    }

    // Sort Logic - 排序邏輯
    let sort = {};
    if (sortBy) {
      switch (sortBy) {
        case "priceAsc":
          sort = { price: 1 };
          break;
        case "priceDesc":
          sort = { price: -1 };
          break;
        case "popularity":
          sort = { rating: -1 };
          break;
        default:
          break;
      }
    }

    // Fetch products and apply sorting and limit - 獲取產品並應用排序和限制
    let products = await Product.find(query)
      .sort(sort)
      .limit(Number(limit) || 0);
    res.json(products);
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route GET /api/products/best-seller - @路由、使用 GET 方法、API 的路徑
// @dec Retrieve the product with highest rating - 檢索評分最高的產品
// @access Public - @訪問權限 公開
// Best Seller 路由程式碼需要撰寫在 Single Prodcut 路由程式碼的上方
router.get("/best-seller", async (req, res) =&gt; {
  try {
    // res.send("this should work"); // 測試

    const bestSeller = await Product.findOne().sort({ rating: -1 });
    if (bestSeller) {
      res.json(bestSeller);
    } else {
      res.status(404).json({ message: "No best seller found" });
    }
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route GET /api/products/:id - @路由、使用 GET 方法、API 的路徑
// @desc Get a single product by ID - @描述 通過 ID 獲取單一產品
// @access Public - @訪問權限 公開
router.get("/:id", async (req, res) =&gt; {
  try {
    const product = await Product.findById(req.params.id);
    if (product) {
      res.json(product);
    } else {
      res.status(404).json({ message: "Product Not Found" });
    }
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route GET /api/products/similar/:id - @路由、使用 GET 方法、API 的路徑
// @desc Retrieve similar products based on the current product's gender and category - @描述 根據當前的產品的性別和類別檢索相似產品
// @access Public - @訪問權限 公開
router.get("/similar/:id", async (req, res) =&gt; {
  const { id } = req.params;
  // console.log(id); // 測試

  try {
    const product = await Product.findById(id);

    if (!product) {
      return res.status(404).json({ message: "Product Not Found" });
    }

    const similarProducts = await Product.find({
      _id: { $ne: id }, // Exclude the current product ID - 排除當前產品 ID
      gender: product.gender,
      category: product.category,
    }).limit(4);

    res.json(similarProducts);
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

module.exports = router;
</code></pre>



<ul class="wp-block-list">
<li>Best Seller 路由程式碼需要撰寫在 Single Prodcut 路由程式碼的上方</li>
</ul>



<h2 class="wp-block-heading">使用 Postman API 測試工具</h2>



<ul class="wp-block-list">
<li>Collections: Products – 集合: 產品</li>



<li>Add request – 新增請求<br>Best Seller、GET、http://localhost:9000/api/products/best-seller</li>
</ul>



<h2 class="wp-block-heading">New Arrivals (新到商品)</h2>



<pre class="wp-block-code"><code>// backend/routes/productRoutes.js
const express = require("express");
const Product = require("../models/Product");
const { protect, admin } = require("../middleware/authMiddleware");

const router = express.Router();

// @route POST /api/products - @路由、使用 POST 方法、API 的路徑
// @desc Create a new Product - @描述 建立新的產品
// @access Private/Admin - @訪問權限 私人/管理員
router.post("/", protect, admin, async (req, res) =&gt; {
  try {
    const {
      name,
      description,
      price,
      discountPrice,
      countInStock,
      category,
      brand,
      sizes,
      colors,
      collections,
      material,
      gender,
      images,
      isFeatured,
      isPublished,
      tags,
      dimensions,
      weight,
      sku,
    } = req.body;

    const product = new Product({
      name,
      description,
      price,
      discountPrice,
      countInStock,
      category,
      brand,
      sizes,
      colors,
      collections,
      material,
      gender,
      images,
      isFeatured,
      isPublished,
      tags,
      dimensions,
      weight,
      sku,
      user: req.user._id, // Reference to the admin user who created it
    });

    const createdProduct = await product.save();
    res.status(201).json(createdProduct);
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route PUT /api/products/:id - @路由、使用 PUT 方法、API 的路徑
// @desc Update an existing product ID - @描述 更新現有產品ID
// @access Private/Admin - @訪問權限 私人/管理員
router.put("/:id", protect, admin, async (req, res) =&gt; {
  try {
    const {
      name,
      description,
      price,
      discountPrice,
      countInStock,
      category,
      brand,
      sizes,
      colors,
      collections,
      material,
      gender,
      images,
      isFeatured,
      isPublished,
      tags,
      dimensions,
      weight,
      sku,
    } = req.body;

    // Find product by ID - 根據 ID 查找產品
    const product = await Product.findById(req.params.id);

    if (product) {
      // Update product fields - 更新產品欄位
      product.name = name || product.name;
      product.description = description || product.description;
      product.price = price || product.price;
      product.discountPrice = discountPrice || product.discountPrice;
      product.countInStock = countInStock || product.countInStock;
      product.category = category || product.category;
      product.brand = brand || product.brand;
      product.sizes = sizes || product.sizes;
      product.colors = colors || product.colors;
      product.collections = collections || product.collections;
      product.material = material || product.material;
      product.gender = gender || product.gender;
      product.images = images || product.images;
      product.isFeatured =
        isFeatured !== undefined ? isFeatured : product.isFeatured;
      product.isPublished =
        isPublished !== undefined ? isPublished : product.isPublished;
      product.tags = tags || product.tags;
      product.dimensions = dimensions || product.dimensions;
      product.weight = weight || product.weight;
      product.sku = sku || product.sku;

      // Save the updated product - 儲存更新的產品
      const updatedProduct = await product.save();
      res.json(updatedProduct);
    } else {
      res.status(404).json({
        message: "Product not found",
      });
    }
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route DELETE /api/products/:id - @路由、使用 DELETE 方法、API 的路徑
// @desc Delete a product by ID - @描述、根據 ID 刪除產品
// @access Private/Admin - @訪問權限、私人/管理員
router.delete("/:id", protect, admin, async (req, res) =&gt; {
  try {
    // Find the product by ID - 根據 ID 查找產品
    const product = await Product.findById(req.params.id);

    if (product) {
      // Remove the product from DB - 從資料庫移除產品
      await product.deleteOne();
      res.json({ message: "Product remove" });
    } else {
      res.status(404).json({ message: "Product not found" });
    }
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route GET /api/products - @路由、使用 GET 方法、API 的路徑
// @desc Get all products with optional query filters - @描述 獲取所有產品，並可選擇性地使用查詢過濾器
// @access Public - @訪問權限 公開
router.get("/", async (req, res) =&gt; {
  try {
    const {
      collection,
      size,
      color,
      gender,
      minPrice,
      maxPrice,
      sortBy,
      search,
      category,
      material,
      brand,
      limit,
    } = req.query;

    let query = {};

    // Filter logic - 過濾邏輯
    if (collection &amp;&amp; collection.toLocaleLowerCase() !== "all") {
      query.collections = collection;
    }

    if (category &amp;&amp; category.toLocaleLowerCase() !== "all") {
      query.category = category;
    }

    if (material) {
      query.material = { $in: material.split(",") };
    }

    if (brand) {
      query.brand = { $in: brand.split(",") };
    }

    if (size) {
      query.sizes = { $in: size.split(",") };
    }

    if (color) {
      query.colors = { $in: &#91;color] };
    }

    if (gender) {
      query.gender = gender;
    }

    if (minPrice || maxPrice) {
      query.price = {};
      if (minPrice) query.price.$gte = Number(minPrice);
      if (maxPrice) query.price.$lte = Number(maxPrice);
    }

    if (search) {
      query.$or = &#91;
        { name: { $regex: search, $options: "i" } },
        { description: { $regex: search, $options: "i" } },
      ];
    }

    // Sort Logic - 排序邏輯
    let sort = {};
    if (sortBy) {
      switch (sortBy) {
        case "priceAsc":
          sort = { price: 1 };
          break;
        case "priceDesc":
          sort = { price: -1 };
          break;
        case "popularity":
          sort = { rating: -1 };
          break;
        default:
          break;
      }
    }

    // Fetch products and apply sorting and limit - 獲取產品並應用排序和限制
    let products = await Product.find(query)
      .sort(sort)
      .limit(Number(limit) || 0);
    res.json(products);
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route GET /api/products/best-seller - @路由、使用 GET 方法、API 的路徑
// @dec Retrieve the product with highest rating - 檢索評分最高的產品
// @access Public - @訪問權限 公開
// Best Seller 路由程式碼需要撰寫在 Single Prodcut 路由程式碼的上方
router.get("/best-seller", async (req, res) =&gt; {
  try {
    // res.send("this should work"); // 測試

    const bestSeller = await Product.findOne().sort({ rating: -1 });
    if (bestSeller) {
      res.json(bestSeller);
    } else {
      res.status(404).json({ message: "No best seller found" });
    }
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route GET /api/products/new-arrivals - @路由、使用 GET 方法、API 的路徑
// @desc Retrieve latest 8 products - Creation date - @描述 根據創建日期檢索最新的 8 款產品
// @access Public - @訪問權限 公開
// New Arrivals 路由程式碼需要撰寫在 Single Prodcut 路由程式碼的上方
router.get("/new-arrivals", async (req, res) =&gt; {
  try {
    // Fetch latest 8 products - 獲取最新的8款產品
    const newArrivals = await Product.find().sort({ createdAt: -1 }).limit(8);
    res.json(newArrivals);
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route GET /api/products/:id - @路由、使用 GET 方法、API 的路徑
// @desc Get a single product by ID - @描述 通過 ID 獲取單一產品
// @access Public - @訪問權限 公開
router.get("/:id", async (req, res) =&gt; {
  try {
    const product = await Product.findById(req.params.id);
    if (product) {
      res.json(product);
    } else {
      res.status(404).json({ message: "Product Not Found" });
    }
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

// @route GET /api/products/similar/:id - @路由、使用 GET 方法、API 的路徑
// @desc Retrieve similar products based on the current product's gender and category - @描述 根據當前的產品的性別和類別檢索相似產品
// @access Public - @訪問權限 公開
router.get("/similar/:id", async (req, res) =&gt; {
  const { id } = req.params;
  // console.log(id); // 測試

  try {
    const product = await Product.findById(id);

    if (!product) {
      return res.status(404).json({ message: "Product Not Found" });
    }

    const similarProducts = await Product.find({
      _id: { $ne: id }, // Exclude the current product ID - 排除當前產品 ID
      gender: product.gender,
      category: product.category,
    }).limit(4);

    res.json(similarProducts);
  } catch (error) {
    console.error(error);
    res.status(500).send("Server Error");
  }
});

module.exports = router;
</code></pre>



<h2 class="wp-block-heading">使用 Postman API 測試工具</h2>



<ul class="wp-block-list">
<li>Collections: Products – 集合: 產品</li>



<li>Add request – 新增請求<br>New Arrivals、GET、http://localhost:9000/api/products/new-arrivals</li>
</ul>



<h2 class="wp-block-heading">製作購物車功能</h2>



<h3 class="wp-block-heading">Cart (購物車)</h3>



<ul class="wp-block-list">
<li>Create</li>



<li>Read</li>



<li>Update</li>



<li>Delete</li>



<li>Merge</li>
</ul>



<h2 class="wp-block-heading">說明購物車流程</h2>



<ul class="wp-block-list">
<li>Guest User → Creates Cart</li>



<li>Creates Cart → Logs In (Login Event) →MERGE→ Converts to User Cart</li>
</ul>



<h2 class="wp-block-heading">Cart Schema (購物車模式)</h2>



<figure class="wp-block-table"><table class="has-fixed-layout"><tbody>
<tr>
<td>Field (欄位)</td>
<td>Type (類型)</td>
<td>Reference (參考)</td>
<td>Required (必填)</td>
<td>Default (預設)</td>
<td>Description (描述)</td>
</tr>
<tr>
<td>user</td>
<td>ObjectId</td>
<td>User</td>
<td>No</td>
<td>–</td>
<td>Reference to the logged-in user owning the cart.</td>
</tr>
<tr>
<td>guestId</td>
<td>String</td>
<td>–</td>
<td>No</td>
<td>–</td>
<td>Unique identifier for a guest user’s cart.</td>
</tr>
<tr>
<td>products</td>
<td>Array of CartItemSchema</td>
<td>–</td>
<td>Yes</td>
<td>–</td>
<td>List of products in the cart.</td>
</tr>
<tr>
<td>totalPrice</td>
<td>Number</td>
<td>–</td>
<td>Yes</td>
<td>0</td>
<td>Total price of all items in the cart.</td>
</tr>
<tr>
<td>timestamps</td>
<td>Object</td>
<td>–</td>
<td>Auto-Managed</td>
<td>createdAt,<br>updatedAt</td>
<td>Automatically managed by Mongoose.</td>
</tr>
</tbody></table></figure>



<h2 class="wp-block-heading">CartItem Schema (Nested in products) (購物車項目模式 (巢狀於產品中))</h2>



<figure class="wp-block-table"><table class="has-fixed-layout"><tbody>
<tr>
<td>Field (欄位)</td>
<td>Type (類型)</td>
<td>Reference (參考)</td>
<td>Required (必填)</td>
<td>Default (預設)</td>
<td>Description (描述)</td>
</tr>
<tr>
<td>productId</td>
<td>ObjectId</td>
<td>Product</td>
<td>Yes</td>
<td>–</td>
<td>Reference to the product added to the cart.</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>–</td>
<td>No</td>
<td>–</td>
<td>Name of the product.</td>
</tr>
<tr>
<td>image</td>
<td>String</td>
<td>–</td>
<td>No</td>
<td>–</td>
<td>URL of the product image.</td>
</tr>
<tr>
<td>price</td>
<td>String</td>
<td>–</td>
<td>No</td>
<td>–</td>
<td>Price of the product.</td>
</tr>
<tr>
<td>size</td>
<td>String</td>
<td>–</td>
<td>No</td>
<td>–</td>
<td>Size of the product (e.g., M, L).</td>
</tr>
<tr>
<td>color</td>
<td>String</td>
<td>–</td>
<td>No</td>
<td>–</td>
<td>Color of the product (e.g., Red, Blue).</td>
</tr>
<tr>
<td>quantity</td>
<td>Number</td>
<td>–</td>
<td>No</td>
<td>1</td>
<td>Quantity of the product in the cart.</td>
</tr>
</tbody></table></figure>



<h2 class="wp-block-heading">Create Cart (建立購物車)</h2>



<pre class="wp-block-code"><code>// backend/models/Cart.js
const mongoose = require("mongoose");

const cartItemSchema = new mongoose.Schema(
  {
    productId: {
      type: mongoose.Schema.Types.ObjectId,
      ref: "Product",
      required: true,
    },
    name: String,
    image: String,
    price: String,
    size: String,
    color: String,
    quantity: {
      type: Number,
      default: 1,
    },
  },
  { _id: false }
);

const cartSchema = new mongoose.Schema(
  {
    user: {
      type: mongoose.Schema.Types.ObjectId,
      ref: "User",
    },
    guestId: {
      type: String,
    },
    products: &#91;cartItemSchema],
    totalPrice: {
      type: Number,
      required: true,
      default: 0,
    },
  },
  { timestamps: true }
);

module.exports = mongoose.model("Cart", cartSchema);
</code></pre>



<pre class="wp-block-code"><code>// backend/seeder.js
const mongoose = require("mongoose");
const dotenv = require("dotenv");
const Product = require("./models/Product");
const User = require("./models/User");
const Cart = require("./models/Cart");

const products = require("./data/products");

dotenv.config();

// Conntect to mongoDB - 連接到 MongoDB
mongoose.connect(process.env.MONGO_URI);

// Function to seed data - 數據初始化函數

const seedData = async () =&gt; {
  try {
    // Clear existing data - 清除現有數據
    await Product.deleteMany();
    await User.deleteMany();
    await Cart.deleteMany();

    // Create a default admin User 建立默認管理員用戶
    const createdUser = await User.create({
      name: "Admin User",
      email: "admin@example.com",
      password: "123456",
      role: "admin",
    });

    // Assign the default user ID to each product - 將默認用戶 ID 分配給每個產品
    const userID = createdUser._id;

    const sampleProducts = products.map((product) =&gt; {
      return { ...product, user: userID };
    });

    // Insert the products into the database - 將產品插入資料庫
    await Product.insertMany(sampleProducts);

    console.log("Product data seeded successfully!");
    process.exit();
  } catch (error) {
    console.error("Error seeding the data:", error);
    process.exit(1);
  }
};

seedData();
</code></pre>



<pre class="wp-block-code"><code>// backend/routes/cartRoute.js
const express = require("express");
const Cart = require("../models/Cart");
const Product = require("../models/Product");
const { protect } = require("../middleware/authMiddleware");

const router = express.Router();

// Helper function to get a cart by user Id or guest ID - 根據用戶 ID 或訪客 ID 獲取購物車的輔助函數
const getCart = async (userId, guestId) =&gt; {
  if (userId) {
    return await Cart.findOne({ user: userId });
  } else if (guestId) {
    return await Cart.findOne({ guestId });
  }
  return null;
};

// @route POST /api/cart - @路由、使用 POST 方法、API 的路徑
// @desc Add a product to the cart for a guest or logged in user - @描述 將產品增加到訪客或已登入用戶的購物車中
// @access Public - @訪問權限 公開
router.post("/", async (req, res) =&gt; {
  const { productId, quantity, size, color, guestId, userId } = req.body;
  try {
    const product = await Product.findById(productId);
    if (!product) return res.status(404).json({ message: "Product not found" });

    // Determine if the user is logged in or guest - 判斷用戶是已登入還是訪客
    let cart = await getCart(userId, guestId);

    // If the cart exists,update it - 如果購物車存在，則更新它
    if (cart) {
      const productIndex = cart.products.findIndex(
        (p) =&gt;
          p.productId.toString() === productId &amp;&amp;
          p.size === size &amp;&amp;
          p.color === color
      );

      if (productIndex &gt; -1) {
        // If the product already exists, update the quantity
        cart.products&#91;productIndex].quantity += quantity;
      } else {
        // add new product - 增加新產品
        cart.products.push({
          productId,
          name: product.name,
          image: product.images&#91;0].url,
          price: product.price,
          size,
          color,
          quantity,
        });
      }

      // Recalculate the total price - 重新計算總價格
      cart.totalPrice = cart.products.reduce(
        (acc, item) =&gt; acc + item.price * item.quantity,
        0
      );
      await cart.save();
      return res.status(200).json(cart);
    } else {
      // Create a new cart for the guest or user - 為訪客或用戶創建一個新購物車
      const newCart = await Cart.create({
        user: userId ? userId : undefined,
        guestId: guestId ? guestId : "guest_" + new Date().getTime(),
        products: &#91;
          {
            productId,
            name: product.name,
            image: product.images&#91;0].url,
            price: product.price,
            size,
            color,
            quantity,
          },
        ],
        totalPrice: product.price * quantity,
      });
      return res.status(201).json(newCart);
    }
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: "Server Error" });
  }
});

module.exports = router;
</code></pre>



<h2 class="wp-block-heading">使用 Postman API 測試工具</h2>



<ul class="wp-block-list">
<li>Create new collection – 建立新的集合<br>Cart</li>



<li>Add a request – 新增請求<br>Create、POST、http://localhost:9000/api/cart</li>



<li>Body &gt; raw</li>



<li>測試相同的 guestId</li>



<li>測試 userId</li>
</ul>



<pre class="wp-block-code"><code>// Postman - Cart/Create
// Body &gt; raw
{
    "productId": "67d13557ef893a6a945de536",
    "size": "M",
    "color": "Red",
    "quantity": 1
}
</code></pre>



<pre class="wp-block-code"><code>// backend/server.js
const express = require("express");
const cors = require("cors");
const dotenv = require("dotenv");
const connectDB = require("./config/db");
const userRoutes = require("./routes/userRoutes");
const productRoutes = require("./routes/productRoutes");
const cartRoutes = require("./routes/cartRoutes");

const app = express();
app.use(express.json());
app.use(cors());

dotenv.config();

// console.log(process.env.PORT);
const PORT = process.env.PORT || 3000;

// Connect to MongoDB - 連接到 MongoDB
connectDB();

app.get("/", (req, res) =&gt; {
  res.send("WELCOME TO RABBIT API!");
});

// API Routes - API 路由
app.use("/api/users", userRoutes);
app.use("/api/products", productRoutes);
app.use("/api/cart", cartRoutes);

app.listen(PORT, () =&gt; {
  console.log(`Server is running on http://localhost:${PORT}`);
});
</code></pre>



<pre class="wp-block-code"><code>// Postman - Cart/Create
// Body &gt; raw
// 測試相同的 guestId
{
    "guestId": "guest_1741855828784",
    "productId": "67d13557ef893a6a945de536",
    "size": "M",
    "color": "Red",
    "quantity": 2
}
</code></pre>



<pre class="wp-block-code"><code>// Postman - Cart/Create
// Body &gt; raw
// 測試 userId
{
    "userId": "67d13557ef893a6a945de525",
    "productId": "67d13557ef893a6a945de536",
    "size": "M",
    "color": "Red",
    "quantity": 2
}
</code></pre>



<h2 class="wp-block-heading">查看 MongoDB Atlas 資料庫</h2>



<ul class="wp-block-list">
<li>查看購物車數量是否有增加</li>



<li>查看 user 屬性是否有新增</li>
</ul>



<h2 class="wp-block-heading">Update Cart (更新購物車)</h2>



<pre class="wp-block-code"><code>// backend/routes/cartRoutes.js
const express = require("express");
const Cart = require("../models/Cart");
const Product = require("../models/Product");
const { protect } = require("../middleware/authMiddleware");

const router = express.Router();

// Helper function to get a cart by user Id or guest ID - 根據用戶 ID 或訪客 ID 獲取購物車的輔助函數
const getCart = async (userId, guestId) =&gt; {
  if (userId) {
    return await Cart.findOne({ user: userId });
  } else if (guestId) {
    return await Cart.findOne({ guestId });
  }
  return null;
};

// @route POST /api/cart - @路由、使用 POST 方法、API 的路徑
// @desc Add a product to the cart for a guest or logged in user - @描述 將產品增加到訪客或已登入用戶的購物車中
// @access Public - @訪問權限 公開
router.post("/", async (req, res) =&gt; {
  const { productId, quantity, size, color, guestId, userId } = req.body;
  try {
    const product = await Product.findById(productId);
    if (!product) return res.status(404).json({ message: "Product not found" });

    // Determine if the user is logged in or guest - 判斷用戶是已登入還是訪客
    let cart = await getCart(userId, guestId);

    // If the cart exists,update it - 如果購物車存在，則更新它
    if (cart) {
      const productIndex = cart.products.findIndex(
        (p) =&gt;
          p.productId.toString() === productId &amp;&amp;
          p.size === size &amp;&amp;
          p.color === color
      );

      if (productIndex &gt; -1) {
        // If the product already exists, update the quantity
        cart.products&#91;productIndex].quantity += quantity;
      } else {
        // add new product - 增加新產品
        cart.products.push({
          productId,
          name: product.name,
          image: product.images&#91;0].url,
          price: product.price,
          size,
          color,
          quantity,
        });
      }

      // Recalculate the total price - 重新計算總價格
      cart.totalPrice = cart.products.reduce(
        (acc, item) =&gt; acc + item.price * item.quantity,
        0
      );
      await cart.save();
      return res.status(200).json(cart);
    } else {
      // Create a new cart for the guest or user - 為訪客或用戶創建一個新購物車
      const newCart = await Cart.create({
        user: userId ? userId : undefined,
        guestId: guestId ? guestId : "guest_" + new Date().getTime(),
        products: &#91;
          {
            productId,
            name: product.name,
            image: product.images&#91;0].url,
            price: product.price,
            size,
            color,
            quantity,
          },
        ],
        totalPrice: product.price * quantity,
      });
      return res.status(201).json(newCart);
    }
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: "Server Error" });
  }
});

// @route PUT /api/cart - @路由、使用 PUT 方法、API 的路徑
// @desc Update product quantity in the cart for a guest or logged-in user - 為訪客或已登入用戶更新購物車中的產品數量
// @access Public - @訪問權限 公開
router.put("/", async (req, res) =&gt; {
  const { productId, quantity, size, color, guestId, userId } = req.body;

  try {
    let cart = await getCart(userId, guestId);
    if (!cart) return res.status(404).json({ message: "Cart not found" });

    const productIndex = cart.products.findIndex(
      (p) =&gt;
        p.productId.toString() === productId &amp;&amp;
        p.size === size &amp;&amp;
        p.color === color
    );

    if (productIndex &gt; -1) {
      // update quantity - 更新數量
      if (quantity &gt; 0) {
        cart.products&#91;productIndex].quantity = quantity;
      } else {
        cart.products.splice(productIndex, 1); // Remove product if quantity is 0 - 庫存數量為0時刪除產品
      }

      cart.totalPrice = cart.products.reduce(
        (acc, item) =&gt; acc + item.price * item.quantity,
        0
      );
      await cart.save();
      return res.status(200).json(cart);
    } else {
      return res.status(404).json({ message: "Product not found in cart" });
    }
  } catch (error) {
    console.error(error);
    return res.status(500).json({ message: "Server Error" });
  }
});

module.exports = router;
</code></pre>



<h2 class="wp-block-heading">使用 Postman API 測試工具</h2>



<ul class="wp-block-list">
<li>Collections: Cart – 集合: 購物車</li>



<li>Add request – 新增請求<br>Update、PUT、http://localhost:9000/api/cart</li>



<li>Body &gt; raw</li>



<li>Headers &gt; Key、Value</li>
</ul>



<pre class="wp-block-code"><code>// Postman - Cart/Update
// Body &gt; raw
{
    "userId": "67d13557ef893a6a945de525",
    "productId": "67d13557ef893a6a945de536",
    "size": "M",
    "color": "Red",
    "quantity": 6
}
</code></pre>



<pre class="wp-block-code"><code>// Postman - Cart/Update
// Headers
Key: Authorization
Value: Bearer 你的Token
</code></pre>



<h2 class="wp-block-heading">查看 MongoDB Atlas 資料庫</h2>



<ul class="wp-block-list">
<li>查看購物車數量是否有更新</li>



<li>測試數量更改為0時是否會從購物車移除</li>
</ul>



<h2 class="wp-block-heading">Delete Cart (移除購物車)</h2>



<pre class="wp-block-code"><code>// backend/routes/cartRoutes.js
const express = require("express");
const Cart = require("../models/Cart");
const Product = require("../models/Product");
const { protect } = require("../middleware/authMiddleware");

const router = express.Router();

// Helper function to get a cart by user Id or guest ID - 根據用戶 ID 或訪客 ID 獲取購物車的輔助函數
const getCart = async (userId, guestId) =&gt; {
  if (userId) {
    return await Cart.findOne({ user: userId });
  } else if (guestId) {
    return await Cart.findOne({ guestId });
  }
  return null;
};

// @route POST /api/cart - @路由、使用 POST 方法、API 的路徑
// @desc Add a product to the cart for a guest or logged in user - @描述 將產品增加到訪客或已登入用戶的購物車中
// @access Public - @訪問權限 公開
router.post("/", async (req, res) =&gt; {
  const { productId, quantity, size, color, guestId, userId } = req.body;
  try {
    const product = await Product.findById(productId);
    if (!product) return res.status(404).json({ message: "Product not found" });

    // Determine if the user is logged in or guest - 判斷用戶是已登入還是訪客
    let cart = await getCart(userId, guestId);

    // If the cart exists,update it - 如果購物車存在，則更新它
    if (cart) {
      const productIndex = cart.products.findIndex(
        (p) =&gt;
          p.productId.toString() === productId &amp;&amp;
          p.size === size &amp;&amp;
          p.color === color
      );

      if (productIndex &gt; -1) {
        // If the product already exists, update the quantity
        cart.products&#91;productIndex].quantity += quantity;
      } else {
        // add new product - 增加新產品
        cart.products.push({
          productId,
          name: product.name,
          image: product.images&#91;0].url,
          price: product.price,
          size,
          color,
          quantity,
        });
      }

      // Recalculate the total price - 重新計算總價格
      cart.totalPrice = cart.products.reduce(
        (acc, item) =&gt; acc + item.price * item.quantity,
        0
      );
      await cart.save();
      return res.status(200).json(cart);
    } else {
      // Create a new cart for the guest or user - 為訪客或用戶創建一個新購物車
      const newCart = await Cart.create({
        user: userId ? userId : undefined,
        guestId: guestId ? guestId : "guest_" + new Date().getTime(),
        products: &#91;
          {
            productId,
            name: product.name,
            image: product.images&#91;0].url,
            price: product.price,
            size,
            color,
            quantity,
          },
        ],
        totalPrice: product.price * quantity,
      });
      return res.status(201).json(newCart);
    }
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: "Server Error" });
  }
});

// @route PUT /api/cart - @路由、使用 PUT 方法、API 的路徑
// @desc Update product quantity in the cart for a guest or logged-in user - 為訪客或已登入用戶更新購物車中的產品數量
// @access Public - @訪問權限 公開
router.put("/", async (req, res) =&gt; {
  const { productId, quantity, size, color, guestId, userId } = req.body;

  try {
    let cart = await getCart(userId, guestId);
    if (!cart) return res.status(404).json({ message: "Cart not found" });

    const productIndex = cart.products.findIndex(
      (p) =&gt;
        p.productId.toString() === productId &amp;&amp;
        p.size === size &amp;&amp;
        p.color === color
    );

    if (productIndex &gt; -1) {
      // update quantity - 更新數量
      if (quantity &gt; 0) {
        cart.products&#91;productIndex].quantity = quantity;
      } else {
        cart.products.splice(productIndex, 1); // Remove product if quantity is 0 - 庫存數量為0時刪除產品
      }

      cart.totalPrice = cart.products.reduce(
        (acc, item) =&gt; acc + item.price * item.quantity,
        0
      );
      await cart.save();
      return res.status(200).json(cart);
    } else {
      return res.status(404).json({ message: "Product not found in cart" });
    }
  } catch (error) {
    console.error(error);
    return res.status(500).json({ message: "Server Error" });
  }
});

// @route DELETE /api/cart - @路由、使用 DELETE 方法、API 的路徑
// @desc Remove a product from the cart - @描述 從購物車中刪除商品
// @access Public - @訪問權限 公開
router.delete("/", async (req, res) =&gt; {
  const { productId, size, color, guestId, userId } = req.body;
  try {
    let cart = await getCart(userId, guestId);

    if (!cart) return res.status(404).json({ message: "Cart not found" });

    const productIndex = cart.products.findIndex(
      (p) =&gt;
        p.productId.toString() === productId &amp;&amp;
        p.size === size &amp;&amp;
        p.color === color
    );

    if (productIndex &gt; -1) {
      cart.products.splice(productIndex, 1);

      cart.totalPrice = cart.products.reduce(
        (acc, item) =&gt; acc + item.price * item.quantity,
        0
      );
      await cart.save();
      return res.status(200).json(cart);
    } else {
      return res.status(404).json({ message: "Product not found in cart" });
    }
  } catch (error) {
    console.error(error);
    return res.status(500).json({ message: "Server Error" });
  }
});

module.exports = router;
</code></pre>



<h2 class="wp-block-heading">使用 Postman API 測試工具</h2>



<ul class="wp-block-list">
<li>Collections: Cart – 集合: 購物車</li>



<li>Add request – 新增請求<br>Delete、DELETE、http://localhost:9000/api/cart</li>



<li>Headers &gt; Key、Value</li>



<li>Body &gt; raw</li>
</ul>



<pre class="wp-block-code"><code>// Postman - Cart/Delete
// Headers
Key: Authorization
Value: Bearer 你的Token
</code></pre>



<pre class="wp-block-code"><code>// Postman - Cart/Delete
// Body &gt; raw
{
    "userId": "67d13557ef893a6a945de525",
    "productId": "67d13557ef893a6a945de536",
    "size": "M",
    "color": "Red"
}
</code></pre>



<h2 class="wp-block-heading">查看 MongoDB Atlas 資料庫</h2>



<ul class="wp-block-list">
<li>查看購物車數量是否有刪除</li>
</ul>



<h2 class="wp-block-heading">Read Cart (查看購物車)</h2>



<pre class="wp-block-code"><code>// backend/routes/cartRoutes.js
const express = require("express");
const Cart = require("../models/Cart");
const Product = require("../models/Product");
const { protect } = require("../middleware/authMiddleware");

const router = express.Router();

// Helper function to get a cart by user Id or guest ID - 根據用戶 ID 或訪客 ID 獲取購物車的輔助函數
const getCart = async (userId, guestId) =&gt; {
  if (userId) {
    return await Cart.findOne({ user: userId });
  } else if (guestId) {
    return await Cart.findOne({ guestId });
  }
  return null;
};

// @route POST /api/cart - @路由、使用 POST 方法、API 的路徑
// @desc Add a product to the cart for a guest or logged in user - @描述 將產品增加到訪客或已登入用戶的購物車中
// @access Public - @訪問權限 公開
router.post("/", async (req, res) =&gt; {
  const { productId, quantity, size, color, guestId, userId } = req.body;
  try {
    const product = await Product.findById(productId);
    if (!product) return res.status(404).json({ message: "Product not found" });

    // Determine if the user is logged in or guest - 判斷用戶是已登入還是訪客
    let cart = await getCart(userId, guestId);

    // If the cart exists,update it - 如果購物車存在，則更新它
    if (cart) {
      const productIndex = cart.products.findIndex(
        (p) =&gt;
          p.productId.toString() === productId &amp;&amp;
          p.size === size &amp;&amp;
          p.color === color
      );

      if (productIndex &gt; -1) {
        // If the product already exists, update the quantity
        cart.products&#91;productIndex].quantity += quantity;
      } else {
        // add new product - 增加新產品
        cart.products.push({
          productId,
          name: product.name,
          image: product.images&#91;0].url,
          price: product.price,
          size,
          color,
          quantity,
        });
      }

      // Recalculate the total price - 重新計算總價格
      cart.totalPrice = cart.products.reduce(
        (acc, item) =&gt; acc + item.price * item.quantity,
        0
      );
      await cart.save();
      return res.status(200).json(cart);
    } else {
      // Create a new cart for the guest or user - 為訪客或用戶創建一個新購物車
      const newCart = await Cart.create({
        user: userId ? userId : undefined,
        guestId: guestId ? guestId : "guest_" + new Date().getTime(),
        products: &#91;
          {
            productId,
            name: product.name,
            image: product.images&#91;0].url,
            price: product.price,
            size,
            color,
            quantity,
          },
        ],
        totalPrice: product.price * quantity,
      });
      return res.status(201).json(newCart);
    }
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: "Server Error" });
  }
});

// @route PUT /api/cart - @路由、使用 PUT 方法、API 的路徑
// @desc Update product quantity in the cart for a guest or logged-in user - 為訪客或已登入用戶更新購物車中的產品數量
// @access Public - @訪問權限 公開
router.put("/", async (req, res) =&gt; {
  const { productId, quantity, size, color, guestId, userId } = req.body;

  try {
    let cart = await getCart(userId, guestId);
    if (!cart) return res.status(404).json({ message: "Cart not found" });

    const productIndex = cart.products.findIndex(
      (p) =&gt;
        p.productId.toString() === productId &amp;&amp;
        p.size === size &amp;&amp;
        p.color === color
    );

    if (productIndex &gt; -1) {
      // update quantity - 更新數量
      if (quantity &gt; 0) {
        cart.products&#91;productIndex].quantity = quantity;
      } else {
        cart.products.splice(productIndex, 1); // Remove product if quantity is 0 - 庫存數量為0時刪除產品
      }

      cart.totalPrice = cart.products.reduce(
        (acc, item) =&gt; acc + item.price * item.quantity,
        0
      );
      await cart.save();
      return res.status(200).json(cart);
    } else {
      return res.status(404).json({ message: "Product not found in cart" });
    }
  } catch (error) {
    console.error(error);
    return res.status(500).json({ message: "Server Error" });
  }
});

// @route DELETE /api/cart - @路由、使用 DELETE 方法、API 的路徑
// @desc Remove a product from the cart - @描述 從購物車中刪除商品
// @access Public - @訪問權限 公開
router.delete("/", async (req, res) =&gt; {
  const { productId, size, color, guestId, userId } = req.body;
  try {
    let cart = await getCart(userId, guestId);

    if (!cart) return res.status(404).json({ message: "Cart not found" });

    const productIndex = cart.products.findIndex(
      (p) =&gt;
        p.productId.toString() === productId &amp;&amp;
        p.size === size &amp;&amp;
        p.color === color
    );

    if (productIndex &gt; -1) {
      cart.products.splice(productIndex, 1);

      cart.totalPrice = cart.products.reduce(
        (acc, item) =&gt; acc + item.price * item.quantity,
        0
      );
      await cart.save();
      return res.status(200).json(cart);
    } else {
      return res.status(404).json({ message: "Product not found in cart" });
    }
  } catch (error) {
    console.error(error);
    return res.status(500).json({ message: "Server Error" });
  }
});

// @route GET /api/cart - @路由、使用 GET 方法、API 的路徑
// @desc Get logged-in user's or guest user's cart - @描述 獲取已登入用戶或訪客用戶的購物車
// @access Public - @訪問權限 公開
router.get("/", async (req, res) =&gt; {
  const { userId, guestId } = req.query;

  try {
    const cart = await getCart(userId, guestId);
    if (cart) {
      res.json(cart);
    } else {
      res.status(404).json({ message: "Cart not found" });
    }
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: "Server Error" });
  }
});

module.exports = router;
</code></pre>



<h2 class="wp-block-heading">使用 Postman API 測試工具</h2>



<ul class="wp-block-list">
<li>Collections: Cart – 集合: 購物車</li>



<li>Add request – 新增請求<br>Cart Details、GET、http://localhost:9000/api/cart</li>



<li>Headers &gt; Key、Value</li>



<li>Params &gt; Key、Value</li>
</ul>



<pre class="wp-block-code"><code>// Postman - Cart/Cart Details
// Headers
Key: Authorization
Value: Bearer 你的Token
</code></pre>



<pre class="wp-block-code"><code>// Postman - Cart/Cart Details
// Params
Key: userId
Value: 你的 userId
</code></pre>



<h2 class="wp-block-heading">Merge Cart (合併購物車)</h2>



<pre class="wp-block-code"><code>// backend/routes/cartRoutes.js
const express = require("express");
const Cart = require("../models/Cart");
const Product = require("../models/Product");
const { protect } = require("../middleware/authMiddleware");

const router = express.Router();

// Helper function to get a cart by user Id or guest ID - 根據用戶 ID 或訪客 ID 獲取購物車的輔助函數
const getCart = async (userId, guestId) =&gt; {
  if (userId) {
    return await Cart.findOne({ user: userId });
  } else if (guestId) {
    return await Cart.findOne({ guestId });
  }
  return null;
};

// @route POST /api/cart - @路由、使用 POST 方法、API 的路徑
// @desc Add a product to the cart for a guest or logged in user - @描述 將產品增加到訪客或已登入用戶的購物車中
// @access Public - @訪問權限 公開
router.post("/", async (req, res) =&gt; {
  const { productId, quantity, size, color, guestId, userId } = req.body;
  try {
    const product = await Product.findById(productId);
    if (!product) return res.status(404).json({ message: "Product not found" });

    // Determine if the user is logged in or guest - 判斷用戶是已登入還是訪客
    let cart = await getCart(userId, guestId);

    // If the cart exists,update it - 如果購物車存在，則更新它
    if (cart) {
      const productIndex = cart.products.findIndex(
        (p) =&gt;
          p.productId.toString() === productId &amp;&amp;
          p.size === size &amp;&amp;
          p.color === color
      );

      if (productIndex &gt; -1) {
        // If the product already exists, update the quantity
        cart.products&#91;productIndex].quantity += quantity;
      } else {
        // add new product - 增加新產品
        cart.products.push({
          productId,
          name: product.name,
          image: product.images&#91;0].url,
          price: product.price,
          size,
          color,
          quantity,
        });
      }

      // Recalculate the total price - 重新計算總價格
      cart.totalPrice = cart.products.reduce(
        (acc, item) =&gt; acc + item.price * item.quantity,
        0
      );
      await cart.save();
      return res.status(200).json(cart);
    } else {
      // Create a new cart for the guest or user - 為訪客或用戶創建一個新購物車
      const newCart = await Cart.create({
        user: userId ? userId : undefined,
        guestId: guestId ? guestId : "guest_" + new Date().getTime(),
        products: &#91;
          {
            productId,
            name: product.name,
            image: product.images&#91;0].url,
            price: product.price,
            size,
            color,
            quantity,
          },
        ],
        totalPrice: product.price * quantity,
      });
      return res.status(201).json(newCart);
    }
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: "Server Error" });
  }
});

// @route PUT /api/cart - @路由、使用 PUT 方法、API 的路徑
// @desc Update product quantity in the cart for a guest or logged-in user - 為訪客或已登入用戶更新購物車中的產品數量
// @access Public - @訪問權限 公開
router.put("/", async (req, res) =&gt; {
  const { productId, quantity, size, color, guestId, userId } = req.body;

  try {
    let cart = await getCart(userId, guestId);
    if (!cart) return res.status(404).json({ message: "Cart not found" });

    const productIndex = cart.products.findIndex(
      (p) =&gt;
        p.productId.toString() === productId &amp;&amp;
        p.size === size &amp;&amp;
        p.color === color
    );

    if (productIndex &gt; -1) {
      // update quantity - 更新數量
      if (quantity &gt; 0) {
        cart.products&#91;productIndex].quantity = quantity;
      } else {
        cart.products.splice(productIndex, 1); // Remove product if quantity is 0 - 庫存數量為0時刪除產品
      }

      cart.totalPrice = cart.products.reduce(
        (acc, item) =&gt; acc + item.price * item.quantity,
        0
      );
      await cart.save();
      return res.status(200).json(cart);
    } else {
      return res.status(404).json({ message: "Product not found in cart" });
    }
  } catch (error) {
    console.error(error);
    return res.status(500).json({ message: "Server Error" });
  }
});

// @route DELETE /api/cart - @路由、使用 DELETE 方法、API 的路徑
// @desc Remove a product from the cart - @描述 從購物車中刪除商品
// @access Public - @訪問權限 公開
router.delete("/", async (req, res) =&gt; {
  const { productId, size, color, guestId, userId } = req.body;
  try {
    let cart = await getCart(userId, guestId);

    if (!cart) return res.status(404).json({ message: "Cart not found" });

    const productIndex = cart.products.findIndex(
      (p) =&gt;
        p.productId.toString() === productId &amp;&amp;
        p.size === size &amp;&amp;
        p.color === color
    );

    if (productIndex &gt; -1) {
      cart.products.splice(productIndex, 1);

      cart.totalPrice = cart.products.reduce(
        (acc, item) =&gt; acc + item.price * item.quantity,
        0
      );
      await cart.save();
      return res.status(200).json(cart);
    } else {
      return res.status(404).json({ message: "Product not found in cart" });
    }
  } catch (error) {
    console.error(error);
    return res.status(500).json({ message: "Server Error" });
  }
});

// @route GET /api/cart - @路由、使用 GET 方法、API 的路徑
// @desc Get logged-in user's or guest user's cart - @描述 獲取已登入用戶或訪客用戶的購物車
// @access Public - @訪問權限 公開
router.get("/", async (req, res) =&gt; {
  const { userId, guestId } = req.query;

  try {
    const cart = await getCart(userId, guestId);
    if (cart) {
      res.json(cart);
    } else {
      res.status(404).json({ message: "Cart not found" });
    }
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: "Server Error" });
  }
});

// @route POST /api/cart/merge - @路由、使用 POST 方法、API 的路徑
// @desc Merge guest cart into user cart on login - @描述 登入時將訪客購物車合併到用戶購物車
// @access Private - @訪問權限 私人
router.post("/merge", protect, async (req, res) =&gt; {
  const { guestId } = req.body;

  try {
    // Find the guest cart and user cart - 查找訪客購物車和用戶購物車
    const guestCart = await Cart.findOne({ guestId });
    const userCart = await Cart.findOne({ user: req.user._id });

    if (guestCart) {
      if (guestCart.products.length === 0) {
        return res.status(400).json({ message: "Guest cart is empty" });
      }

      if (userCart) {
        // Merge guest cart into user cart - 將訪客購物車合併到用戶購物車
        guestCart.products.forEach((guestItem) =&gt; {
          const productIndex = userCart.products.findIndex(
            (item) =&gt;
              item.productId.toString() === guestItem.productId.toString() &amp;&amp;
              item.size === guestItem.size &amp;&amp;
              item.color === guestItem.color
          );

          if (productIndex &gt; -1) {
            // If the items exists in the user cart, update the quantity - 如果商品在用戶購物車中存在，則更新數量
            userCart.products&#91;productIndex].quantity += guestItem.quantity;
          } else {
            // Otherwise, add the guest item to the cart - 否則，將訪客商品增加到購物車
            userCart.products.push(guestItem);
          }
        });

        userCart.totalPrice = userCart.products.reduce(
          (acc, item) =&gt; acc + item.price * item.quantity,
          0
        );
        await userCart.save();

        // Remove the guest cart after merging - 合併後刪除訪客購物車
        try {
          await Cart.findOneAndDelete({ guestId });
        } catch (error) {
          console.error("Error deleting guest cart:", error);
        }
        res.status(200).json(guestCart);
      } else {
        // If the user has no existing cart, assign the guest cart to the user - 如果用戶沒有現有的購物車，則將訪客購物車分配給用戶
        guestCart.user = req.user._id;
        guestCart.guestId = undefined;
        await guestCart.save();

        res.status(200).json(guestCart);
      }
    } else {
      if (userCart) {
        // Guest cart has already been merged, return user cart - 訪客購物車已經合併，返回用戶購物車
        return res.status(200).json(userCart);
      }
      res.status(404).json({ message: "Guest cart not found" });
    }
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: "Server Error" });
  }
});

module.exports = router;
</code></pre>



<h2 class="wp-block-heading">初始化資料庫資料</h2>



<ul class="wp-block-list">
<li>npm run seed</li>
</ul>



<h2 class="wp-block-heading">查看 MongoDB Atlas 資料庫</h2>



<ul class="wp-block-list">
<li>查看資料是否有初始化資料庫</li>
</ul>



<h2 class="wp-block-heading">使用 Postman API 測試工具</h2>



<ul class="wp-block-list">
<li>Collections: Products – 集合: 產品</li>



<li>取得產品 _id<br>All Products、GET、http://localhost:9000/api/products/</li>



<li>Collections: Cart – 集合: 購物車</li>



<li>建立購物車<br>Create、POST、http://localhost:9000/api/cart</li>



<li>Body &gt; raw</li>



<li>Add request – 新增請求<br>Merge、POST、http://localhost:9000/api/cart/merge</li>



<li>Body &gt; raw</li>



<li>Headers &gt; Key、Value</li>
</ul>



<pre class="wp-block-code"><code>// Postman - Cart/Create
// Body &gt; raw
{
    "productId": "67d5186884e2f1407fcf0388",
    "size": "S",
    "color": "Red",
    "quantity": 1
}
</code></pre>



<pre class="wp-block-code"><code>// Postman - Cart/Merge
// Body &gt; raw
{
    "guestId": "guest_1742019216937"
}
</code></pre>



<pre class="wp-block-code"><code>// Postman - Cart/Merge
// Headers
Key: Authorization
Value: Bearer 你的Token
</code></pre>



<h2 class="wp-block-heading">製作結帳功能</h2>



<h3 class="wp-block-heading">Checkout (結帳)</h3>



<ul class="wp-block-list">
<li>Create</li>



<li>Pay</li>



<li>Finalize</li>
</ul>



<h3 class="wp-block-heading">CheckoutItem Schema (結帳項目模式)</h3>



<figure class="wp-block-table"><table class="has-fixed-layout"><tbody>
<tr>
<td>Field (欄位)</td>
<td>Type (類型)</td>
<td>Required (必填)</td>
<td>Description (描述)</td>
</tr>
<tr>
<td>productId</td>
<td>ObjectId (ref: Product)</td>
<td>Yes</td>
<td>The ID of the product</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>Yes</td>
<td>The name of the product.</td>
</tr>
<tr>
<td>image</td>
<td>String</td>
<td>Yes</td>
<td>The URL of the product image.</td>
</tr>
<tr>
<td>price</td>
<td>Number</td>
<td>Yes</td>
<td>The price of the product.</td>
</tr>
<tr>
<td>size</td>
<td>String</td>
<td>No</td>
<td>The size of the product (e.g., apparel).</td>
</tr>
<tr>
<td>color</td>
<td>String</td>
<td>No</td>
<td>The color of the product.</td>
</tr>
<tr>
<td>quantity</td>
<td>Number</td>
<td>Yes</td>
<td>The quantity of the product in the cart.</td>
</tr>
</tbody></table></figure>



<h3 class="wp-block-heading">Checkout Schema (結帳模式)</h3>



<figure class="wp-block-table"><table class="has-fixed-layout"><tbody>
<tr>
<td>Field (欄位)</td>
<td>Type (類型)</td>
<td>Required (必填)</td>
<td>Description (描述)</td>
</tr>
<tr>
<td>user</td>
<td>ObjectId (ref: User)</td>
<td>Yes</td>
<td>The ID of the user associated with the checkout.</td>
</tr>
<tr>
<td>checkoutItems</td>
<td>Array of CheckoutItems</td>
<td>Yes</td>
<td>The list of items included in the checkout.</td>
</tr>
<tr>
<td>shippingAddress</td>
<td>Object</td>
<td>Yes</td>
<td>Contains shipping details (address, city, etc.).</td>
</tr>
<tr>
<td>address</td>
<td>String</td>
<td>Yes</td>
<td>Shipping address of the user.</td>
</tr>
<tr>
<td>city</td>
<td>String</td>
<td>Yes</td>
<td>City for shipping.</td>
</tr>
<tr>
<td>postalCode</td>
<td>String</td>
<td>Yes</td>
<td>Postal code for shipping.</td>
</tr>
<tr>
<td>country</td>
<td>String</td>
<td>Yes</td>
<td>Country for shipping.</td>
</tr>
<tr>
<td>paymentMethod</td>
<td>String</td>
<td>Yes</td>
<td>Payment method used (e.g., Paypal).</td>
</tr>
<tr>
<td>totalPrice</td>
<td>Number</td>
<td>Yes</td>
<td>Total price of all items in the checkout.</td>
</tr>
<tr>
<td>isPaid</td>
<td>Boolean</td>
<td>No</td>
<td>Indicates whether the checkout is paid.</td>
</tr>
<tr>
<td>paidAt</td>
<td>Date</td>
<td>No</td>
<td>Timestamp when the payment was made.</td>
</tr>
<tr>
<td>paymentStatus</td>
<td>String</td>
<td>No</td>
<td>Status of the payment (pending, paid, etc.).</td>
</tr>
<tr>
<td>paymentDetails</td>
<td>Mixed</td>
<td>No</td>
<td>Stores details about the payment (e.g., transaction ID).</td>
</tr>
<tr>
<td>isFinalized</td>
<td>Boolean</td>
<td>No</td>
<td>Indicates if the checkout has been converted to an order.</td>
</tr>
<tr>
<td>finalizedAt</td>
<td>Date</td>
<td>No</td>
<td>Timestamp when the checkout was finalized.</td>
</tr>
<tr>
<td>timestamps</td>
<td>Date</td>
<td>Auto</td>
<td>Mongoose will auto-create createdAt and updatedAt.</td>
</tr>
</tbody></table></figure>



<h3 class="wp-block-heading">OrderItem Schema (訂單項目模式)</h3>



<figure class="wp-block-table"><table class="has-fixed-layout"><tbody>
<tr>
<td>Field (欄位)</td>
<td>Type (類型)</td>
<td>Required (必填)</td>
<td>Description (描述)</td>
</tr>
<tr>
<td>productId</td>
<td>ObjectId (ref: Product)</td>
<td>Yes</td>
<td>The ID of the product.</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>Yes</td>
<td>The name of the product.</td>
</tr>
<tr>
<td>image</td>
<td>String</td>
<td>Yes</td>
<td>The URL of the product image.</td>
</tr>
<tr>
<td>price</td>
<td>Number</td>
<td>Yes</td>
<td>The price of the product.</td>
</tr>
<tr>
<td>size</td>
<td>String</td>
<td>No</td>
<td>Size of the product (e.g., apparel).</td>
</tr>
<tr>
<td>color</td>
<td>String</td>
<td>No</td>
<td>Color of the product.</td>
</tr>
<tr>
<td>quantity</td>
<td>Number</td>
<td>Yes</td>
<td>The quantity of the product in the order.</td>
</tr>
</tbody></table></figure>



<h3 class="wp-block-heading">Order Schema (訂單模式)</h3>



<figure class="wp-block-table"><table class="has-fixed-layout"><tbody>
<tr>
<td>Field (欄位)</td>
<td>Type (類型)</td>
<td>Required (必填)</td>
<td>Description (描述)</td>
</tr>
<tr>
<td>user</td>
<td>ObjectId (ref: User)</td>
<td>Yes</td>
<td>The ID of the user who placed the order.</td>
</tr>
<tr>
<td>orderItems</td>
<td>Array of OrderItems</td>
<td>Yes</td>
<td>The list of items included in the order.</td>
</tr>
<tr>
<td>shippingAddress</td>
<td>Object</td>
<td>Yes</td>
<td>Shipping details including address, ciy, etc.</td>
</tr>
<tr>
<td>address</td>
<td>String</td>
<td>Yes</td>
<td>The full shipping address.</td>
</tr>
<tr>
<td>city</td>
<td>String</td>
<td>Yes</td>
<td>The ciy for shipping.</td>
</tr>
<tr>
<td>postalCode</td>
<td>String</td>
<td>Yes</td>
<td>The postal code for shipping.</td>
</tr>
<tr>
<td>country</td>
<td>String</td>
<td>Yes</td>
<td>The country for shipping.</td>
</tr>
<tr>
<td>paymentMethod</td>
<td>String</td>
<td>Yes</td>
<td>Payment method used (e.g., Credit Card, PayPal).</td>
</tr>
<tr>
<td>totalPrice</td>
<td>Number</td>
<td>Yes</td>
<td>Total price of all items in the order.</td>
</tr>
<tr>
<td>isPaid</td>
<td>Boolean</td>
<td>No</td>
<td>Indicates whether the order has been paid.</td>
</tr>
<tr>
<td>paidAt</td>
<td>Date</td>
<td>No</td>
<td>Timestamp when the payment was made.</td>
</tr>
<tr>
<td>isDelivered</td>
<td>Boolean</td>
<td>No</td>
<td>Indicates whether the order has been delivered.</td>
</tr>
<tr>
<td>deliveredAt</td>
<td>Date</td>
<td>No</td>
<td>Timestamp when the order was delivered.</td>
</tr>
<tr>
<td>paymentStatus</td>
<td>String</td>
<td>No</td>
<td>Payment status (pending, paid, etc.).</td>
</tr>
<tr>
<td>status</td>
<td>String</td>
<td>No</td>
<td>Order status (Processing, Shipped, Delivered, Cancelled).</td>
</tr>
<tr>
<td>timestamps</td>
<td>Date</td>
<td>Auto</td>
<td>Auto-created fields for createdAt and updatedAt.</td>
</tr>
</tbody></table></figure>



<pre class="wp-block-code"><code>// backend/models/Checkout.js
// 少了 quantity
const mongoose = require("mongoose");

const checkoutItemSchema = new mongoose.Schema(
  {
    productId: {
      type: mongoose.Schema.Types.ObjectId,
      ref: "Product",
      required: true,
    },
    name: {
      type: String,
      required: true,
    },
    image: {
      type: String,
      requied: true,
    },
    price: {
      type: Number,
      requied: true,
    },
  },
  { _id: false }
);

const checkoutSchema = new mongoose.Schema(
  {
    user: {
      type: mongoose.Schema.Types.ObjectId,
      ref: "User",
      requied: true,
    },
    checkoutItems: &#91;checkoutItemSchema],
    shippingAddress: {
      address: { type: String, required: true },
      city: { type: String, required: true },
      postalCode: { type: String, required: true },
      country: { type: String, required: true },
    },
    paymentMethod: {
      type: String,
      required: true,
    },
    totalPrice: {
      type: Number,
      required: true,
    },
    isPaid: {
      type: Boolean,
      default: false,
    },
    paidAt: {
      type: Date,
    },
    paymentStatus: {
      type: String,
      default: "pending",
    },
    paymentDetails: {
      type: mongoose.Schema.Types.Mixed, // store payment-related details(transaction ID, paypal response) - 存儲與支付相關的詳細資訊(如交易 ID 和 PayPal 回應)
    },
    isFinalized: {
      type: Boolean,
      default: false,
    },
    finalizedAt: {
      type: Date,
    },
  },
  { timestamps: true }
);

module.exports = mongoose.model("Checkout", checkoutSchema);
</code></pre>



<pre class="wp-block-code"><code>// backend/models/Order.js
const mongoose = require("mongoose");

const orderItemSchema = new mongoose.Schema(
  {
    productId: {
      type: mongoose.Schema.Types.ObjectId,
      ref: "Product",
      required: true,
    },
    name: {
      type: String,
      required: true,
    },
    image: {
      type: String,
      required: true,
    },
    price: {
      type: Number,
      required: true,
    },
    size: String,
    color: String,
    quantity: {
      type: Number,
      required: true,
    },
  },
  { _id: false }
);

const orderSchema = new mongoose.Schema(
  {
    user: {
      type: mongoose.Schema.Types.ObjectId,
      ref: "User",
      required: true,
    },
    orderItems: &#91;orderItemSchema],
    shippingAddress: {
      address: { type: String, required: true },
      city: { type: String, required: true },
      postalCode: { type: String, required: true },
      country: { type: String, required: true },
    },
    paymentMethod: {
      type: String,
      required: true,
    },
    totalPrice: {
      type: Number,
      required: true,
    },
    isPaid: {
      type: Boolean,
      default: false,
    },
    paidAt: {
      type: Date,
    },
    isDelivered: {
      type: Boolean,
      default: false,
    },
    deliveredAt: {
      type: Date,
    },
    paymentStatus: {
      type: String,
      default: "pending",
    },
    status: {
      type: String,
      enum: &#91;"Processing", "Shipped", "Delivered", "Cancelled"],
      default: "Processing",
    },
  },
  { timestamps: true }
);

module.exports = mongoose.model("Order", orderSchema);
</code></pre>



<pre class="wp-block-code"><code>// backend/routes/checkoutRoutes.js
// 創建最終訂單有錯誤
const express = require("express");
const Checkout = require("../models/Checkout");
const Cart = require("../models/Cart");
const Product = require("../models/Product");
const Order = require("../models/Order");
const { protect } = require("../middleware/authMiddleware");

const router = express.Router();

// @route POST /api/checkout - @路由、使用 POST 方法、API 的路徑
// @desc Create a new checkout session - @描述 創建新的結帳會話
// @access Private - @訪問權限 私人
router.post("/", protect, async (req, res) =&gt; {
  const { checkoutItems, shippingAddress, paymentMethod, totalPrice } =
    req.body;

  if (!checkoutItems || checkoutItems.length === 0) {
    return res.status(400).json({ message: "No items in checkout" });
  }

  try {
    // Create a new checkout session - 創建新的結帳會話
    const newCheckout = await Checkout.create({
      user: req.user._id,
      checkoutItems: checkoutItems,
      shippingAddress,
      paymentMethod,
      totalPrice,
      paymentStatus: "Pending",
      isPaid: false,
    });
    console.log(`Checkout created for user: ${req.user._id}`);
    res.status(201).json(newCheckout);
  } catch (error) {
    console.error("Error creating checkout session:", error);
    res.status(500).json({ message: "Server Error" });
  }
});

// @route PUT /api/checkout/:id/pay - @路由、使用 PUT 方法、API 的路徑
// @desc Update checkout to mark as paid after successful payment - @描述 要在成功付款後更新結帳狀態為已付款
// @access Private
router.put("/:id/pay", protect, async (req, res) =&gt; {
  const { paymentStatus, paymentDetails } = req.body;

  try {
    const checkout = await Checkout.findById(req.params.id);

    if (!checkout) {
      return res.status(404).json({ message: "Checkout not found" });
    }

    if (paymentStatus === "paid") {
      checkout.isPaid = true;
      checkout.paymentStatus = paymentStatus;
      checkout.paymentDetails = paymentDetails;
      checkout.paidAt = Date.now();
      await checkout.save();

      res.status(200).json(checkout);
    } else {
      res.status(400).json({ message: "Invalid Payment Status" });
    }
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: "Server Error" });
  }
});

// @route POST /api/checkout/:id/finalize - @路由、使用 POST 方法、API 的路徑
// @desc Finalize checkout and convert to an order after payment confirmation - @描述 將結帳完成並在付款確認後轉換為訂單
// @access Private - @訪問權限 私人
router.post("/:id/finalize", protect, async (req, res) =&gt; {
  try {
    const checkout = await Checkout.findById(req.params.id);

    if (!checkout) {
      return res.status(404).json({ message: "Checkout not found" });
    }

    if (checkout.isPaid &amp;&amp; !checkout.isFinalized) {
      // Create final order based on the checkout details - 根據結帳詳情創建最終訂單
      const finalOrder = await Order.create({
        user: checkout.user,
        orderItems: checkout.orderItems,
        shippingAddress: checkout.shippingAddress,
        paymentMethod: checkout.paymentMethod,
        totalPrice: checkout.totalPrice,
        isPaid: true,
        paidAt: checkout.paidAt,
        isDelivered: false,
        paymentStatus: "paid",
        paymentDetails: checkout.paymentDetails,
      });

      // Mark the checkout as finalized - 將結帳標記為已完成
      checkout.isFinalized = true;
      checkout.finalizedAt = Date.now();
      await checkout.save();
      // Delete the cart associated with the user - 刪除與用戶相關的購物車
      await Cart.findOneAndDelete({ user: checkout.user });
      res.status(201).json(finalOrder);
    } else if (checkout.isFinalized) {
      res.status(400).json({ message: "Checkout already finalized" });
    } else {
      res.status(400).json({ message: "Checkout is not paid" });
    }
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: "Server Error" });
  }
});

module.exports = router;
</code></pre>



<pre class="wp-block-code"><code>// backend/server.js
const express = require("express");
const cors = require("cors");
const dotenv = require("dotenv");
const connectDB = require("./config/db");
const userRoutes = require("./routes/userRoutes");
const productRoutes = require("./routes/productRoutes");
const cartRoutes = require("./routes/cartRoutes");
const checkoutRoutes = require("./routes/checkoutRoutes");

const app = express();
app.use(express.json());
app.use(cors());

dotenv.config();

// console.log(process.env.PORT);
const PORT = process.env.PORT || 3000;

// Connect to MongoDB - 連接到 MongoDB
connectDB();

app.get("/", (req, res) =&gt; {
  res.send("WELCOME TO RABBIT API!");
});

// API Routes - API 路由
app.use("/api/users", userRoutes);
app.use("/api/products", productRoutes);
app.use("/api/cart", cartRoutes);
app.use("/api/checkout", checkoutRoutes);

app.listen(PORT, () =&gt; {
  console.log(`Server is running on http://localhost:${PORT}`);
});
</code></pre>



<h2 class="wp-block-heading">使用 Postman API 測試工具</h2>



<ul class="wp-block-list">
<li>Create new collection – 建立新的集合<br>Checkout</li>



<li>Add a request – 新增請求<br>Create、POST、http://localhost:9000/api/checkout</li>



<li>Headers > Key、Value</li>



<li>Body > raw</li>



<li>Add request – 新增請求<br>Pay、PUT、http://localhost:9000/api/checkout/:id/pay</li>



<li>Params > Path Variables > Key、Value</li>



<li>Headers > Key、Value</li>



<li>Body > raw</li>



<li>Duplicate – 複製 Pay 請求<br>Finalize、POST、http://localhost:9000/api/checkout/:id/finalize</li>



<li>Body > raw<br>清空內容</li>
</ul>



<pre class="wp-block-code"><code>// Postman - Checkout/Create
// Headers
Key: Authorization
Value: Bearer 你的Token</code></pre>



<pre class="wp-block-code"><code>// Postman - Checkout/Create
// Body &gt; raw
{
    "checkoutItems": &#91;
        {
            "productId": "67d5186884e2f1407fcf0388",
            "name": "Classic T-shirt",
            "image": "https://picsum.photos/seed/denim1/500/500",
            "price": 19
        }
    ],
    "shippingAddress": {
        "address": "123 main street",
        "city": "New York",
        "postalCode": "10001",
        "country": "USA"
    },
    "paymentMethod": "PayPal",
    "totalPrice": 19
}
</code></pre>



<pre class="wp-block-code"><code>// Postman - Checkout/Pay
// Params &gt; Path Variables &gt; Key、Value
Key: id
Value: 67d782e2320689ef987bfad1
</code></pre>



<pre class="wp-block-code"><code>// Postman - Checkout/Pay
// Headers
Key: Authorization
Value: Bearer 你的Token
</code></pre>



<pre class="wp-block-code"><code>// Postman - Checkout/Pay
// Body &gt; raw
{
    "paymentStatus": "paid",
    "paymentDetails": {
        "transactionId": "txn_123456789",
        "paymentGateway": "PayPal",
        "amount": 19,
        "currency": "USD"
    }
}
</code></pre>



<pre class="wp-block-code"><code>// Postman - Checkout/Finalize
// Body &gt; raw - 清空內容
</code></pre>



<h2 class="wp-block-heading">查看 MongoDB Atlas</h2>



<ul class="wp-block-list">
<li>Browse collections (瀏覽集合) > checkouts</li>



<li>Browse collections > orders<br>發現 orders > orderItems 有錯誤<br>路由 checkoutRoutes.js 除錯</li>



<li>測試 isFinalized 結帳完成功能<br>出現錯誤、開始除錯</li>
</ul>



<pre class="wp-block-code"><code>// backend/routes/checkoutRoutes.js
const express = require("express");
const Checkout = require("../models/Checkout");
const Cart = require("../models/Cart");
const Product = require("../models/Product");
const Order = require("../models/Order");
const { protect } = require("../middleware/authMiddleware");

const router = express.Router();

// @route POST /api/checkout - @路由、使用 POST 方法、API 的路徑
// @desc Create a new checkout session - @描述 創建新的結帳會話
// @access Private - @訪問權限 私人
router.post("/", protect, async (req, res) =&gt; {
  const { checkoutItems, shippingAddress, paymentMethod, totalPrice } =
    req.body;

  if (!checkoutItems || checkoutItems.length === 0) {
    return res.status(400).json({ message: "No items in checkout" });
  }

  try {
    // Create a new checkout session - 創建新的結帳會話
    const newCheckout = await Checkout.create({
      user: req.user._id,
      checkoutItems: checkoutItems,
      shippingAddress,
      paymentMethod,
      totalPrice,
      paymentStatus: "Pending",
      isPaid: false,
    });
    console.log(`Checkout created for user: ${req.user._id}`);
    res.status(201).json(newCheckout);
  } catch (error) {
    console.error("Error creating checkout session:", error);
    res.status(500).json({ message: "Server Error" });
  }
});

// @route PUT /api/checkout/:id/pay - @路由、使用 PUT 方法、API 的路徑
// @desc Update checkout to mark as paid after successful payment - @描述 要在成功付款後更新結帳狀態為已付款
// @access Private
router.put("/:id/pay", protect, async (req, res) =&gt; {
  const { paymentStatus, paymentDetails } = req.body;

  try {
    const checkout = await Checkout.findById(req.params.id);

    if (!checkout) {
      return res.status(404).json({ message: "Checkout not found" });
    }

    if (paymentStatus === "paid") {
      checkout.isPaid = true;
      checkout.paymentStatus = paymentStatus;
      checkout.paymentDetails = paymentDetails;
      checkout.paidAt = Date.now();
      await checkout.save();

      res.status(200).json(checkout);
    } else {
      res.status(400).json({ message: "Invalid Payment Status" });
    }
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: "Server Error" });
  }
});

// @route POST /api/checkout/:id/finalize - @路由、使用 POST 方法、API 的路徑
// @desc Finalize checkout and convert to an order after payment confirmation - @描述 將結帳完成並在付款確認後轉換為訂單
// @access Private - @訪問權限 私人
router.post("/:id/finalize", protect, async (req, res) =&gt; {
  try {
    const checkout = await Checkout.findById(req.params.id);

    if (!checkout) {
      return res.status(404).json({ message: "Checkout not found" });
    }

    if (checkout.isPaid &amp;&amp; !checkout.isFinalized) {
      // Create final order based on the checkout details - 根據結帳詳情創建最終訂單
      const finalOrder = await Order.create({
        user: checkout.user,
        orderItems: checkout.checkoutItems,
        shippingAddress: checkout.shippingAddress,
        paymentMethod: checkout.paymentMethod,
        totalPrice: checkout.totalPrice,
        isPaid: true,
        paidAt: checkout.paidAt,
        isDelivered: false,
        paymentStatus: "paid",
        paymentDetails: checkout.paymentDetails,
      });

      // Mark the checkout as finalized - 將結帳標記為已完成
      checkout.isFinalized = true;
      checkout.finalizedAt = Date.now();
      await checkout.save();
      // Delete the cart associated with the user - 刪除與用戶相關的購物車
      await Cart.findOneAndDelete({ user: checkout.user });
      res.status(201).json(finalOrder);
    } else if (checkout.isFinalized) {
      res.status(400).json({ message: "Checkout already finalized" });
    } else {
      res.status(400).json({ message: "Checkout is not paid" });
    }
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: "Server Error" });
  }
});

module.exports = router;
</code></pre>



<h2 class="wp-block-heading">使用 Postman API 工具</h2>



<ul class="wp-block-list">
<li>Checkout/Create 除錯</li>
</ul>



<pre class="wp-block-code"><code>// Postman - Checkout/Create
// Body &gt; raw
{
    "checkoutItems": &#91;
        {
            "productId": "67d5186884e2f1407fcf0388",
            "name": "Classic T-shirt",
            "image": "https://picsum.photos/seed/denim1/500/500",
            "price": 19,
            "quantity": 1
        }
    ],
    "shippingAddress": {
        "address": "123 main street",
        "city": "New York",
        "postalCode": "10001",
        "country": "USA"
    },
    "paymentMethod": "PayPal",
    "totalPrice": 19
}
</code></pre>



<h2 class="wp-block-heading">Checkout Schema 除錯</h2>



<pre class="wp-block-code"><code>// backend/models/Checkout.js
const mongoose = require("mongoose");

const checkoutItemSchema = new mongoose.Schema(
  {
    productId: {
      type: mongoose.Schema.Types.ObjectId,
      ref: "Product",
      required: true,
    },
    name: {
      type: String,
      required: true,
    },
    image: {
      type: String,
      requied: true,
    },
    price: {
      type: Number,
      requied: true,
    },
    quantity: {
      type: Number,
      required: true,
    },
  },
  { _id: false }
);

const checkoutSchema = new mongoose.Schema(
  {
    user: {
      type: mongoose.Schema.Types.ObjectId,
      ref: "User",
      requied: true,
    },
    checkoutItems: &#91;checkoutItemSchema],
    shippingAddress: {
      address: { type: String, required: true },
      city: { type: String, required: true },
      postalCode: { type: String, required: true },
      country: { type: String, required: true },
    },
    paymentMethod: {
      type: String,
      required: true,
    },
    totalPrice: {
      type: Number,
      required: true,
    },
    isPaid: {
      type: Boolean,
      default: false,
    },
    paidAt: {
      type: Date,
    },
    paymentStatus: {
      type: String,
      default: "pending",
    },
    paymentDetails: {
      type: mongoose.Schema.Types.Mixed, // store payment-related details(transaction ID, paypal response) - 存儲與支付相關的詳細資訊(如交易 ID 和 PayPal 回應)
    },
    isFinalized: {
      type: Boolean,
      default: false,
    },
    finalizedAt: {
      type: Date,
    },
  },
  { timestamps: true }
);

module.exports = mongoose.model("Checkout", checkoutSchema);
</code></pre>



<h2 class="wp-block-heading">查看 MongoDB Atlas</h2>



<ul class="wp-block-list">
<li>查看 checkout 集合是否能正確顯示 quantity 屬性</li>
</ul>



<h2 class="wp-block-heading">使用 Postman API 測試工具</h2>



<ul class="wp-block-list">
<li>複製 Checkout/Create 的 _id</li>



<li>更新 Checkout/Pay 的 id</li>



<li>更新 Checkout/Finalize 的 id</li>
</ul>



<pre class="wp-block-code"><code>// Postman - Checkout/Pay
// Params &gt; Path Variables &gt; Key、Value
Key: id
Value: 67d78fdaae89363d137c322e
</code></pre>



<pre class="wp-block-code"><code>// Postman - Checkout/Finalize
// Params &gt; Path Variables &gt; Key、Value
Key: id
Value: 67d78fdaae89363d137c322e
</code></pre>



<h2 class="wp-block-heading">查看 MongoDB Atlas 資料庫</h2>



<ul class="wp-block-list">
<li>查看 orders > orderItems 資料是否能正常建立、不會被結帳操作而被清空</li>
</ul>



<h2 class="wp-block-heading">製作訂單功能</h2>



<pre class="wp-block-code"><code>// backend/routes/orderRoutes.js
const express = require("express");
const Order = require("../models/Order");
const { protect } = require("../middleware/authMiddleware");

const router = express.Router();

// @route GET /api/orders/my-orders - @路由、使用 GET 方法、API 的路徑
// @desc Get logged-in user's orders - @描述 獲取登入用戶的訂單
// @access Private - @訪問權限 私人
router.get("/my-orders", protect, async (req, res) =&gt; {
  try {
    // Find orders for the authenticated user - 查找已驗證用戶的訂單
    const orders = await Order.find({ user: req.user._id }).sort({
      createdAt: -1,
    }); // sort by most recent orders - 按最新訂單排序
    res.json(orders);
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: "Server Error" });
  }
});

// @route GET /api/orders/:id - @路由、使用 GET 方法、API 的路徑
// @desc Get order details by ID - @描述 根據 ID 獲取訂單詳情
// @access Private - @訪問權限 私人
router.get("/:id", protect, async (req, res) =&gt; {
  try {
    const order = await Order.findById(req.params.id).populate(
      "user",
      "name email"
    );

    if (!order) {
      return res.status(404).json({ message: "Order not found" });
    }

    // Return the full order details - 返回完整的訂單詳情
    res.json(order);
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: "Server Error" });
  }
});

module.exports = router;
</code></pre>



<pre class="wp-block-code"><code>// backend/server.js
const express = require("express");
const cors = require("cors");
const dotenv = require("dotenv");
const connectDB = require("./config/db");
const userRoutes = require("./routes/userRoutes");
const productRoutes = require("./routes/productRoutes");
const cartRoutes = require("./routes/cartRoutes");
const checkoutRoutes = require("./routes/checkoutRoutes");
const orderRoutes = require("./routes/orderRoutes");

const app = express();
app.use(express.json());
app.use(cors());

dotenv.config();

// console.log(process.env.PORT);
const PORT = process.env.PORT || 3000;

// Connect to MongoDB - 連接到 MongoDB
connectDB();

app.get("/", (req, res) =&gt; {
  res.send("WELCOME TO RABBIT API!");
});

// API Routes - API 路由
app.use("/api/users", userRoutes);
app.use("/api/products", productRoutes);
app.use("/api/cart", cartRoutes);
app.use("/api/checkout", checkoutRoutes);
app.use("/api/orders", orderRoutes);

app.listen(PORT, () =&gt; {
  console.log(`Server is running on http://localhost:${PORT}`);
});
</code></pre>



<h2 class="wp-block-heading">使用 Postman API 測試工具</h2>



<ul class="wp-block-list">
<li>Create new collection – 建立新的集合<br>Orders</li>



<li>Add a request – 新增請求<br>My orders、GET、http://localhost:9000/api/orders/my-orders</li>



<li>Headers > Key、Value</li>



<li>Duplicate – 複製 My orders 請求<br>Order Details、GET、http://localhost:9000/api/orders/:id<br>複製 Orders/My orders 的 _id</li>



<li>Params > Path Variables > Key、Value</li>
</ul>



<pre class="wp-block-code"><code>// Postman - Orders/My orders
// Headers
Key: Authorization
Value: Bearer 你的Token
</code></pre>



<pre class="wp-block-code"><code>// Postman - Orders/Order Details
// Params &gt; Path Variables &gt; Key、Value
Key: id
Value: 67d789fd320689ef987bfada</code></pre>



<h2 class="wp-block-heading">製作圖片上傳功能 (管理員)</h2>



<ul class="wp-block-list">
<li>upload images to the products in the admin section (在管理區域將圖片上傳至產品)</li>



<li>
<a href="https://cloudinary.com/" target="_blank" rel="noreferrer noopener">Cloudinary</a> – Getting Started (開始使用)</li>



<li>View API Keys</li>



<li>安裝相關套件 multer、cloudinary、streamifier</li>
</ul>



<pre class="wp-block-code"><code>// backend/.env
PORT=9000
MONGO_URI=mongodb+srv://&lt;username&gt;:&lt;password&gt;@&lt;cluster-address&gt;/&lt;database-name&gt;?retryWrites=true&amp;w=majority&amp;appName=&lt;app-name&gt;
JWT_SECRET=你的JWT密鑰

CLOUDINARY_CLOUD_NAME=你的Clound name
CLOUDINARY_API_KEY=你的API Key
CLOUDINARY_API_SECRET=你的API secret
</code></pre>



<pre class="wp-block-code"><code>// backend - 後端
// TERMINAL - 終端機
npm install multer cloudinary streamifier
</code></pre>



<pre class="wp-block-code"><code>// backend/routes/uploadRoutes.js
const express = require("express");
const multer = require("multer");
const cloudinary = require("cloudinary").v2;
const streamifier = require("streamifier");

require("dotenv").config();

const router = express.Router();

// Cloudinary Configuration - Cloudinary 配置
cloudinary.config({
  cloud_name: process.env.CLOUDINARY_CLOUD_NAME,
  api_key: process.env.CLOUDINARY_API_KEY,
  api_secret: process.env.CLOUDINARY_API_SECRET,
});

// Multer setup using memory storage - 使用記憶體存儲的 Multer 設置
const storage = multer.memoryStorage();
const upload = multer({ storage });

router.post("/", upload.single("image"), async (req, res) =&gt; {
  try {
    if (!req.file) {
      return res.status(400).json({ message: "No file uploaded" });
    }

    // Function to handle the stream upload to Cloudinary - 處理將資料流上傳到 Cloudinary 的函式
    const streamUpload = (fileBuffer) =&gt; {
      return new Promise((resolve, reject) =&gt; {
        const stream = cloudinary.uploader.upload_stream((error, result) =&gt; {
          if (result) {
            resolve(result);
          } else {
            reject(error);
          }
        });

        // Use streamifier to convert file buffer to a stream - 使用 streamifier 將檔案緩衝區轉換為資料流
        streamifier.createReadStream(fileBuffer).pipe(stream);
      });
    };

    // Call the streamUpload function - 呼叫 streamUpload 函數
    const result = await streamUpload(req.file.buffer);

    // Respond with the uploaded image URL - 回應並提供上傳的圖片 URL
    res.json({ imageUrl: result.secure_url });
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: "Server Error" });
  }
});

module.exports = router;
</code></pre>



<pre class="wp-block-code"><code>// backend/server.js
const express = require("express");
const cors = require("cors");
const dotenv = require("dotenv");
const connectDB = require("./config/db");
const userRoutes = require("./routes/userRoutes");
const productRoutes = require("./routes/productRoutes");
const cartRoutes = require("./routes/cartRoutes");
const checkoutRoutes = require("./routes/checkoutRoutes");
const orderRoutes = require("./routes/orderRoutes");
const uploadRoutes = require("./routes/uploadRoutes");

const app = express();
app.use(express.json());
app.use(cors());

dotenv.config();

// console.log(process.env.PORT);
const PORT = process.env.PORT || 3000;

// Connect to MongoDB - 連接到 MongoDB
connectDB();

app.get("/", (req, res) =&gt; {
  res.send("WELCOME TO RABBIT API!");
});

// API Routes - API 路由
app.use("/api/users", userRoutes);
app.use("/api/products", productRoutes);
app.use("/api/cart", cartRoutes);
app.use("/api/checkout", checkoutRoutes);
app.use("/api/orders", orderRoutes);
app.use("/api/upload", uploadRoutes);

app.listen(PORT, () =&gt; {
  console.log(`Server is running on http://localhost:${PORT}`);
});
</code></pre>



<h2 class="wp-block-heading">使用 Postman API 測試工具</h2>



<ul class="wp-block-list">
<li>Create new collection – 建立新的集合<br>Upload</li>



<li>Add a request – 新增請求<br>Create、POST、http://localhost:9000/api/upload</li>



<li>Headers > Key、Value</li>



<li>Body > form-data > Key、Value</li>
</ul>



<pre class="wp-block-code"><code>// Postman - Upload/Create
// Headers
Key: Authorization
Value: Bearer 你的Token
</code></pre>



<pre class="wp-block-code"><code>// Postman - Upload/Create
// Body &gt; form-data
Key: image / File
Value: Select files &gt; New file from local machine
Photo by Ayo Ogunseinde on Unsplash</code></pre>



<h2 class="wp-block-heading">製作電子信箱訂閱功能</h2>



<pre class="wp-block-code"><code>// backend/models/Subscriber.js
const mongoose = require("mongoose");

const subscriberSchema = new mongoose.Schema({
  email: {
    type: String,
    required: true,
    unique: true,
    trim: true,
    lowercase: true,
  },
  subscribedAt: {
    type: Date,
    default: Date.now,
  },
});

module.exports = mongoose.model("Subscriber", subscriberSchema);
</code></pre>



<pre class="wp-block-code"><code>// backend/routes/subscribeRoute.js
const express = require("express");
const router = express.Router();
const Subscriber = require("../models/Subscriber");

// @route POST /api/subscribe - @路由、使用 POST 方法、API 的路徑
// @desc Handle newsletter subscription - @描述 處理電子報訂閱
// @access Public - @訪問權限 公開
router.post("/subscribe", async (req, res) =&gt; {
  const { email } = req.body;

  if (!email) {
    return res.status(400).json({ message: "Email is required" });
  }

  try {
    // Check if the email is already subscribed
    let subscriber = await Subscriber.findOne({ email });

    if (subscriber) {
      return res.status(400).json({ message: "Email is already subscribed" });
    }

    // Create a new subscriber - 創建新的訂閱者
    subscriber = new Subscriber({ email });
    await subscriber.save();

    res
      .status(201)
      .json({ message: "Successfully subscribed to the newsletter!" });
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: "Server Error" });
  }
});

module.exports = router;
</code></pre>



<pre class="wp-block-code"><code>// backend/server.js
const express = require("express");
const cors = require("cors");
const dotenv = require("dotenv");
const connectDB = require("./config/db");
const userRoutes = require("./routes/userRoutes");
const productRoutes = require("./routes/productRoutes");
const cartRoutes = require("./routes/cartRoutes");
const checkoutRoutes = require("./routes/checkoutRoutes");
const orderRoutes = require("./routes/orderRoutes");
const uploadRoutes = require("./routes/uploadRoutes");
const subscribeRoute = require("./routes/subscribeRoute");

const app = express();
app.use(express.json());
app.use(cors());

dotenv.config();

// console.log(process.env.PORT);
const PORT = process.env.PORT || 3000;

// Connect to MongoDB - 連接到 MongoDB
connectDB();

app.get("/", (req, res) =&gt; {
  res.send("WELCOME TO RABBIT API!");
});

// API Routes - API 路由
app.use("/api/users", userRoutes);
app.use("/api/products", productRoutes);
app.use("/api/cart", cartRoutes);
app.use("/api/checkout", checkoutRoutes);
app.use("/api/orders", orderRoutes);
app.use("/api/upload", uploadRoutes);
app.use("/api", subscribeRoute);

app.listen(PORT, () =&gt; {
  console.log(`Server is running on http://localhost:${PORT}`);
});
</code></pre>



<h2 class="wp-block-heading">使用 Postman API 測試工具</h2>



<ul class="wp-block-list">
<li>Create new collection – 建立新的集合<br>Subscribe</li>



<li>Add a request – 新增請求<br>subscribe、POST、http://localhost:9000/api/subscribe</li>



<li>Body > raw</li>
</ul>



<pre class="wp-block-code"><code>// Postman - Subscribe/subscribe
// Body &gt; raw
{
    "email": "hi@example.com"
}
</code></pre>



<h2 class="wp-block-heading">製作用戶管理功能 (管理員)</h2>



<pre class="wp-block-code"><code>// backend/routes/adminRoutes.js
const express = require("express");
const User = require("../models/User");
const { protect, admin } = require("../middleware/authMiddleware");

const router = express.Router();

// @route GET /api/admin/users - @路由、使用 GET 方法、API 的路徑
// @desc Get all users (Admin only) - @描述 取得所有用戶 (僅限管理員)
// @access Private/Admin - @訪問權限 私人/管理員
router.get("/", protect, admin, async (req, res) =&gt; {
  try {
    const users = await User.find({});
    res.json(users);
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: "Server Error" });
  }
});

// @route POST /api/admin/users - @路由、使用 POST 方法、API 的路徑
// @desc Add a new user (admin only) - @描述 新增用戶 (僅限管理員)
// @access Private/Admin - @訪問權限 私人/管理員
router.post("/", protect, admin, async (req, res) =&gt; {
  const { name, email, password, role } = req.body;

  try {
    let user = await User.findOne({ email });
    if (user) {
      return res.status(400).json({ message: "User already exists" });
    }

    user = new User({
      name,
      email,
      password,
      role: role || "customer",
    });

    await user.save();
    res.status(201).json({ message: "User created successfully", user });
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: "Server Error" });
  }
});

// @route PUT /api/admin/users/:id - @路由、使用 PUT 方法、API 的路徑
// @desc Update user info (admin only) - Name, email and role - @描述 更新用戶資訊 (僅限管理員) - 姓名、電子郵件和角色
// @access Private/Admin - @訪問權限 私人/管理員
router.put("/:id", protect, admin, async (req, res) =&gt; {
  try {
    const user = await User.findById(req.params.id);
    if (user) {
      user.name = req.body.name || user.name;
      user.email = req.body.email || user.email;
      user.role = req.body.role || user.role;
    }
    const updatedUser = await user.save();
    res.json({ message: "User updated successfully", user: updatedUser });
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: "Server Error" });
  }
});

// @route DELETE /api/admin/users/:id - @路由、使用 DELETE 方法、API 的路徑
// @desc Delete a user - @描述 刪除用戶
// @access Private/Admin - @訪問權限 私人/管理員
router.delete("/:id", protect, admin, async (req, res) =&gt; {
  try {
    const user = await User.findById(req.params.id);
    if (user) {
      await user.deleteOne();
      res.json({ message: "User deleted successfully" });
    } else {
      res.status(404).json({ message: "User not found" });
    }
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: "Server Error" });
  }
});

module.exports = router;
</code></pre>



<pre class="wp-block-code"><code>// backend/server.js
const express = require("express");
const cors = require("cors");
const dotenv = require("dotenv");
const connectDB = require("./config/db");
const userRoutes = require("./routes/userRoutes");
const productRoutes = require("./routes/productRoutes");
const cartRoutes = require("./routes/cartRoutes");
const checkoutRoutes = require("./routes/checkoutRoutes");
const orderRoutes = require("./routes/orderRoutes");
const uploadRoutes = require("./routes/uploadRoutes");
const subscribeRoute = require("./routes/subscribeRoute");
const adminRoutes = require("./routes/adminRoutes");

const app = express();
app.use(express.json());
app.use(cors());

dotenv.config();

// console.log(process.env.PORT);
const PORT = process.env.PORT || 3000;

// Connect to MongoDB - 連接到 MongoDB
connectDB();

app.get("/", (req, res) =&gt; {
  res.send("WELCOME TO RABBIT API!");
});

// API Routes - API 路由
app.use("/api/users", userRoutes);
app.use("/api/products", productRoutes);
app.use("/api/cart", cartRoutes);
app.use("/api/checkout", checkoutRoutes);
app.use("/api/orders", orderRoutes);
app.use("/api/upload", uploadRoutes);
app.use("/api", subscribeRoute);

// Admin - 管理員
app.use("/api/admin/users", adminRoutes);

app.listen(PORT, () =&gt; {
  console.log(`Server is running on http://localhost:${PORT}`);
});
</code></pre>



<h2 class="wp-block-heading">使用 Postman API 測試工具</h2>



<ul class="wp-block-list">
<li>Create new collection – 建立新的集合<br>Admin User</li>



<li>Add a request – 新增請求<br>All users、GET、http://localhost:9000/api/admin/users<br>Create User、POST、http://localhost:9000/api/admin/users</li>



<li>Headers > Key、Value</li>



<li>Body > raw</li>



<li>Duplicate – 複製 Create User 請求<br>Update User、PUT、http://localhost:9000/api/admin/users/:id</li>



<li>Headers > Key、Value</li>



<li>Body > raw</li>



<li>複製 MongoDB Atlas 使用者的 _id</li>



<li>Params > Path Variables > Key、Value</li>



<li>Duplicate – 複製 Update User 請求<br>Delete User、DELETE、http://localhost:9000/api/admin/users/:id</li>
</ul>



<pre class="wp-block-code"><code>// Postman - Admin User/All users
// Headers
Key: Authorization
Value: Bearer 你的Token
</code></pre>



<pre class="wp-block-code"><code>// Postman - Admin User/Create User
// Body &gt; raw
{
    "name": "Jimmy",
    "email": "jimmy@example.com",
    "password": "123456"
}
</code></pre>



<pre class="wp-block-code"><code>// Postman - Admin User/Update User
// Headers
Key: Authorization
Value: Bearer 你的Token
</code></pre>



<pre class="wp-block-code"><code>// Postman - Admin User/Update User
// Body &gt; raw
{
    "name": "Jimmy1",
    "email": "jimmy1@example.com"
}
</code></pre>



<pre class="wp-block-code"><code>// Postman - Admin User/Update User
// Params &gt; Path Variables &gt; Key、Value
Key: id
Value: 67d8eafb4e9e9ace1c78eb25
</code></pre>



<h2 class="wp-block-heading">查看 MongoDB Atlas</h2>



<ul class="wp-block-list">
<li>Browse Collection (瀏覽集合) > users</li>
</ul>



<h2 class="wp-block-heading">製作列出所有產品功能 (管理員)</h2>



<pre class="wp-block-code"><code>// backend/routes/productAdminRoutes.js
const express = require("express");
const Product = require("../models/Product");
const { protect, admin } = require("../middleware/authMiddleware");

const router = express.Router();

// @route GET /api/admin/products - @路由、使用 GET 方法、API 的路徑
// @desc Get all products (Admin only) - @描述 取得所有產品 (僅限管理員)
// @access Private/Admin - @訪問權限 私人/管理員
router.get("/", protect, admin, async (req, res) =&gt; {
  try {
    const products = await Product.find({});
    res.json(products);
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: "Server Error" });
  }
});

module.exports = router;
</code></pre>



<pre class="wp-block-code"><code>// backend/server.js
const express = require("express");
const cors = require("cors");
const dotenv = require("dotenv");
const connectDB = require("./config/db");
const userRoutes = require("./routes/userRoutes");
const productRoutes = require("./routes/productRoutes");
const cartRoutes = require("./routes/cartRoutes");
const checkoutRoutes = require("./routes/checkoutRoutes");
const orderRoutes = require("./routes/orderRoutes");
const uploadRoutes = require("./routes/uploadRoutes");
const subscribeRoute = require("./routes/subscribeRoute");
const adminRoutes = require("./routes/adminRoutes");
const productAdminRoutes = require("./routes/productAdminRoutes");

const app = express();
app.use(express.json());
app.use(cors());

dotenv.config();

// console.log(process.env.PORT);
const PORT = process.env.PORT || 3000;

// Connect to MongoDB - 連接到 MongoDB
connectDB();

app.get("/", (req, res) =&gt; {
  res.send("WELCOME TO RABBIT API!");
});

// API Routes - API 路由
app.use("/api/users", userRoutes);
app.use("/api/products", productRoutes);
app.use("/api/cart", cartRoutes);
app.use("/api/checkout", checkoutRoutes);
app.use("/api/orders", orderRoutes);
app.use("/api/upload", uploadRoutes);
app.use("/api", subscribeRoute);

// Admin - 管理員
app.use("/api/admin/users", adminRoutes);
app.use("/api/admin/products", productAdminRoutes);

app.listen(PORT, () =&gt; {
  console.log(`Server is running on http://localhost:${PORT}`);
});
</code></pre>



<h2 class="wp-block-heading">使用 Postman API 測試工具</h2>



<ul class="wp-block-list">
<li>Create new collection – 建立新的集合<br>Admin Product</li>



<li>Add a request – 新增請求<br>Products、GET、http://localhost:9000/api/admin/products</li>



<li>Headers > Key、Value</li>
</ul>



<pre class="wp-block-code"><code>// Postman - Admin Product/Products
// Headers
Key: Authorization
Value: Bearer 你的Token
</code></pre>



<h2 class="wp-block-heading">製作訂單管理功能 (管理員)</h2>



<pre class="wp-block-code"><code>// backend/routes/adminOrderRoutes.js
const express = require("express");
const Order = require("../models/Order");
const { protect, admin } = require("../middleware/authMiddleware");

const router = express.Router();

// @route GET /api/admin/orders - @路由、使用 GET 方法、API 的路徑
// @desc Get all order (Admin only) - @描述 取得所有訂單 (僅限管理員)
// @access Private/Admin - @訪問權限 私人/管理員
router.get("/", protect, admin, async (req, res) =&gt; {
  try {
    const orders = await Order.find({}).populate("user", "name email");
    res.json(orders);
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: "Server Error" });
  }
});

// @route PUT /api/admin/orders/:id - @路由、使用 PUT 方法、API 的路徑
// @desc Update order status - @描述 更新訂單狀態
// @access Private/Admin - @訪問權限 私人/管理員
router.put("/:id", protect, admin, async (req, res) =&gt; {
  try {
    const order = await Order.findById(req.params.id);
    if (order) {
      order.status = req.body.status || order.status;
      order.isDelivered =
        req.body.status === "Delivered" ? true : order.isDelivered;
      order.deliveredAt =
        req.body.status === "Delivered" ? Date.now() : order.deliveredAt;

      const updatedOrder = await order.save();
      res.json(updatedOrder);
    } else {
      res.status(404).json({ message: "Order not found" });
    }
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: "Server Error" });
  }
});

// @route DELETE /api/admin/orders/:id - @路由、使用 DELETE 方法、API 的路徑
// @desc Delete an order - @描述 刪除訂單
// @access Private/Admin - @訪問權限 私人/管理員
router.delete("/:id", protect, admin, async (req, res) =&gt; {
  try {
    const order = await Order.findById(req.params.id);
    if (order) {
      await order.deleteOne();
      res.json({ message: "Order removed" });
    } else {
      res.status(404).json({ message: "Order not found" });
    }
  } catch (error) {
    console.error(error);
    res.status(500).json({ message: "Server Error" });
  }
});

module.exports = router;
</code></pre>



<pre class="wp-block-code"><code>// backend/server.js
const express = require("express");
const cors = require("cors");
const dotenv = require("dotenv");
const connectDB = require("./config/db");
const userRoutes = require("./routes/userRoutes");
const productRoutes = require("./routes/productRoutes");
const cartRoutes = require("./routes/cartRoutes");
const checkoutRoutes = require("./routes/checkoutRoutes");
const orderRoutes = require("./routes/orderRoutes");
const uploadRoutes = require("./routes/uploadRoutes");
const subscribeRoute = require("./routes/subscribeRoute");
const adminRoutes = require("./routes/adminRoutes");
const productAdminRoutes = require("./routes/productAdminRoutes");
const adminOrderRoutes = require("./routes/adminOrderRoutes");

const app = express();
app.use(express.json());
app.use(cors());

dotenv.config();

// console.log(process.env.PORT);
const PORT = process.env.PORT || 3000;

// Connect to MongoDB - 連接到 MongoDB
connectDB();

app.get("/", (req, res) =&gt; {
  res.send("WELCOME TO RABBIT API!");
});

// API Routes - API 路由
app.use("/api/users", userRoutes);
app.use("/api/products", productRoutes);
app.use("/api/cart", cartRoutes);
app.use("/api/checkout", checkoutRoutes);
app.use("/api/orders", orderRoutes);
app.use("/api/upload", uploadRoutes);
app.use("/api", subscribeRoute);

// Admin - 管理員
app.use("/api/admin/users", adminRoutes);
app.use("/api/admin/products", productAdminRoutes);
app.use("/api/admin/orders", adminOrderRoutes);

app.listen(PORT, () =&gt; {
  console.log(`Server is running on http://localhost:${PORT}`);
});
</code></pre>



<h2 class="wp-block-heading">使用 Postman API 測試工具</h2>



<ul class="wp-block-list">
<li>Create new collection – 建立新的集合<br>Admin Orders</li>



<li>Add a request – 新增請求<br>Orders、GET、http://localhost:9000/api/admin/orders</li>



<li>Headers > Key、Value</li>



<li>Duplicate – 複製 Orders 請求<br>Update Status、PUT、http://localhost:9000/api/admin/orders/:id</li>



<li>複製 MongoDB Atlas 訂單的 _id</li>



<li>Params > Path Variables > Key、Value</li>



<li>Body > raw<br>測試修改狀態 Processing</li>



<li>Duplicate – 複製 Update Status 請求<br>Delete、DELETE、http://localhost:9000/api/admin/orders/:id</li>



<li>複製 MongoDB Atlas 訂單的 _id<br>測試刪除訂單</li>
</ul>



<pre class="wp-block-code"><code>// Postman - Admin Orders/Orders
// Headers
Key: Authorization
Value: Bearer 你的Token
</code></pre>



<pre class="wp-block-code"><code>// Postman - Admin Orders/Update Status
// Params &gt; Path Variables &gt; Key、Value
Key: id
Value: 67d789fd320689ef987bfada
</code></pre>



<pre class="wp-block-code"><code>// Postman - Admin Orders/Update Status
// Body &gt; raw
{
    "status": "Delivered"
}
</code></pre>



<h2 class="wp-block-heading">查看 MongoDB Atlas 資料庫</h2>



<ul class="wp-block-list">
<li>Browse collections (瀏覽集合) > orders<br>查看是否有刪除訂單</li>
</ul>



<p>以上完成這個專案後端的部分。</p>
	</div>
<!-- .entry-content -->

	<footer class="entry-footer">
			</footer><!-- .entry-footer -->
</article><!-- #post-882 -->

	<nav class="navigation post-navigation" aria-label="文章">
		<h2 class="screen-reader-text">文章導覽</h2>
		<div class="nav-links">
<div class="nav-previous"><a href="/wordpress_blog/full-stack-rabbit-01/" rel="prev"><span class="nav-subtitle">Previous:</span> <span class="nav-title">Build &amp; Deploy Full Stack E-commerce Website | Redux | MERN Stack – 01</span></a></div>
<div class="nav-next"><a href="/wordpress_blog/full-stack-rabbit-03/" rel="next"><span class="nav-subtitle">Next:</span> <span class="nav-title">Build &amp; Deploy Full Stack E-commerce Website | Redux | MERN Stack – 03</span></a></div>
</div>
	</nav>
	</main><!-- #main -->


	</div></div>
			
			<footer id="colophon" class="site-footer">

				
				<div class="container-fluid">
					<div class="site-info">
						<div class="row">

															
								<div class="col-12 footer-copyright-elements footer-copyright-alignment-center">

									<div class="botiga-credits">&copy; 2025 wordpress_blog. 
Created by Gee Hsu. 
<br>Proudly powered by <a rel="nofollow" href="https://athemes.com/theme/botiga/">Botiga</a>
</div>
<div class="social-profile">
<a target="_blank" href="https://www.facebook.com/watergrass0402/"><i class="ws-svg-icon"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"></path></svg></i></a><a target="_blank" href="https://github.com/GeeHsu"><i class="ws-svg-icon"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></i></a>
</div>
								</div>
														
						</div>
					</div>
				</div>
<!-- .site-info -->

				
			</footer><!-- #colophon -->

			
			<div class="back-to-top visibility-all position-right"><i class="ws-svg-icon"><svg viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5 15l7-7 7 7" stroke-width="3" stroke-linejoin="round"></path></svg></i></div>
</div>
<!-- #page -->


<script id="botiga-custom-js-extra">
var botiga = {"ajaxurl":"\/wp-admin\/admin-ajax.php","i18n":{"botiga_sharebox_copy_link":"Copy link","botiga_sharebox_copy_link_copied":"Copied!"}};
</script>
<script src="/wordpress_blog/wp-content/themes/botiga/assets/js/custom.min.js?ver=1.1.2" id="botiga-custom-js"></script>

</body>
</html>